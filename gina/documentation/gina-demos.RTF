{\rtf1\mac\deff2 {\fonttbl{\f0\fswiss Chicago;}{\f2\froman New York;}{\f3\fswiss Geneva;}{\f4\fmodern Monaco;}{\f5\fscript Venice;}{\f6\fdecor London;}{\f7\fdecor Athens;}{\f8\fdecor San Francisco;}{\f9\fnil Toronto;}{\f10\fdecor Future;}{\f11\fnil Cairo;}{\f12\fnil Los Angeles;}{\f13\fnil Zapf Dingbats;}{\f14\fnil Bookman;}{\f15\fnil N Helvetica Narrow;}{\f16\fnil Palatino;}{\f18\fnil Zapf Chancery;}{\f20\froman Times;}{\f21\fswiss Helvetica;}{\f22\fmodern Courier;}{\f23\ftech Symbol;}{\f24\fnil Mobile;}{\f33\fnil Avant Garde;}{\f34\fnil New Century Schlbk;}}{\colortbl\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;}{\stylesheet{\s232\li708\ri850\tqr\tldot\tx8504 \f20 \sbasedon0\snext0 Ver 2;}{\s233\ri850\tqr\tldot\tx8504 \f20 \sbasedon0\snext0 Ver 1;}{\s242 \f20 \sbasedon0\snext0 Seitenzahl;}{\s243\ri1\sa100\tqc\tx4320\tqr\tx8640 \b\f34 \sbasedon2\snext243 Fußzeile;}{\s244\ri1\tqc\tx4320\tqr\tx8640 \f34 \sbasedon2\snext244 Kopfzeile;}{\s245 \f20\fs18\up6 \sbasedon0\snext0 Fußnotenzeichen;}{\s246 \f20\fs20 \sbasedon0\snext246 Fußnotentext;}{\s247\li708 \i\f20\fs20 \sbasedon0\snext0 Überschrift 9;}{\s248\li708 \i\f20\fs20 \sbasedon0\snext0 Überschrift 8;}{\s249\li708 \i\f20\fs20 \sbasedon0\snext0 Überschrift 7;}{\s250\li708 \f20\fs20\ul \sbasedon0\snext0 Überschrift 6;}{\s251\li708 \b\f20\fs20 \sbasedon0\snext0 Überschrift 5;}{\s252\li354 \f20\ul \sbasedon0\snext0 Überschrift 4;}{\s253\li354 \b\f20 \sbasedon0\snext0 Überschrift 3;}{\s254\sb120 \b\f21 \sbasedon0\snext0 Überschrift 2;}{\s255\sa100\keepn\pagebb \b\f34\fs28 \sbasedon2\snext2 Überschrift 1;}{\f20 \sbasedon222\snext0 Normal;}{\s2\qj\ri1\sb40\sa100 \f34 \sbasedon0\snext2 Text;}{\s3\qj\ri1\sb200\sa100\keepn \b\f34 \sbasedon2\snext2 Abschnittsüberschrift;}{\s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \sbasedon2\snext4 Punkte;}{\s5\qc\ri1\sa200 \f34 \sbasedon2\snext2 Bildunterschrift;}{\s7\qc\ri1\sb200\sa200\keepn \f34 \sbasedon2\snext5 Graphik;}{\s8\fi-1418\li1701\ri1\sb20\sa60 \f21 \sbasedon2\snext8 Regel;}{\s9\li300\ri1 \f16 \sbasedon2\snext9 Programmcode;}{\s10 \f22\fs12 \sbasedon0\snext10 Sourcecode;}}\paperw11880\paperh16820\margl1304\margr1304\margt1814\margb1247\deftab567\widowctrl\ftnbj\pgnstart0\fracwidth \sectd \linemod0\linex0\cols1\endnhere\titlepg {\footer \pard\plain \s243\ri1\sa100\tqc\tx4320\tqr\tx9298 \b\f34 GINA Demos\tab \chpgn \tab \chdate \par \pard \s243\ri1\sa100\tqc\tx4320\tqr\tx8640 \par }\pard\plain \s255\qc\sa100\keepn\pagebb\tqr\tx5660 \b\f34\fs28 {\fs48 \par }\pard\plain \s2\qj\ri1\sb40\sa100 \f34 \par \par \par \par \par \par \par \pard\plain \s255\qc\sa100\keepn\tqr\tx5660 \b\f34\fs28 {\fs48 GINA Demo Applications \par }\pard\plain \s2\qc\ri1\sb40\sa100 \f34 {\fs28 GINA Version 2.1 for Common Lisp}\par \pard \s2\qj\ri1\sb40\sa100 \par \par \pard \s2\qc\ri1\sb40\sa100 {\fs28 Michael Spenke\par Christian Beilken\par Thomas Berlage\par Andreas B\'8acker\par Andreas Genau\par \par }\pard \s2\qc\ri1\sb40\sa100 {\fs28 Gesellschaft f\'9fr Mathematik und Datenverarbeitung mbH (GMD)\line (German National Research Center for Computer Science)\line P.O. Box 1316\line D-5205 Sankt Augustin 1\line Federal Republic of Germany\line }\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 Contents\par \pard\plain \s233\ri850\tqr\tldot\tx8504 \f20 0. Overview of the Demo Programs\tab 3\par 1. Hello\tab 6\par 2. Micky\tab 10\par 3. Text-Editor\tab 14\par 4. Clock\tab 16\par 5. Finder\tab 17\par 6. Graphic-Editor\tab 22\par 7. Graphic-Output\tab 28\par 8. Bitmap-Editor\tab 32\par 9. Lisp-Widgets\tab 39\par 10. Tetris\tab 42\par 11. Pacmen\tab 44\par 12. Spreadsheet\tab 47\par 13. Hyper-GINA\tab 50\par 14. Lisp Listener\tab 53\par 15. Chess Interface\tab 57\par 16. Drag and Drop Demo\tab 59\par 17. Mandelbrot Demo\tab 64\par \pard \s233\ri850\tqr\tldot\tx8504 18. Desk Calculator\tab 68\par \pard\plain \f20 {\f34 \sect }\sectd \sbknone\linemod0\linex0\headery1077\footery567\cols1\colsx284\endnhere {\footer \pard\plain \s243\ri1\sa100\tqc\tx4320\tqr\tx9298 \b\f34 GINA Demos\tab \chpgn \tab \chdate \par }\pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 0. Overview of the Demo Programs\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 This is a collection of simple, well-documented demo applications demonstrating most of the concepts of GINA. The documentation of each demo consists of \par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab a description of the functionality\par \'a5\tab a screen dump of the application window\par \'a5\tab an overview of the implementation and the GINA-features being used\par \'a5\tab limitations of the demo and suggestions for further extensions (sometimes).\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 \par \pard \s2\qj\ri1\sb40\sa100 The complete source code of all demo programs belongs to the GINA distribution. For the shorter demo programs the source code is also printed within this manual. \par Each of the demo applications consists of only a few pages of code. So, even though they are quite different, at least 95% of the code executed is part of GINA.\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \page These are the demo applications\:\par \pard \s4\qj\fi-420\li420\ri1\sb40\sa20 {\b 1.\tab Hello}\par \pard \s4\qj\fi-420\li420\ri1\sb40\sa20 \tab A simple Hello-World application. The string "Hi!" appears, where the mouse is clicked in the main view.\par \pard \s4\qj\fi-420\li420\ri1\sb40\sa20 {\b 2.\tab Micky}\par \pard \s4\qj\fi-420\li420\ri1\sb40\sa20 \tab Similar to Schmucker's demo for MacApp. Our version, however, allows the user to stretch the width and height of Micky\'abs head using two scales.\par \pard \s4\qj\fi-420\li420\ri1\sb40\sa20 {\b 3.}\tab {\b Text-Editor}\par \pard \s4\qj\fi-420\li420\ri1\sb40\sa20 \tab This demo shows, how with a few lines of code the Motif text-widget can be turned into a complete and useful application.\par \pard \s4\qj\fi-420\li420\ri1\sb40\sa20 {\b 4.}\tab {\b Clock}\par \tab A simple digital clock.\par {\b 5.}\tab {\b Finder}\par \pard \s4\qj\fi-420\li420\ri1\sb40\sa20 \tab This application shows directory contents in a scrollable list and launches applications and documents.\par \pard \s4\qj\fi-420\li420\ri1\sb40\sa20 {\b 6.}\tab {\b Graphic-Editor}\par \tab Circles and rectangles can be created, moved, resized, and deleted.\par {\b 7.}\tab {\b Graphic-Output}\par \tab Demonstrates the use of the drawing primitives and graphic-contexts of CLX .\par {\b 8.}\tab {\b Bitmap-Editor}\par \tab A simple tool to draw bitmaps. Includes zooming and full undo/redo.\par {\b 9.}\tab {\b Lisp-Widgets}\par \tab This demo shows how new types of widgets can be implemented in Lisp.\par {\b 10.}\tab {\b Tetris}\par \tab A simple version of the well known arcade game.\par {\b 11.\tab Pacmen \par }\tab Demo of background processes. Not really a game.\par {\b 12.\tab Spreadsheet \par }\pard \s4\qj\fi-420\li420\ri1\sb40\sa20 \tab A usable spreadsheet program. Lisp expressions containing cell references can be used as formulas.\par \pard \s4\qj\fi-420\li420\ri1\sb40\sa20 {\b 13.\tab Hyper-GINA\par }\tab Similar to HyperCard using widgets.\par {\b 14.\tab Lisp Listener \par }\tab A text widget is used as a lisp listener. \par {\b 15.\tab Chess Interface\par }\tab Chesspieces (movable icons) can be dragged around. Connection to GNU chess.\par {\b 16.\tab Drag and Drop Demo\par }\tab Demonstration of drag and drop labels provided by GINA.\par {\b 17.\tab Mandelbrot Demo\par }\tab Mandelbrot sets are displayed while computed in a background process.\par {\b 18.\tab Desk Calculator\par }\tab Desk Calculator made with the help of the GINA interface builder.\par \pard \s4\qj\fi-420\li420\ri1\sb40\sa40 \par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 If you are interested in examples for certain implementation techniques, this overview lists some important topics and the demos covering them\:\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab {\b Saving documents to file}\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \tab Hello, Micky, Text-Editor, Finder, Graphic-Editor, Bitmap-Editor, Chess, Spreadsheet, Hyper-GINA\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab {\b Use of the Interface Builder}\par \tab Calculator, Finder, Chess (for the promotion dialog)\par \'a5\tab {\b Graphical output into views}\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \tab Graphic-Output, Hello, Micky, Graphic-Editor, Bitmap-Editor, Tetris, Lisp-Widgets, Chess, Pacmen, Spreadsheet, Hyper-GINA, Mandelbrot\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab {\b Undoable commands}\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \tab Hello, Graphic-Editor, Bitmap-Editor, Lisp-Widgets, Chess, Spreadsheet, Hyper-GINA, Drag and Drop Demo, Mandelbrot\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab {\b Mouse input in views}\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \tab Hello, Graphic-Editor, Bitmap-Editor, Lisp-Widgets, Spreadsheet, Chess, Hyper-GINA, Mandelbrot, Drag and Drop Demo\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab {\b Mouse commands with graphical feedback}\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \tab Graphic-Editor, Bitmap-Editor, Lisp-Widgets, Chess, Spreadsheet, Hyper-GINA, Mandelbrot\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab {\b View-objects}\par \tab Tetris, Graphic-Editor, Chess, Hyper-GINA, Drag and Drop Demo\par \'a5\tab {\b Direct-manipulation objects}\par \tab Graphic-Editor, Chess, Hyper-GINA\par \'a5\tab {\b Movable icons}\par \tab Chess\par \'a5\tab {\b Timer}\par \tab Clock, Tetris\par \'a5\tab {\b Starting foreign documents and applications}\par \tab Finder\par \'a5\tab {\b Toggle buttons within a menu}\par \tab Micky, Chess\par \'a5\tab {\b Applications without a menu bar}\par \tab Clock, Tetris, Calculator{\b  }\par \'a5\tab {\b Color}\par \tab Tetris\par \'a5\tab {\b Background processes (progress bar)}\par \tab Mandelbrot, Pacmen, Chess, Lisp-Listener\par \'a5\tab {\b Drag and Drop}\par \tab Drag and Drop Demo, (Interface-Builder)\par \'a5\tab {\b Double Buffering}\par \tab Mandelbrot, Chess\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 1. Hello\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 1.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 The first experiment with a new programming environment is always the implementation of the hello-world program. The traditional version just prints out "Hello world!" on standard output. Of course, this is too simple in the context of graphical user interfaces. \par \pard \s2\qj\ri1\sb40\sa100 Our version of hello-world is somewhat more complex\: The user can click the mouse within the main area of our window and at this position the string "Hi!" will appear. An entry in the menu bar allows the user to clear all strings again. Hello-world documents can be saved in a file and remember the position of each string. Unlimited undo/redo is possible and the history scroller can be used to move back and forth in the command history.\par \pard\plain \s7\qc\ri1\sb200\sa200\keepn \f34 \tab {{\pict\macpict\picw387\pich392 1a080000000001880183110101000a0000000001880183980032000000000188018a000000070188018a000000000188018300000cfd000080d9000002fe000040060000d1aa00c00e0000fe550095d9550056fe5500c0060000d1aa00c00e0000fe550095d9550056fe5500c0060000d1aa00c00e0000fe550095d9550056fe5500c0060000d1aa00c00e040055ffffbfd9ff04feffffd5c0080100abd300012ac00e0000fe550095d9550056fe5500c0140200ab2af4aaf2ff00fef6aa00acfeaa02ab2ac01e0000fe550095f65503fffe1c3ffdff010fc7fcff00fdf4550056fe5500c0210200ab2af4aa0f08ff9f3fffc23fffcfe7fff00200ff82f6aa06acaaaaa00b2ac0210000fe550095f6550f99ff9f3fffe77fffcfe7fff4a666ff31f4550456455555c0220300ab2002f5aa0f99879f3c3fe56191cf073ffce667ff3ef6aa06aca0aaaabb2ac021040055555d95f6550f81339f399fe54cc5ce673ffce061ff0df4550456455555c0210200ab22f4aa0f99039f399fe54ccfce67fffce66581c2f6aa06aca3aaaabb2ac02204005557fd95f6550f993f9f399fe04ccfce67fffce667fff1f555055756455555c0210200ab2af4aa0f99339f399ff0cccfce673ffce666ff32f6aa00acfeaa02bb2ac0210000fe550095f6550f0886040c3ff2e18303033ff84200ff05f4550456455555c0140200ab2af4aaf2ff00fef6aa06acaaaaaffb2ac0140000fe550095f655f2ff00fdf4550056fe5500c0140200ab2af4aaf2ff00fef6aa00acfeaa02ab2ac0100400557fffbfdbff06fdfffeffff55c0070001d2ff017fc008010000d3aa0100400a0200abd5d55502562ac00a020055a0d500020655c00a0200abc0d50002062ac00a020055a0d500020655c00a0200abc0d50002062ac00a020055a0d500020655c00a0200abc0d50002062ac00a020055a0d500020655c00a0200abc0d50002062ac00a020055a0d500020655c01e0f00abc003e018000003e080000003c020fe000308806180e90002062ac01e0f0055a002020800000200884000012020fe000308802080e900020655c01e0f00abc002000800000200804000012020fe000308802080e90002062ac01e160055a00206087000020798f00001273c89c000089c2087e900020655c01f1700abc003c208880003c88840000128a28a20000fa2208880ea0002062ac01f170055a0020208f8000208884000012fa28a200008be208880ea00020655c01f1700abc0020208800002088840000128228a200008a0208880ea0002062ac01f170055a0020208880002088848000128a299e00008a2208880ea00020655c01e1600abc002071c700003e79c300003c73c682000089c71c7e90002062ac00f020055a0f400010220e400020655c00f0200abc0f4000101c0e40002062ac00a020055a0d500020655c00a0200abc0d50002062ac00a020055a0d500020655c00a0200abc0d50002062ac00a020055a0d500020655c00a0200abc0d50002062ac00a020055a0d500020655c00a0200abdfd5ff02fe2ac00a020055bfd5ff02fe55c00b0100abd6ff04f0fffe2ac00b010055d6ff04f0fffe55c00c0200abe0d7000420c1042ac00c020055e0d7000410c28255c00c0200abe0d7000420c1842ac00c020055e0d7000410c3c255c00c0200abe0d7000420c5c42ac00c020055e0d7000410cbe255c00c0200abe0d7000420c7e42ac00c020055e0d7000410cff255c00c0200abe0d7000420d7f42ac00c020055e0d7000410effa55c00c0200abe0d7000420dffc2ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410d55255c00c0200abe0d7000420eaac2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c0130200abe0ea000310400080f2000420effc2ac019020055e0f0000908200040000010410080f2000410dffa55c0190200abe0f0000908208040000010400080f2000420effc2ac01e020055e0f5000e820004000008200040000010430080f2000410dffa55c01e0200abe0f5000e82080400000821804000001fc10080f2000420effc2ac01e020055e0f5000e82000400000fe08040000010410080f2000410dffa55c01e0200abe0f5000e821804000008208040000010410080f2000420effc2ac01e020055e0f5000efe0804000008208040000010410080f2000410dffa55c01c0200abe0f5000c82080400000820804000001041f0000420effc2ac01e020055e0f500078208040000082080fe00031047c080f2000410dffa55c0180200abe0f5000882080400000823e040ec000420effc2ac011020055e0f500018208e5000410dffa55c0120200abe0f50002823e04e6000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c0130200abe0e5000302080010f7000420effc2ac013020055e0e5000302082010f7000410dffa55c0130200abe0e5000302080010f7000420effc2ac019020055e0f70002820004f2000302086010f7000410dffa55c0190200abe0f70002820804f2000303f82010f7000420effc2ac019020055e0f70002820004f2000302082010f7000410dffa55c0190200abe0f70002821804f2000302082010f7000420effc2ac019020055e0f70002fe0804f2000302082010f7000410dffa55c0180200abe0f70002820804f20002020820f6000420effc2ac019020055e0f70002820804f200030208f810f7000410dffa55c0120200abe0f70002820804e4000420effc2ac011020055e0f700018208e3000410dffa55c0120200abe0f70002823e04e4000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c0130200abe0fa000301040008e2000420effc2ac013020055e0fa000301041008e2000410dffa55c0130200abe0fa000301040008e2000420effc2ac013020055e0fa000301043008e2000410dffa55c0130200abe0fa000301fc1008e2000420effc2ac013020055e0fa000301041008e2000410dffa55c0130200abe0fa000301041008e2000420effc2ac013020055e0fa000301041008e2000410dffa55c0120200abe0fa0002010410e1000420effc2ac013020055e0fa000301047c08e2000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c0130200abe0f9000308200040e3000420effc2ac013020055e0f9000308208040e3000410dffa55c0130200abe0f9000308200040e3000420effc2ac013020055e0f9000308218040e3000410dffa55c0130200abe0f900030fe08040e3000420effc2ac013020055e0f9000308208040e3000410dffa55c0130200abe0f9000308208040e3000420effc2ac013020055e0f9000308208040e3000410dffa55c0120200abe0f90002082080e2000420effc2ac013020055e0f900030823e040e3000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420effc2ac00c020055e0d7000410dffa55c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c0130200abe0f4000308200040e8000420c0042ac013020055e0f4000308208040e8000410c00255c0130200abe0f4000308200040e8000420c0042ac013020055e0f4000308218040e8000410c00255c0130200abe0f400030fe08040e8000420c0042ac013020055e0f4000308208040e8000410c00255c0130200abe0f4000308208040e8000420c0042ac013020055e0f4000308208040e8000410c00255c0120200abe0f40002082080e7000420c0042ac01a020055e0f400030823e040fe000304100020ef000410c00255c0130200abe0ed000304104020ef000420c0042ac013020055e0ed000304100020ef000410c00255c0130200abe0ed00030410c020ef000420c0042ac013020055e0ed000307f04020ef000410c00255c0130200abe0ed000304104020ef000420c0042ac013020055e0ed000304104020ef000410c00255c0130200abe0ed000304104020ef000420c0042ac012020055e0ed0002041040ee000410c00255c0130200abe0ed00030411f020ef000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c0120200abe0e70002208001f4000420c0042ac012020055e0e70002208201f4000410c00255c0120200abe0e70002208001f4000420c0042ac012020055e0e70002208601f4000410c00255c0120200abe0e700023f8201f4000420c0042ac012020055e0e70002208201f4000410c00255c0120200abe0e70002208201f4000420c0042ac012020055e0e70002208201f4000410c00255c0110200abe0e700012082f3000420c0042ac012020055e0e70002208f81f4000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac012020055e0e40002410002f7000410c00255c0120200abe0e40002410402f7000420c0042ac012020055e0e40002410002f7000410c00255c0120200abe0e40002410c02f7000420c0042ac012020055e0e400027f0402f7000410c00255c0120200abe0e40002410402f7000420c0042ac012020055e0e40002410402f7000410c00255c0120200abe0e40002410402f7000420c0042ac011020055e0e400014104f6000410c00255c0120200abe0e40002411f02f7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac013020055e0e3000308200040f9000410c00255c0130200abe0e3000308208040f9000420c0042ac013020055e0e3000308200040f9000410c00255c0130200abe0e3000308218040f9000420c0042ac013020055e0e300030fe08040f9000410c00255c0130200abe0e3000308208040f9000420c0042ac013020055e0e3000308208040f9000410c00255c0130200abe0e3000308208040f9000420c0042ac012020055e0e30002082080f8000410c00255c0130200abe0e300030823e040f9000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac019020055e0f4000304100020f40002820004f8000410c00255c0190200abe0f4000304104020f40002820804f8000420c0042ac019020055e0f4000304100020f40002820004f8000410c00255c0190200abe0f400030410c020f40002821804f8000420c0042ac019020055e0f4000307f04020f40002fe0804f8000410c00255c0190200abe0f4000304104020f40002820804f8000420c0042ac019020055e0f4000304104020f40002820804f8000410c00255c0190200abe0f4000304104020f40002820804f8000420c0042ac017020055e0f40002041040f300018208f7000410c00255c0190200abe0f400030411f020f40002823e04f8000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c0130200abe0f2000310400080ea000420c0042ac013020055e0f2000310410080ea000410c00255c0130200abe0f2000310400080ea000420c0042ac019020055e0f2000310430080f90002208001f5000410c00255c0190200abe0f200031fc10080f90002208201f5000420c0042ac019020055e0f2000310410080f90002208001f5000410c00255c0190200abe0f2000310410080f90002208601f5000420c0042ac019020055e0f2000310410080f900023f8201f5000410c00255c0170200abe0f200011041f70002208201f5000420c0042ac019020055e0f200031047c080f90002208201f5000410c00255c0120200abe0e60002208201f5000420c0042ac011020055e0e600012082f4000410c00255c0120200abe0e60002208f81f5000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac012020055e0e80002410002f3000410c00255c0120200abe0e80002410402f3000420c0042ac019020055e0ef000308200040fe0002410002f3000410c00255c0190200abe0ef000308208040fe0002410c02f3000420c0042ac019020055e0ef000308200040fe00027f0402f3000410c00255c0190200abe0ef000308218040fe0002410402f3000420c0042ac019020055e0ef00030fe08040fe0002410402f3000410c00255c0190200abe0ef000308208040fe0002410402f3000420c0042ac018020055e0ef000308208040fe00014104f2000410c00255c0190200abe0ef000308208040fe0002411f02f3000420c0042ac012020055e0ef0002082080ec000410c00255c0130200abe0ef00030823e040ed000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420c0042ac00c020055e0d7000410c00255c00c0200abe0d7000420d5542ac00c020055e0d7000410eaba55c00c0200abe0d7000420d7f42ac00c020055e0d7000410cff255c00c0200abe0d7000420c7e42ac00c020055e0d7000410cbe255c00c0200abe0d7000420c5c42ac00c020055e0d7000410c3c255c00c0200abe0d7000420c1842ac00c020055e0d7000410c38255c00c0200abe0d7000420c1042ac00c020055f5d7550450eaaa55c00c0200abead7aa04a0d5542ac00902005580d4000155c0090200ab80d400012ac0090201ff80d400017fc00802000080d30000400b010055d6ff04f0000055c00b0100abd6ff04e000002ac013030055e004f4aa00a0e80006010010000055c0120300abe02df4550050e70005a02000002ac013030055e05cf4ff00f0e80006015010000055c0130400abe2bd7ff5ff00f0e70005ea2000002ac013030055e5fcf4ff00f0e80006017d10000055c0130400abebfd7ff5ff00f0e70005ffe000002ac013030055effcf4ff00f0e80006017f90000055c0130400abe3fd7ff5ff00f0e70005fe2000002ac013030055e0fcf4ff00f0e80006017810000055c0130400abe03d7ff5ff00f0e70005e02000002ac013030055e00cf4ff00f0e80006018010000055c00c0200abead7aa04a000002ac00c020055d5d7550450000055c0090200ab80d400012ac008010055d3000155c0060000d1aa00c00e0000fe550095d9550056fe5500c0060000d1aa00c00e0000fe550095d9550056fe5500c0060000d1aa00c00e0000fe550095d9550056fe5500c0060000d1aa00c00e0000feff00bfd9ff00fefeff00c0060001d1ff00c0ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 1.2 Implementation\par \pard\plain \f20 \par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 First of all, we have to define a subclass of the GINA class {\f22 application}. At run-time, exactly one instance of this class will exist. It contains the main event loop and transforms incoming events or callbacks into messages to other objects.\par \pard \s2\qj\ri1\sb40\sa100 The {\i initial values} for some slots of the superclass are overridden. The slot {\f22 name} is used e.g. in the title of each document window. {\f22 Document-type} denotes the type of document to be created when the {\f22 new}-command is executed. {\f22 Hello-world-document} is a subclass of the GINA class {\f22 document} explained below. The {\f22 file-type} implies that the document shown above will be stored in the file named {\f22 THE-S.hello} when it is saved. The {\f22 signature} will be stored inside that file and will be later used to find the application which can handle the document.\par \pard \s2\qj\ri1\sb40\sa100 Besides the definition of the new class, a {\i constructor}{\b  }{\i function} is defined, that can be used to create instances of the new class. The constructor function of the subclass calls the constructor of the superclass.\par \pard \s2\qj\ri1\sb40\sa100 Next, a subclass of the GINA class {\f22 document} is defined. An instance of this class will represent an open document at run-time. It contains the internal representation of the document contents and has methods to transform the contents into a stream of characters and vice versa.\par \pard \s2\qj\ri1\sb40\sa100 The class {\f22 hello-world-document} contains a slot to hold the list of mouse click positions. The document defines its own representation on the screen by overriding the method {\f22 create-windows}. In this case a shell containing a scrollable view of class {\f22 hello-world-view }is created. The menu bar is implicitly created as part of the {\f22 document-shell}. An application-specific command "Clear all" is added to the menu bar. When the menu item is chosen, an object of class {\f22 clear-all-command} will be created.\par \pard \s2\qj\ri1\sb40\sa100 Next, a subclass of the GINA class {\f22 view} has to be defined. Views are drawing areas, often larger than the screen and therefore scrollable, where documents display their contents. The contents of a view are normally not drawn by Motif, but by the Lisp application itself, using graphic primitives of the X library. Also, mouse clicks in the view are directly reported to the Lisp application.\par \pard \s2\qj\ri1\sb40\sa100 The class {\f22 hello-world-view}{\b  }overrides the method {\f22 draw}, which is called by GINA whenever the view or some part of it is exposed. It uses the method {\f22 draw-glyphs},{\f22  }which directly corresponds to the CLX function {\f22 draw-glyphs} to draw the Hi-strings. \par \pard \s2\qj\ri1\sb40\sa100 The {\f22 button-press} method is called whenever the mouse button goes down in the view. It creates a new instance of the class {\f22 add-hi-command.} This is a subclass of the GINA class {\f22 command}. An instance of this class contains the coordinates of the mouse click. The method {\f22 doit} pushes the coordinate pair onto the {\f22 hi-list}, {\f22 undoit} pops the hi-list again. In both cases {\f22 force-redraw }is called to completely redraw the view. A possible optimization would be to draw or clear just one single "Hi!".\par \pard \s2\qj\ri1\sb40\sa100 {\f22 Clear-all-command }is a subclass of the GINA class {\f22 command}. An instance of this class contains all the necessary information to execute and later undo the command. In this case, the current {\f22 hi-list }is stored. GINA calls the method {\f22 doit} (which clears the {\f22 hi-list} and redisplays) to execute the command and then pushes it onto a stack of commands already executed. Later, when the user calls the undo facility, GINA executes the method {\f22 undoit}. If the command is repeated in a redo operation, {\f22 doit} is called again. If repeating a command is different from executing it for the first time, the programmer can also override the method {\f22 redoit}.\par \pard \s2\qj\ri1\sb40\sa100 Finally, signature, class, and file type of the the new application are registered in a central table of GINA. Opening a document of type hello will create an instance of class {\f22 hello-world-application}. In addition, we create a file hello.appl which just contains the signature {\f22 "hello" }(in double quotes). Clicking this file in the Finder will start the new application with an empty document. In order to test the application, we can also directly call the creator function of our application subclass.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 1.3 Source Code\par \pard\plain \s10 \f22\fs12 ;;; -*- Mode\: LISP; Syntax\: Common-Lisp; Package\: hello; Base\: 10 -*-\par \par (in-package \:GINA)\par (defginapackage \:hello)\par (in-package \:hello)\par (setq *sccs-id* "@(#)hello.lisp\tab 1.4  1/15/92")\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class hello-world-application\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass hello-world-application (application)\par   (;; overrides\par    (name          \:initform "Hello World"         \:allocation \:class)\par    (document-type \:initform 'hello-world-document \:allocation \:class)\par    (signature     \:initform "hello"               \:allocation \:class)\par    (file-type     \:initform "hello"               \:allocation \:class))\par   (\:documentation "a simple demo application"))\par \par (defun make-hello-world-application ()\par   "start the hello-world-application"\par   (make-application \:class 'hello-world-application))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class hello-world-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass hello-world-document (document)\par   (;; instance-variables\par    (hi-list       \:initform nil \:accessor hi-list\par \tab \tab   \:documentation "List of coordinates where HIs are displayed"))\par   (\:documentation "application dependent document type"))\par \par (defmethod write-to-stream ((doc hello-world-document) stream)\par   "write the document to the specified stream"\par   (prin1 (hi-list doc) stream))\par \par (defmethod read-from-stream ((doc hello-world-document) stream) \par   "read the document from the specified stream"\par   (setf (hi-list doc) (read stream)))\par \par (defmethod create-windows ((doc hello-world-document) &aux scroller)\par   "create the windows belonging to this document"\par   (with-slots (main-shell main-view) doc\par     (setq main-shell (make-document-shell doc))\par     (setq scroller   (make-scroller main-shell))\par     (setq main-view  (make-hello-world-view scroller doc))\par \par     ;; add an application specific command\par     (add-menu-command (main-menu main-shell)\par \tab \tab       "Hello" "Clear all" (make-callback #'make-clear-all-command doc))\par     ))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class hello-world-view\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass hello-world-view (view)\par   ()\par   (\:documentation "a view with special draw method and reaction to clicks"))\par \par (defun make-hello-world-view (parent doc)\par   "create a new hello-world-view"\par   (make-view parent \:document doc \:class 'hello-world-view))\par \par (defmethod draw ((view hello-world-view) count x y width height)\par   "draw window contents"\par   (declare (ignore x y width height))\par   (when (zerop count) ;; Ignore all but the last exposure event\par     (loop for (x y) in (hi-list (document view))\par \tab   do (draw-glyphs view x y "Hi!"))))\par \par (defmethod button-press ((view hello-world-view) code repetition x y)\par   "react to button-press event in the window"\par   (declare (ignore code repetition))\par   (make-add-hi-command (document view) x y))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; undoable clear-all-command\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass clear-all-command (command)\par   ((name \:initform "Clear All Command" \:allocation \:class)\par    (old-hi-list \:accessor old-hi-list \:initarg \:old-hi-list)))\par \par (defun make-clear-all-command (document)\par   "create command object storing the current hi-list"\par   (make-command document\par \tab \tab \:class 'clear-all-command\par \tab \tab \:initargs (list \:old-hi-list (hi-list document))))\par \par (defmethod doit ((cmd clear-all-command))\par   "clear hi-list"\par   (with-slots (document) cmd\par     (setf (hi-list document) nil)\par     (force-redraw (main-view document))))\par \par \par (defmethod undoit ((cmd clear-all-command))\par   "restore hi-list"\par   (with-slots (document old-hi-list) cmd\par     (setf (hi-list document) old-hi-list)\par     (force-redraw (main-view document))))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; undoable add-hi-command\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass add-hi-command (command)\par   ((name \:initform "Add Hi Command" \:allocation \:class)\par    (hi \:accessor hi \:initarg \:hi)))\par \par (defun make-add-hi-command (document x y)\par   "create command object storing the x/y coordinates of the mouse-click"\par   (make-command document\par \tab \tab \:class 'add-hi-command\par \tab \tab \:initargs (list \:hi (list x y))))\par \par (defmethod doit ((cmd add-hi-command))\par   "add a new pair to hi-list"\par   (with-slots (document hi) cmd\par     (push hi (hi-list document))\par     (force-redraw (main-view document))))\par \par (defmethod undoit ((cmd add-hi-command))\par   "pop hi-list"\par   (with-slots (document) cmd\par     (pop (hi-list document))\par     (force-redraw (main-view document))))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; main program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (register-application "hello" 'hello-world-application "hello")\par '(make-hello-world-application)\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 2. Micky\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 2.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 The Micky application was heavily influenced by Kurt Schmucker's demo for MacApp. Our version, however, allows the user to stretch the width and height of Micky\'abs head using the two scales. The size is stored as the document contents on disk. Because of performance problems of a former X release (X11R3) there is a menu containing a radio button group to choose between a circular and a rectangular shape.\par \pard\plain \s7\qc\ri1\sb200\sa200\keepn \f34 {{\pict\macpict\picw472\pich460 26c50000000001cc01d8110101000a0000000001cc01d898003c0000000001cc01dc0000000401cc01dc0000000001cc01d800000bfe000004cd000380000010090005ca550395555570090302aaaaaccaaa00b0090005ca550395555570090302aaaaaccaaa00b0090005ca550395555570090302aaaaaccaaa00b0090005ca5503955555700c0302affffdcdff03bfffeab008010558c9000115700f0302aaaaacd0aa01ab2afeaa01cab012010559eb55005ff9ff00d5eb5503955555701a0302aaaaacedaa03affcff8ffcff00eaeeaa01ab2afeaa01cab016010559eb550851cfffcffffff81818ea5503900155701c0302aaaaacedaa09a89fffcffffffcce732aeeaa06ab2aaaaaaecab01b0305590015ed55095890f04c08cffcce7315ed55055415915555701c0302aaaaecedaa09a85ce64999cffc1e73eaeeaa06ab28eaaaaecab01802055915ec5509595ce7c39bfffcce7215eb5503915555701c0302aabfecedaa09a95ce7c3c3fffcce732aeeaa06ab29eaaaaecab017010559eb550959dce649c7cffcce7315eb5503915555701c0302aaaaacedaa09a1c0308c67cff818186aeeaa06ab2aaaaaaecab016010559eb55005ffeff00cffdff00d5eb550393fd55701b0302aaaaacedaa00affeff00cffdff00eaeeaa01ab2afeaa01cab016010559eb55005ffeff0087fdff00d5eb5503955555700e0302abfffdcfff057fffbfffcab007000fc8ff01dff008010006c9aa0180100801055dc955019570090102aeca0002018ab00901055dca0002019570090102aeca0002018ab00901055dca0002019570090102aeca0002018ab00901055dca0002019570090102aeca0002018ab00901055dca0002019570090102aeca0002018ab01a09055d001f00c000001f04fe00011e01fd000039dc00020195701a0e02ae00101040000010044200000901fd000045dc0002018ab01a0e055d00100040000010040200000901fd000041dc00020195701e1602ae001030438000103cc780000939e44e000041639e38df0002018ab01e16055d001e104440001e4442000009451451000039905144df00020195701e1602ae00101047c0001044420000097d145100000513d17cdf0002018ab01e16055d001010440000104442000009411451000005145140df00020195701e1602ae0010104440001044424000094514cf000045145e44df0002018ab01e16055d001038e380001f3ce180001e39e34100003913d038df0002019570110102aef3000011fd000010de0002018ab01101055df300000efd000010de0002019570090102aeca0002018ab00901055dca0002019570090102aeca0002018ab00901055dca0002019570090102aeca0002018ab00901055dca0002019570090102aeca0002018ab00801055dc9ff019570080102afc9ff018ab00801055cc900011570080102acc900010ab00e01055ce000020e3820ed000115700e0102ace00002114420ed00010ab00e01055ce00002114460ed000115700e0102ace000020144a0ed00010ab00e01055ce00002023ca0ed000115700e0102ace00002040520ed00010ab00e01055ce000020805f0ed000115700e0102ace00002104420ed00010ab00e01055ce000021f3820ed00011570080102acc900010ab00801055cc9000115700c0102acfd00000fceff018ab00c01055cfd00000fceff011570140102acfd00000ce6000002feaa00a0ee00018ab01501055cfd00000ce6000005fe550060ef0002011570140102acfd00000ce6000003feff00e0ee00018ab01501055cfd00000ce6000405fff7ffe0ef0002011570140102acfd00000ce6000003feff00e0ee00018ab01501055cfd00000ce6000405fff7ffe0ef0002011570140102acfd00000ce6000003feff00e0ee00018ab01501055cfd00000ce6000405fff7ffe0ef0002011570140102acfd00000ce6000003feff00e0ee00018ab01501055cfd00000ce6000405fff7ffe0ef0002011570140102acfd00000ce6000003feff00e0ee00018ab00c01055cfd00000dce550115700c0102acfd00000aceaa018ab00801055cc900011570080102acc900010ab00c05055c0000fffecd000115700c0502ac0000fffecd00010ab00c05055c0000c004cd00011570100602ac0000c0020fd1ff04fc3fff8ab01006055c0000c0040fd1ff04fc3fff1570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430611570100602ac0000c0020cd100040830a08ab01006055c0000c0040cd100040431711570100602ac0000c0020cd100040830f08ab01006055c0000c0040cd100040431f91570100602ac0000c0020cd100040832f88ab01006055c0000c0040cd100040435fd1570100602ac0000c0020cd100040833fc8ab01006055c0000c0040cd100040437ff1570100602ac0000c0020cd10004083ffe8ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040835548ab01006055c0000c0040cd10004043aab1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01006055c0000c0040cd10004043bff1570100602ac0000c0020cd100040837fe8ab01c06055c0000c0040cf400020ffff0f500023fffc0f00004043bff15701d0602ac0000c0020cf400027ffffef6000301fffff8f000040837fe8ab01f06055c0000c0040cf5000001feff0080f7000307fffffef00004043bff1570200602ac0000c0020cf5000007feff00e0f700001ffeff0080f100040837fe8ab02006055c0000c0040cf500001ffeff00f8f700007ffeff00e0f10004043bff15701e0602ac0000c0020cf500003ffeff00fcf700fdff00f0f100040837fe8ab01c06055c0000c0040cf500fcfff8000003fdff00fcf10004043bff1570200602ac0000c0020cf6000001fcff0080f9000007fdff00fef100040837fe8ab01e06055c0000c0040cf6000003fcff00c0f900000ffcfff10004043bff1570200602ac0000c0020cf6000007fcff00e0f900001ffcff0080f200040837fe8ab02006055c0000c0040cf6000007fcff00e0f900001ffcff0080f20004043bff1570200602ac0000c0020cf600000ffcff00f0f900003ffcff00c0f200040837fe8ab02006055c0000c0040cf600001ffcff00f8f900007ffcff00e0f20004043bff15701e0602ac0000c0020cf600003ffcff00fcf900fbff00f0f200040837fe8ab01e06055c0000c0040cf600003ffcff00fcf900fbff00f0f20004043bff1570200602ac0000c0020cf600007ffcff00fefa000001fbff00f8f200040837fe8ab02006055c0000c0040cf600007ffcff00fefa000001fbff00f8f20004043bff15701c0602ac0000c0020cf600fafffa000003fbff00fcf200040837fe8ab01c06055c0000c0040cf600fafffa000003fbff00fcf20004043bff15701c0602ac0000c0020cf600fafffa000003fbff00fcf200040837fe8ab02006055c0000c0040cf7000001faff0080fb000007fbff00fef20004043bff1570200602ac0000c0020cf7000001faff0080fb000007fbff00fef200040837fe8ab02006055c0000c0040cf7000001faff0080fb000007fbff00fef20004043bff1570200602ac0000c0020cf7000001faff0080fb000007fbff00fef200040837fe8ab02006055c0000c0040cf7000001faff0080fb000007fbff00fef20004043bff1570200602ac0000c0020cf7000001faff0080fb000007fbff00fef200040837fe8ab02006055c0000c0040cf7000001faff0080fb000007fbff00fef20004043bff1570200602ac0000c0020cf7000001faff0080fb000007fbff00fef200040837fe8ab02006055c0000c0040cf7000001faff0080fb000007fbff00fef20004043bff1570200602ac0000c0020cf7000001faff0080fb000007fbff00fef200040837fe8ab02006055c0000c0040cf7000001faff0080fb000007fbff00fef20004043bff1570200602ac0000c0020cf7000001faff0080fb000007fbff00fef200040837fe8ab02006055c0000c0040cf7000001faff0080fb000007fbff00fef20004043bff1570200602ac0000c0020cf7000001faff0080fb000007fbff00fef200040837fe8ab02006055c0000c0040cf7000001faff0080fb000007fbff00fef20004043bff15701c0602ac0000c0020cf600fafffa000003fbff00fcf200040837fe8ab01c06055c0000c0040cf600fafffa000003fbff00fcf20004043bff1570210602ac0000c0020cf600faff0700001fffffe00003fbff00fcf200040837fe8ab02406055c0000c0040cf600007ffcff08fe0007e000001f8001fbff00f8f20004043bff1570230602ac0000c0020cf600007ffcff02fe003cfd0001f001fbff00f8f200040837fe8ab02306055c0000c0040cf600003ffcff02fc03c0fd00010f00fbff00f0f20004043bff1570220602ac0000c0020cf600003ffcff01fc0efc000101c0fbff00f0f200040837fe8ab02206055c0000c0040cf600001ffcff01f870fb0001387ffcff00e0f20004043bff1570220602ac0000c0020cf600000ffcff01f180fb0001063ffcff00c0f200040837fe8ab02106055c0000c0040cf6000007fcff00e6fa0001019ffcff0080f20004043bff1570200602ac0000c0020cf6000007fcff00f8f900007ffcff0080f200040837fe8ab01e06055c0000c0040cf6000003fcff00e0f900001ffcfff10004043bff1570200602ac0000c0020cf6000001fcff0080f9000007fdff00fef100040837fe8ab01c06055c0000c0040cf500fcfff8000003fdff00fcf10004043bff15701e0602ac0000c0020cf500003ffeff00fcf700fdff00f0f100040837fe8ab02006055c0000c0040cf500001ffeff00f8f700007ffeff00e0f10004043bff1570200602ac0000c0020cf5000007feff00e0f700001ffeff0080f100040837fe8ab01f06055c0000c0040cf5000001feff00c0f700030ffffffef00004043bff15701d0602ac0000c0020cf400027ffffff6000303fffff8f000040837fe8ab01d06055c0000c0040cf400020ffff2f60003013fffc0f00004043bff1570180602ac0000c0020cf200000cf50000c0ee00040837fe8ab01806055c0000c0040cf2000018f5000060ee0004043bff1570180602ac0000c0020cf2000030f5000030ee00040837fe8ab01806055c0000c0040cf2000060f5000018ee0004043bff1570180602ac0000c0020cf20000c0f500000cee00040837fe8ab01906055c0000c0040cf300010180f5000006ee0004043bff1570180602ac0000c0020cf3000003f4000003ee00040837fe8ab01806055c0000c0040cf3000002f4000001ee0004043bff1570180602ac0000c0020cf3000004f3000080ef00040837fe8ab01806055c0000c0040cf3000008f3000040ef0004043bff1570180602ac0000c0020cf3000010f3000020ef00040837fe8ab01806055c0000c0040cf3000030f3000030ef0004043bff1570180602ac0000c0020cf3000020f3000010ef00040837fe8ab01806055c0000c0040cf3000040f3000008ef0004043bff1570180602ac0000c0020cf30000c0f300000cef00040837fe8ab01806055c0000c0040cf3000080f3000004ef0004043bff1570220602ac0000c0020cf4000001fd000107f8fd00017f80fe000002ef00040837fe8ab02206055c0000c0040cf4000003fd00010804fd00018040fe000003ef0004043bff1570230602ac0000c0020cf4000002fd00011002fe0002010020fe000001ef00040837fe8ab02306055c0000c0040cf4000004fd00012001fe0002020010fd000080f00004043bff1570230602ac0000c0020cf4000004fd00076001800000060018fd000080f000040837fe8ab02306055c0000c0040cf4000008fd00074000800000040008fd000040f00004043bff1570230602ac0000c0020cf4000008fd00074000800000040008fd000040f000040837fe8ab02306055c0000c0040cf4000010fd00074000800000040008fd000020f00004043bff1570230602ac0000c0020cf4000010fd00074000800000040008fd000020f000040837fe8ab02306055c0000c0040cf4000030fd00076001800000060018fd000030f00004043bff1570230602ac0000c0020cf4000020fd00012001fe0002020010fd000010f000040837fe8ab02306055c0000c0040cf4000020fd00011002fe0002010020fd000010f00004043bff1570220602ac0000c0020cf4000040fd00010804fd00018040fd000008f000040837fe8ab02206055c0000c0040cf4000040fd000107f8fd00017f80fd000008f00004043bff1570180602ac0000c0020cf4000040f1000008f000040837fe8ab01806055c0000c0040cf4000080f1000004f00004043bff1570180602ac0000c0020cf4000080f1000004f000040837fe8ab01806055c0000c0040cf4000080f1000004f00004043bff1570180602ac0000c0020cf5000001f0000002f000040837fe8ab01806055c0000c0040cf5000001f0000002f00004043bff1570180602ac0000c0020cf5000001f0000002f000040837fe8ab01806055c0000c0040cf5000001f0000002f00004043bff1570180602ac0000c0020cf5000002f0000001f000040837fe8ab01806055c0000c0040cf5000002f0000001f00004043bff1570180602ac0000c0020cf5000002f0000001f000040837fe8ab01d06055c0000d5540cf5000002f9000107f8fa000001f00004043bff15701d0602ac0000eaaa0cf5000002f900010ffcfa000001f000040837fe8ab01d06055c0000dffc0cf5000002f900011ffefa000001f00004043bff15701d0602ac0000effa0cf5000004f900013ffff9000080f100040837fe8ab01d06055c0000dffc0cf5000004f900013ffff9000080f10004043bff15701d0602ac0000effa0cf5000004f900013ffff9000080f100040837fe8ab01d06055c0000dffc0cf5000004f900013ffff9000080f10004043bff15701d0602ac0000effa0cf5000004f900013ffff9000080f100040837fe8ab01d06055c0000dffc0cf5000004f900013ffff9000080f10004043bff15701d0602adc708effa0cf5000004f900013ffff9000080f100040837fe8ab01d06055e2898dffc0cf5000004f900011ffef9000080f10004043bff15701d0602ae28a8effa0cf5000004f900010ffcf9000080f100040837fe8ab01d06055c2888dffc0cf5000004f9000107f8f9000080f10004043bff1570180602ac4708effa0cf5000004ef000080f100040837fe8ab01806055c8888dffc0cf5000004ef000080f10004043bff1570180602ad0888eaaa0cf5000004ef000080f100040837fe8ab01806055e0888dffc0cf5000004ef000080f10004043bff1570180602afe73eeffa0cf5000004ef000080f100040837fe8ab01806055c0000dffc0cf5000004ef000080f10004043bff1570180602ac0000effa0cf5000002f0000001f000040837fe8ab01806055c0000dffc0cf5000002f0000001f00004043bff1570180602ac0000effa0cf5000002f0000001f000040837fe8ab01806055c0000dffc0cf5000002f0000001f00004043bff1570180602ac0000effa0cf5000002f0000001f000040837fe8ab01806055c0000dffc0cf5000002f0000001f00004043bff1570180602ac0000effa0cf5000001f0000002f000040837fe8ab01806055c0000dffc0cf5000001f0000002f00004043bff1570180602ac0000effa0cf5000001f0000002f000040837fe8ab01806055c0000dffc0cf5000001f0000002f00004043bff1570180602ac0000fffa0cf4000080f1000004f000040837fe8ab01806055c0000c0040cf4000080f1000004f00004043bff1570180602ac0000c0020cf4000080f1000004f000040837fe8ab01806055c0000c0040cf4000040f1000008f00004043bff1570180602ac0000c0020cf4000040f1000008f000040837fe8ab01806055c0000c0040cf4000040f1000008f00004043bff1570200602ac0000c0020cf4000020fd000004fc000001fc000010f000040837fe8ab02006055c0000c0040cf4000020fd000006fc000003fc000010f00004043bff1570210602ac0000c0020cf4000030fd00010180fd00000cfc000030f000040837fe8ab02006055c0000c0040cf4000010fc000060fd000030fc000020f00004043bff1570200602ac0000c0020cf4000010fc000018fd0000c0fc000020f000040837fe8ab02006055c0000c0040cf4000008fc000007fe000007fb000040f00004043fff1570200602ac0000c0020cf4000008fc000401e000003cfb000040f000040830008ab01f06055c0000c0040cf4000004fb00031f0007c0fb000080f0000404300115701d0602ac0000c0020cf4000004fa0001fff8fa000080f000040830008ab01806055c0000c0040cf4000002f2000001ef00040430011570180602ac0000c0020cf4000003f2000003ef00040830008ab01806055c0000c0040cf4000001f2000002ef00040430011570180602ac0000c0020cf3000080f3000004ef00040830008ab01806055c0000c0040cf30000c0f300000cef00040430011570180602ac0000c0020cf3000040f3000008ef00040830008ab01806055c0000c0040cf3000020f3000010ef00040430011570180602ac0000c0020cf3000030f3000030ef00040830008ab01806055c0000c0040cf3000010f3000020ef00040430011570180602ac0000c0020cf3000008f3000040ef00040830008ab01806055c0000c0040cf3000004f3000080ef00040430011570180602ac0000c0020cf3000002f4000001ee00040830008ab01806055c0000c0040cf3000003f4000003ee00040430011570190602ac0000c0020cf300010180f5000006ee00040830008ab01806055c0000c0040cf20000c0f500000cee00040430011570180602ac0000c0020cf2000060f5000018ee00040830008ab01806055c0000c0040cf2000030f5000030ee00040430011570180602ac0000c0020cf2000018f5000060ee00040830008ab01806055c0000c0040cf200000cf50000c0ee00040430011570180602ac0000c0020cf2000002f6000001ed00040830008ab01806055c0000c0040cf2000001f6000002ed00040430011570180602ac0000c0020cf10000c0f700000ced00040830008ab01806055c0000c0040cf1000060f7000018ed00040430011570180602ac0000c0020cf1000010f7000020ed00040830008ab01806055c0000c0040cf100000cf70000c0ed00040430011570180602ac0000c0020cf1000003f8000003ec00040830008ab01906055c0000c0040cf100010180f9000006ec00040430011570180602ac0000c0020cf0000060f9000018ec00040830008ab01806055c0000c0040cf0000018f9000060ec00040430011570190602ac0000c0020cf0000006fa00010180ec00040830008ab01906055c0000c0040cf000010180fb000006eb00040430011570180602ac0000c0020cef000070fb000038eb00040830008ab01906055c0000c0040cef00000efc000101c0eb00040430011570190602ac0000c0020cef000103c0fd00000fea00040830008ab01806055c0000c0040cee00003cfd0000f0ea00040430011570190602ac0000c0020cee000507e000001f80ea00040830008ab01706055c0000c0040ced00031fffffe0e900040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040430011570100602ac0000c0020cd100040830008ab01006055c0000c0040cd100040435551570100602ac0000c0020cd10004083aae8ab01006055c0000c0040cd100040435fd1570100602ac0000c0020cd100040833fc8ab01006055c0000c0040cd100040431f91570100602ac0000c0020cd100040832f88ab01006055c0000c0040cd100040431711570100602ac0000c0020cd100040830f08ab01006055c0000c0040cd100040430611570100602ac0000c0020cd100040830e08ab01006055c0000c0040cd100040430411570100602ac0000c0020ed1aa04a83aaa8ab01006055c0000c0040dd1550454355515700c0502ac0000c002cd00010ab00c05055c0000c004cd000115700c050ffc0000c002cd00011ff00b0500040000c004cc000010100602ac0000c0020fd1ff04fc00000ab01006055c0000c0040fd1ff04fc00001570170802ac0000c0020c0095df550054f70005200800000ab01407055c0000c0040c05ddaaf70005500400001570170802ac0000c0020c0b9fdfff00fef700052a0800000ab01708055c0000c0040c57afdfff00fef700055d0400001570170802ac0000c0020cbf9fdfff00fef700053ea800000ab01708055c0000c0040d7fafdfff00fef700055ff400001570170802ac0000c0020dff9fdfff00fef700053fe800000ab01708055c0000c0040c7fafdfff00fef700055f8400001570170802ac0000c0020c1f9fdfff00fef700053e0800000ab01708055c0000c0040c07afdfff00fef70005780400001570170802ac0000c0020c019fdfff00fef70005200800000ab01006055c0000d5540dd155045400001570100602ac0000aaaa0ad1aa04a800000ab00801055cc900011570080102a8c900010ab0090005ca550395555570090302aaaaaccaaa00b0090005ca550395555570090302aaaaaccaaa00b0090005ca550395555570090302aaaaaccaaa00b0090005ca5503955555700c0307fffffdcdff03bffffff006000fc7ff00f0ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 \page 2.2 Implementation\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 An application subclass is defined as usual. The document class contains the width and height of Micky\'abs head, a flag indicating the shape of the head, and references to the two scales. The slots {\f22 shell-width} and {\f22 shell-height} are overridden so that a certain initial size is used for the shell. By default the size of a shell is determined by the widgets contained in it. The user can resize the shell, and the new size will be stored on disk when the document is saved.\par \pard \s2\qj\ri1\sb40\sa100 The shell contains a form widget which organizes the layout of the two scales and the scroller. The form constraints are defined in such a way that mainly the scroller is resized when the shell is resized.\par \pard \s2\qj\ri1\sb40\sa100 Whenever a scale is operated, the method {\f22 new-micky-width} or {\f22 new-micky-height} is called at the document object with the new value of the scale as an argument. Note that the {\f22 value-changed-callback} of a scale can be set by a keyword parameter, while the less frequently used {\f22 drag-callback} must be explicitly assigned using {\f22 setf.}The methods {\f22 new-micky-width and new-micky-height }store the new size and redraw the view. In addition, the document is marked as modified. We must use the accessor function for the slot {\f22 modified} because it has a demon which makes then {\f22 Save} menu entry sensitive.{\f22 \par }\pard \s2\qj\ri1\sb40\sa100 A radio button group is inserted in the main menu of the shell which allows to choose between the two possible shapes. Whenever the shape is changed the method {\f22 toggle-shape} is called. \par \pard \s2\qj\ri1\sb40\sa100 The method {\f22 write-to-stream} simply writes out the width and height of Micky. When the method {\f22 read-from-stream }is called, GINA automatically redraws the main view of the document, so that the new size of Micky is displayed. However, we explicitly have to indicate the new size in the two scales. Alternatively, we could override the method {\f22 redraw-views} which by default just redraws the views showing the document contents.\par \pard \s2\qj\ri1\sb40\sa100 Finally, the {\f22 draw} method of class {\f22 micky-view} contains a lot of calls to {\f22 draw-arc} and {\f22 draw-rectangle} to display Micky\'abs head.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 2.3 Limitations and Extensions\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 As a further extension, reshaping could be made undoable. To achieve this, a command object would have to be created each time a scale is operated.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 2.4 Source Code\par \pard\plain \s10 \f22\fs12 ;;; -*- Mode\: LISP; Syntax\: Common-Lisp; Package\: micky;Base\: 10-*-\par \par (in-package \:GINA)\par (defginapackage \:micky)\par (in-package \:micky)\par (setq *sccs-id* "@(#)micky.lisp\tab 1.4  1/15/92")\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class micky-application\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass micky-application (application)\par   (;; overrides\par    (name          \:initform "Micky"         \:allocation \:class)\par    (document-type \:initform 'micky-document \:allocation \:class)\par    (signature     \:initform "micky"         \:allocation \:class)\par    (file-type     \:initform "micky"         \:allocation \:class))\par   (\:documentation "a simple demo application"))\par \par (defun make-micky-application ()\par   "start the micky-application"\par   (make-application \:class 'micky-application))\par \par \par \par \par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class micky-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass micky-document (document)\par   (;; instance-variables\par    (circles      \:accessor circles \:initform t)\par    (micky-width  \:initform 100 \:accessor micky-width\par \tab \tab  \:documentation "Width of scalable Micky-Mouse")\par    (micky-height \:initform 100 \:accessor micky-height\par \tab \tab  \:documentation "Height of scalable Micky-Mouse")\par    (h-scale      \:accessor h-scale)\par    (v-scale      \:accessor v-scale)\par    \par    ;; overrides\par    (shell-width  \:initform 300)\par    (shell-height \:initform 400))\par   (\:documentation "application dependent document type"))\par \par (defmethod create-windows ((doc micky-document) &aux form scroller)\par   "create the windows belonging to this document"\par   (with-slots (main-shell main-view h-scale v-scale) doc\par     ;; create document-shell\par     (setq main-shell (make-document-shell doc))\par     ;; the main-part of the window is organized as a form\par     (setq form (make-form main-shell))\par     ;; horizontal scale to change the width of Micky\par     (setq h-scale (make-scale form\par \tab \tab \tab       \:orientation \:horizontal\par \tab \tab \tab       \:value (micky-width  doc)\par \tab \tab \tab       \:maximum 500\par \tab \tab \tab       \:value-changed-callback\par \tab \tab \tab       (make-callback #'new-micky-width doc)\par \tab \tab \tab       ))\par     (setf (drag-callback h-scale) (make-callback #'new-micky-width doc))\par     \par     ;; vertical scale to change the height of Micky\par     (setq v-scale (make-scale form\par \tab \tab \tab       \:orientation \:vertical\par \tab \tab \tab       \:processing-direction \:max-on-bottom\par \tab \tab \tab       \:value (micky-height doc)\par \tab \tab \tab       \:maximum 500\par \tab \tab \tab       \:value-changed-callback\par \tab \tab \tab       (make-callback #'new-micky-height doc)\par \tab \tab \tab       ))\par     (setf (drag-callback v-scale) (make-callback #'new-micky-height doc))\par     \par     (setq scroller (make-scroller form \:motif-resources (list \:width 250 \:height 300)))\par     \par     ;; create the view\par     (setq main-view (make-view scroller\par \tab \tab \tab        \:width 500 \:height 500 \:document doc\par \tab \tab \tab        \:class 'micky-view))\par     ;; define the layout of the form\par     (define-form-constraint h-scale\par \tab \tab \tab     \:top-attachment   \:form \par \tab \tab \tab     \:left-attachment  \:widget \:left-widget v-scale\par \tab \tab \tab     \:right-attachment \:form)\par     (define-form-constraint v-scale\par \tab \tab \tab     \:top-attachment    \:form \:top-offset 30\par \tab \tab \tab     \:left-attachment   \:form\par \tab \tab \tab     \:bottom-attachment \:form)\par     (define-form-constraint scroller\par \tab \tab \tab     \:top-attachment  \:widget \:top-widget  h-scale \par \tab \tab \tab     \:left-attachment \:widget \:left-widget v-scale \par \tab \tab \tab     \:right-attachment  \:form \par \tab \tab \tab     \:bottom-attachment \:form)\par \par     ;; add a radio group within the main menu to set the desired shape\par     (insert-menu-entry (main-menu main-shell) "Shape" "Group"\par \tab \tab        (make-radio-group-entry "Group"\par \tab \tab \tab \tab \tab \tab '("Circle" "Rectangle")\par \tab \tab \tab \tab \tab \tab (make-callback #'toggle-shape doc)\par \tab \tab \tab \tab \tab \tab \:is-submenu nil))\par     \par     ))\par \par (defmethod new-micky-width ((doc micky-document) new-width)\par   "user has changed width of Micky-Mouse"\par   (with-slots (main-view micky-width) doc\par     (setq micky-width new-width)\par     (force-redraw main-view)\par     (setf (modified doc) t)))\par \par (defmethod new-micky-height ((doc micky-document) new-height)\par   "user has changed height of Micky-Mouse"\par   (with-slots (main-view micky-height) doc\par     (setq micky-height new-height)\par     (force-redraw main-view)\par     (setf (modified doc) t)))\par \par (defmethod toggle-shape ((doc micky-document) new-shape old-shape)\par   "toggle between circle and rectangle presentation"\par   (declare (ignore old-shape))\par   (with-slots (circles main-view v-scale h-scale) doc\par     (setq circles (equal new-shape "Circle"))\par     (force-redraw main-view)))\par \par (defmethod write-to-stream ((doc micky-document) stream)\par   "write the document to the specified stream"\par   (format stream "~d ~d~%" (micky-width  doc) (micky-height doc)))\par \par (defmethod read-from-stream ((doc micky-document) stream) \par   "read the document from the specified stream"\par   (with-slots (h-scale v-scale micky-width micky-height) doc\par     (setq micky-width  (read stream))\par     (setq micky-height (read stream))\par     (setf (value h-scale) micky-width)\par     (setf (value v-scale) micky-height)))\par \par \par \par \par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class micky-view\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass micky-view (view)\par   ()\par   (\:documentation "a view with special draw method and reaction to clicks"))\par \par (defmethod draw ((view micky-view) count x y width height)\par   "draw window contents"\par   (declare (ignore x y width height))\par   (with-slots (x-window gcontext document) view\par     (with-slots (micky-width micky-height circles) document \par       (when (zerop count) ;; Ignore all but the last exposure event\par \tab (when circles \par \tab   ;; outline of the head\par \tab   (draw-arc view\par \tab \tab     (round (* 0.35 micky-width)) (round (* 0.43 micky-height))\par \tab \tab     (round (* 0.5 micky-width)) (round (* 0.5 micky-height))\par \tab \tab     0 (* 2 pi) nil)\par \tab   ;; ears\par \tab   (draw-arc view \par \tab \tab     (round (* 0.3 micky-width)) (round (* 0.3 micky-height))\par \tab \tab     (round (* 0.2 micky-width)) (round (* 0.2 micky-height))\par \tab \tab     0 (* 2 pi) t)\par \tab   (draw-arc view\par \tab \tab     (round (* 0.7 micky-width)) (round (* 0.3 micky-height))\par \tab \tab     (round (* 0.2 micky-width)) (round (* 0.2 micky-height))\par \tab \tab     0 (* 2 pi) t)\par \tab   ;; nose\par \tab   (draw-arc view\par \tab \tab     (round (* 0.58 micky-width)) (round (* 0.64 micky-height))\par \tab \tab     (round (* 0.05 micky-width)) (round (* 0.05 micky-height))\par \tab \tab     0 (* 2 pi) t)\par \tab   ;; eyes\par \tab   (draw-arc view\par \tab \tab     (round (* 0.5 micky-width)) (round (* 0.55 micky-height))\par \tab \tab     (round (* 0.05 micky-width)) (round (* 0.05 micky-height))\par \tab \tab     0 (* 2 pi) nil)\par \tab   (draw-arc view\par \tab \tab     (round (* 0.65 micky-width)) (round (* 0.55 micky-height))\par \tab \tab     (round (* 0.05 micky-width)) (round (* 0.05 micky-height))\par \tab \tab     0 (* 2 pi) nil)\par \tab   ;; mouth\par \tab   (draw-arc view\par \tab \tab     (round (* 0.45 micky-width)) (round (* 0.5 micky-height))\par \tab \tab     (round (* 0.3 micky-width)) (round (* 0.3 micky-height))\par \tab \tab     (* 1.3 pi) (* 0.4 pi) nil))\par \par \tab (when (not circles) \par \tab   ;; outline of the head\par \tab   (draw-rectangle view\par \tab \tab \tab   (round (* 0.35 micky-width)) (round (* 0.43 micky-height))\par \tab \tab \tab   (round (* 0.5 micky-width)) (round (* 0.5 micky-height)) nil)\par \tab   ;; ears\par \tab   (draw-rectangle view\par \tab \tab \tab   (round (* 0.3 micky-width)) (round (* 0.3 micky-height))\par \tab \tab \tab   (round (* 0.2 micky-width)) (round (* 0.2 micky-height))  t)\par \tab   (draw-rectangle view\par \tab \tab \tab   (round (* 0.7 micky-width)) (round (* 0.3 micky-height))\par \tab \tab \tab   (round (* 0.2 micky-width)) (round (* 0.2 micky-height))  t)\par \tab   ;; nose\par \tab   (draw-rectangle view\par \tab \tab \tab   (round (* 0.58 micky-width)) (round (* 0.64 micky-height))\par \tab \tab \tab   (round (* 0.05 micky-width)) (round (* 0.05 micky-height)) t)\par \tab   ;; eyes\par \tab   (draw-rectangle view\par \tab \tab \tab   (round (* 0.5 micky-width)) (round (* 0.55 micky-height))\par \tab \tab \tab   (round (* 0.05 micky-width)) (round (* 0.05 micky-height)) nil)\par \tab   (draw-rectangle view\par \tab \tab \tab   (round (* 0.65 micky-width)) (round (* 0.55 micky-height))\par \tab \tab \tab   (round (* 0.05 micky-width)) (round (* 0.05 micky-height)) nil)\par \tab   ;; mouth\par \tab   (draw-line view\par \tab \tab      (round (* 0.5 micky-width)) (round (* 0.8 micky-height))\par \tab \tab      (round (* 0.7 micky-width)) (round (* 0.8 micky-height))))\par \tab ))))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; main program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (register-application "micky" 'micky-application "micky")\par '(make-micky-application)\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 3. Text-Editor\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 3.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 This demo shows how the Motif text widget can be turned into a complete and useful application with just a few lines of code. Multiple documents can be openend, edited, and saved.\par \pard\plain \s7\qc\ri1\sb200\sa200\keepn \f34 {{\pict\macpict\picw450\pich271 16f400000000010f01c2110101000a00000000010f01c298003a00000000010f01c900000007010f01c900000000010f01c200000cfd000080d1000004fe0000800a0000cdaa04acaaaaab800a0000fe550095cd5500800a0000cdaa04acaaaaab800a0000fe550095cd5500800a0000cdaa04acaaaaab800a0000fe550095cd5500800a0000cdaa04acaaaaab800e040055ffffbfd1ff04fdffff5580080100abcb0001ab80100000fe550095d3550059fe5502565580140200ab2af0aa00bff3ff00eaf0aa04acaaaaab801d0000fe550095f255005ffcff018e7ffaff00d5f2550059fe55025655801f0200ab2af0aa0fb03fffcffe07cff9ffff021f1810f8eaf0aa04ac800aab80230000fe550095f2550f54bfffcfff37cff9ffff993f9cc9fcd5f2550059fe5502765580210300ab2002f1aa0fbcf0c481ff3e087039ff993f2cc9f96af1aa05a0ac8aaaab8022040055555d95f2550e5ce661cfff0cce79f9ff833f2c19f9f15506594755557655801f0200ab22f0aa0fbce073cf032cce79ffff993f0cc9f86af0aa04ac8aaaab802304005557fd95f2550f5ce7e1cfff3cce79ffff993e64c9f315f25506594f55557655801f0200ab2af0aa0fbce644cdff34ce79b9ff993664c9b32af0aa04ac8aaaab80230000fe550095f2550f5870cce3fe06001c79ff020460102315f2550059fe5502765580140200ab2af0aa00bff3ff00eaf0aa04ac9feaab80180000fe550095f255005ff3ff00d5f2550059fe5502565580140200ab2af0aa00bff3ff00eaf0aa04acaaaaab80100400557fffbfd3ff06fbfffdfffe5580080001cbff02feff8009010000ccaa02a800800a0200abd5cd550254ab800a020055a0cd00020c55800a0200abc0cd00020cab800a020055a0cd00020c55800a0200abc0cd00020cab800a020055a0cd00020c55800a0200abc0cd00020cab800a020055a0cd00020c55800a0200abc0cd00020cab800a020055a0cd00020c5580170f00abc003e018000003e080000003c020da00020cab80170f0055a002020800000200884000012020da00020c5580170f00abc002000800000200804000012020da00020cab8019110055a00206087000020798f00001273c89c0dc00020c5580191100abc003c208880003c88840000128a28a20dc00020cab8019110055a0020208f8000208884000012fa28a20dc00020c5580191100abc0020208800002088840000128228a20dc00020cab8019110055a0020208880002088848000128a299e0dc00020c5580191100abc002071c700003e79c300003c73c6820dc00020cab800f020055a0f400010220dc00020c55800f0200abc0f4000101c0dc00020cab800a020055a0cd00020c55800a0200abc0cd00020cab800a020055a0cd00020c55800a0200abc0cd00020cab800a020055a0cd00020c55800a0200abc0cd00020cab800a020055a0cd00020c55800a0200abdfcdff02fcab800a020055bfcdff02fc55800b0100abceff04e1fffcab800b010055ceff04e1fff855800b0100abceff04c18004ab800b010055ceff04a1830855800c0200abf8cf0004418504ab800c020055f8cf0004218b8855800c0200abf8cf0004418784ab800c020055f8cf0004218fc855800c0200abf8cf00044197c4ab801f150055f800230008c00c08000c08030200230000230008e2000421afe855801f1500abf800248009201208001208048200248000248008e20004419fe4ab801f150055f800240009001008001008040200240000240008e2000421bff855801f1500abf871e41c79071079c71079c41e71e41c71e41c78e2000441fff4ab801f150055f88a2f228bc8bc8a28bc8a2f228a2f228a2f2288e2000421800855801f1500abf88a24228908908a26108a24228a242262242288e2000441aaa4ab801f150055f88a24228908908a21108a24228a242212242288e2000421d55855801f1500abf87a241e89079089e89089e4227a241e8a241e88e2000441bff4ab801f150055f809e40279009078271078241e09e40271e40278e2000421dff855801e1400abf8880022000880022000022000880022000022e1000441bff4ab801e140055f870001c00070001c00001c00070001c00001ce1000421dff855800c0200abf8cf000441bff4ab800c020055f8cf000421dff85580150b00abf808c00200c30200c080d8000441bff4ab80150b0055f8092002012482012080d8000421dff85580150b00abf8090002010402010080d8000441bff4ab80150b0055f879071e71041e71079cd8000421dff85580150b00abf88bc8a28bcf228bc8a2d8000441bff4ab80150b0055f8890622610422610898d8000421dff85580150b00abf8890122110422110884d8000441bff4ab80150b0055f88908a28904228908a2d8000421dff85580150b00abf879071e71041e71079cd8000441bff4ab800c020055f8cf000421dff855800c0200abf8cf000441bff4ab800c020055f8cf000421dff855800c0200abf8cf000441bff4ab80150b0055f800230008c00230008cd8000421dff85580150b00abf8002480092002480092d8000441bff4ab80150b0055f8002400090002400090d8000421dff85580150b00abf871e41c79071e41c790d8000441bff4ab80150b0055f88a2f228bc8a2f228bcd8000421dff85580150b00abf8622418890622418890d8000441bff4ab80150b0055f8122404890122404890d8000421dff85580150b00abf88a24228908a2422890d8000441bff4ab80150b0055f871e41c79071e41c790d8000421dff855800c0200abf8cf000441bff4ab800c020055f8cf000421dff85580120200abf8fe000003f0ffe4000441bff4ab8012020055f8fe000003f0ffe4000421dff85580270900abf80023000b3ffdcffaff10df7dffdffff7ff00002000080002000080ee000441bff4ab802c220055f80024800adffdb7feffeffffbefffdf7dffdfeff7fb0040201008040201008040ef00042180085580270900abf80024000afffdbffaff10df7dffdffff7ff00002000080002000080ee0004418004ab803b390055f871e41c7af8e1be3cddcdd8f3ce37536d375bce34f370c72c31cb0c72c31cb0cd34d34d34d34d34d34d34d34d34d34d34d34d21800855802c2200abf88a2f2288375d0ddeddedd77bedd74d5cd757edd37b8848b2122c848b2122c84aefaa04c18004ab802c220055f86224188af9ddbddeddedd77bedd75d3dd74fedd77b8848a21228848a2122884aefaa04a1800855802c2200abf81224048afeddbddeebeeb77beddadd5ddad7edd77b8848a21228848a2122884aefaa04c18004ab802c220055f88a24228af75dbe1eebeeb87bee1add6ddadbee177b7847a211e8847a211e884aefaa04a1800855803b3900abf871e41c7af8e1bfd6f76f7f5b6fdddd75dddd6fd75b0a40a29028a40a29028a48a28a28a28a28a28a28a28a28a28a28a28a28c18004ab802b020055f8fe000a03fffffdd6ff6ff75b6ddffdff0d6ddfdb8a48809220248809220240ef000421800855802b0200abf8fe000a03fffffe39ff9ff8e79e3ffdff0d9e3fe771870061c01870061c0180ef0004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab8012080055f800230008c002d500042180085580120800abf8002480092002d50004418004ab8012080055f8002400090002d500042180085580120800abf871e41c79071ed50004418004ab8012080055f88a2f228bc8a2d500042180085580120800abf8622418890622d50004418004ab8012080055f8122404890122d500042180085580120800abf88a24228908a2d50004418004ab8012080055f871e41c79071ed5000421800855800c0200abf8cf0004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab800c020055f8cf00042180085580130900abf800230008c00230d60004418004ab8013090055f800248009200248d600042180085580130900abf800240009000240d60004418004ab8013090055f871e41c79071e40d600042180085580130900abf88a2f228bc8a2f0d60004418004ab8013090055f862241889062240d600042180085580130900abf812240489012240d60004418004ab8013090055f88a24228908a240d600042180085580130900abf871e41c79071e40d60004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab803b270055f800230008c00008c00230008c00230008c00230008c00230030000030000c03e00c01c33e70fe0006030000c00000c0fe000421800855803b3900abf80024800920000920024800920024800920024800920024804900004900124020124224a08804000004900124004120040000418004ab803a300055f800240009000009000240009000240009000240009000240041000041001040401042242080040000041001040041fd000421800855803b3900abf871e41c79071c79071e41c79071e41c79071e41c79071e41c43c88043c890f04890f2242c81cf1c8a243c890f22f1088c0000418004ab803b390055f88a2f228bc8a28bc8a2f228bc8a2f228bc8a2f228bc8a2f22f10880f108bc4088bc41cf32f224228a2f108bc42243c884000021800855803b3900abf86224188908a28908a24228908a24228908a24228908a24224108804108904088904224028a04228a24108904224108840000418004ab803b390055f81224048908a28908a24228908a24228908a24228908a24224108804108904108904224028a04228a2410890422410884000021800855803b3900abf88a242289079e8907a241e8907a241e8907a241e8907a241e4129804129904909904a24228a249e9a64129904a64909840000418004ab803b390055f871e41c79008279009e40279009e40279009e40279009e40240c68040c69031069031c41c71c30269a40c69031a3106a4000021800855802a0200abf8fd001308a2000880022000880022000880022000880022f3000022f90007240000418004ab802a020055f8fd0013071c00070001c00070001c00070001c00070001cf300001cf9000718000021800855800c0200abf8cf0004418004ab800c020055f8cf00042180085580110700abf800230008c0d40004418004ab8011070055f80024800920d400042180085580100600abf800240009d30004418004ab8010060055f871e41c79d300042180085580110700abf88a2f228bc0d40004418004ab8010060055f862241889d300042180085580100600abf812240489d30004418004ab8010060055f88a242289d300042180085580100600abf871e41c79d30004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab801d130055f80023000a08208208208208208208208208e0000421800855801d1300abf80024800a08208208208208208208208208e00004418004ab801d130055f80024000a08208208208208208208208208e0000421800855801d1300abf871e41c7bcf3cf3cf3cf3cf3cf3cf3cf3cfe00004418004ab801e140055f88a2f228a28a28a28a28a28a28a28a28a2880e1000421800855801e1400abf86224188a28a28a28a28a28a28a28a28a2880e10004418004ab801e140055f81224048a28a28a28a28a28a28a28a28a2880e1000421800855801e1400abf88a24228a28a28a28a28a28a28a28a28a2880e10004418004ab801d130055f871e41c7bcf3cf3cf3cf3cf3cf3cf3cf3cfe0000421800855800c0200abf8cf0004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab800c020055f8cf000421800855801f1500abf882082082082082082082082082082082082082e20004418004ab801f150055f882082082082082082082082082082082082082e2000421800855801f1500abf882082082082082082082082082082082082082e20004418004ab8020160055f8f3cf3cf3cf3cf3cf3cf3cf3cf3cf3cf3cf3cf3c0e300042180085580201600abf88a28a28a28a28a28a28a28a28a28a28a28a28a20e30004418004ab8020160055f88a28a28a28a28a28a28a28a28a28a28a28a28a20e300042180085580201600abf88a28a28a28a28a28a28a28a28a28a28a28a28a20e30004418004ab8020160055f88a28a28a28a28a28a28a28a28a28a28a28a28a20e300042180085580201600abf8f3cf3cf3cf3cf3cf3cf3cf3cf3cf3cf3cf3cf3c0e30004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab8020160055f88208208208208208208208208208208208208208e300042180085580201600abf88208208208208208208208208208208208208208e30004418004ab8020160055f88208208208208208208208208208208208208208e300042180085580201600abf8f3cf3cf3cf3cf3cf3cf3cf3cf3cf3cf3cf3cf3cfe30004418004ab8021170055f88a28a28a28a28a28a28a28a28a28a28a28a28a2880e400042180085580211700abf88a28a28a28a28a28a28a28a28a28a28a28a28a2880e40004418004ab8021170055f88a28a28a28a28a28a28a28a28a28a28a28a28a2880e400042180085580211700abf88a28a28a28a28a28a28a28a28a28a28a28a28a2880e40004418004ab8020160055f8f3cf3cf3cf3cf3cf3cf3cf3cf3cf3cf3cf3cf3cfe3000421800855800c0200abf8cf0004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab800c020055f8cf000421800855800e0400abf88208d10004418004ab800e040055f88208d1000421800855800e0400abf88208d10004418004ab80140a0055f8f3cf1c71c71c71c0d700042180085580140a00abf88a28a28a28a28a20d70004418004ab80140a0055f88a28a28a28a28a20d700042180085580140a00abf88a28a28a28a28a20d70004418004ab80140a0055f88a289e79e79e79e0d700042180085580140a00abf8f3cf020820820820d70004418004ab80140a0055f80000228a28a28a20d700042180085580140a00abf800001c71c71c71c0d70004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab800c020055f8cf000421800855800c0200abf8cf0004418004ab800c020055f8cf000421aaa855800c0200abf8cf000441d574ab800c020055f8cf000421afe855800c0200abf8cf0004419fe4ab800c020055f8cf0004218fc855800c0200abf8cf00044197c4ab800c020055f8cf0004218b8855800c0200abf8cf0004418784ab800c020055f8cf000421830855800c0200abf8cf0004418704ab800c020055f8cf000421820855800c0200abf5cf550441d554ab800c020055eacfaa04a1aaa85580090200ab80cc0001ab800902005580cc00015580090201ff80cc0001ff800802000080cb0000800b0100abceff04e00000ab800b010055ceff04e000005580130300abe004e0aa0080f400060100400000ab8013030055e02de0550040f4000602802000005580130300abe05ce0ff00c0f400060150400000ab8014040055e2bd7fe1ff00c0f4000602e82000005580130300abe5fce0ff00c0f4000601f5400000ab8014040055ebfd7fe1ff00c0f4000602ffa000005580130300abeffce0ff00c0f4000601ff400000ab8014040055e3fd7fe1ff00c0f4000602fc2000005580130300abe0fce0ff00c0f4000601f0400000ab8014040055e03d7fe1ff00c0f4000603c02000005580130300abe00ce0ff00c0f400060100400000ab800c020055eacfaa04a0000055800c0200abd5cf5504400000ab800902005580cc00015580080100abcb0001ab800a0000fe550095cd5500800a0000cdaa04acaaaaab800a0000fe550095cd5500800a0000cdaa04acaaaaab800a0000fe550095cd5500800a0000cdaa04acaaaaab800a0000fe550095cd5500800e0000feff00bfd1ff00fdfeff0080060001c9ff0080ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 3.2 Implementation\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 The implementation is completely straightforward. The {\f22 value-changed-callback} of the {\f22 text} widget is only used to recognize when the document is modified. It is therefore immediately turned off again when the first character is typed. The {\f22 value} of the text widget is written to and read from file in open and save operations.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 3.3 Limitations and Extensions\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 Of course, a lot of extensions is still necessary to implement a full text editor.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 3.4 Source Code\par \pard\plain \s10 \f22\fs12 ;;;-*-Mode\:LISP;Syntax\: Common-Lisp;Package\: txedit ;Base\:10-*-\par \par (in-package \:GINA)\par (defginapackage \:txedit)\par (in-package \:txedit)\par (setq *sccs-id* "@(#)text-editor.lisp\tab 1.4  1/15/92")\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class text-editor-application\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (defclass text-editor-application (application)\par   (;; overrides\par    (name          \:initform "Text-Edit"           \:allocation \:class)\par    (document-type \:initform 'text-editor-document \:allocation \:class)\par    (signature     \:initform "txedit"              \:allocation \:class)\par    (file-type     \:initform "txedit"              \:allocation \:class))\par   (\:documentation "a simple text-editor demo application"))\par \par (defun make-text-editor-application ()\par   "start the text-editor-application"\par   (make-application \:class 'text-editor-application))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class text-editor-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (defclass text-editor-document (document)\par   (;; overrides\par    (shell-width  \:initform 400)\par    (shell-height \:initform 300)))\par \par (defmethod create-windows ((doc text-editor-document))\par   "create the windows belonging to this document"\par   (with-slots (main-shell main-view) doc\par     ;; create document-shell containing a scroller and the text\par     (setq main-shell (make-document-shell doc))\par     ;; create the text-view\par     (setq main-view (make-scrolled-text main-shell))\par     ;; typing a character modifies the document\par     (setf (value-changed-callback main-view)\par \tab   (make-callback #'mark-modified doc))\par     ))\par \par (defmethod mark-modified ((doc text-editor-document) new-value)\par   "mark document as modified"\par   (declare (ignore new-value))\par   (setf (modified doc) t)\par   ;; no further value-changed-callbacks necessary\par   (setf (value-changed-callback (main-view doc)) nil))\par \par (defmethod write-to-stream ((doc text-editor-document) stream)\par   "write the document to the specified stream"\par   ;; write the current value of the text widget\par   (format stream "~s~%" (value (main-view doc))))\par \par (defmethod read-from-stream ((doc text-editor-document) stream)\par   "read the document from the specified stream"\par   ;; read and set the current value of the text widget\par   (setf (value-changed-callback (main-view doc)) nil) ;;necessary in Motif 1.1 ???\par   (setf (value (main-view doc)) (read stream))\par   (setf (value-changed-callback (main-view doc))\par \tab (make-callback #'mark-modified doc)))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; main program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (register-application "txedit" 'text-editor-application "txedit")\par '(make-text-editor-application)\par \par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 4. Clock\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 4.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 This is a simple digital clock which is updated every full second.\par \pard\plain \s7\qc\ri1\sb200\sa200\keepn \f34 {{\pict\macpict\picw121\pich57 031e0000000000390079110101000a0000000000390079980010000000000039007d000000040039007d000000000039007900000bfe000004f9000340000008060005f35500580c0302aaaaacf9aa03caaaaab8060005f35500580c0302aaaaacf9aa03caaaaab8060005f35500580c0302aaaaacf9aa03caaaaab8060005f35500580c0302affffdf9ff03dffffab808010558f5000105580c0302aaaaacf9aa03caaaaab810040559555557fdff01d595fe55016558110802aaaaacabfc3fffc7feaa03caaaaab8110f05595555570f3fffe7d5955554016558110802aaaaacaa673fffe7feaa03c8aaaab8110f0559001556673c382655941555576558110802aaaaecaa7f399324feaa03c8aaaab8110f0ff91555567f3993e1d5947555576ff8110f0002bfecaa673993e1aaaaeac8aaa008110f055955555667399324d5955555576558110f02aaaaacab0c0c38462aaaaac8aaaab810040559555557fdff06d5955555ff65580f0402aaaaacabfdfffeaa03caaaaab810040559555557fdff01d595fe550165580e0302abfffdfbff05bfffdfffeab80801055ff5ff01e558080102acf500010ab80801055cf500010558080102acf500010ab80801055cf500010558080102acf500010ab81101055cfe000523e004100208fe00010558110102acfe0005602004100518fe00010ab81101055cfe0005a0420c3088a8fe00010558110102acfe000520871451c888fe00010ab81101055cfe000521c214508888fe00010558110102acfe0005202024900888fe00010ab811010ffcfe000520203ef80888fe00010ff810010004fe0005222204108508fd0000081101055cfe0005f9c70411c23efe000105580f0102acfd000302000080fd00010ab80801055cf500010558080102acf500010ab80801055cf500010558080102acf500010ab80801055cf500010558080102acf500010ab808010558f5000105580c0302aaaaacf9aa03caaaaab8060005f35500580c0302aaaaacf9aa03caaaaab8060005f35500580c0302aaaaacf9aa03caaaaab8060005f35500580c0302aaaaacf9aa03caaaaab80c0307fffffdf9ff03dffffff806000ff3ff00f8ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 4.2 Implementation\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 In the class {\f22 clock-application} the slot {\f22 idle-timeout} is initialized to one second. As a consequence the method {\f22 idle-action} of the application is called periodically by GINA. The default version of this method does not do anything. We override the default version, so that a {\f22 tick} message is sent to each document whenever the timeout occurs. \par \pard \s2\qj\ri1\sb40\sa100 The {\f22 document-shell} used for the clock is somewhat unusual\: It does not have a menu bar and the title does not show the name of the document ("Untitled 1"). The user cannot create multiple clock documents and clocks cannot be saved into a file, because the corresponding menu entries are missing. The shell contains just one {\f22 label} widget. In the method {\f22 tick,} the {\f22 label-string} is updated to the current time.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 4.3 Source Code\par \pard\plain \s10 \f22\fs12 ;;;-*-Mode\:LISP;Syntax\: Common-Lisp; Package\:clock; Base\:10-*-\par \par (in-package \:GINA)\par (defginapackage \:clock)\par (in-package \:clock)\par (setq *sccs-id* "@(#)clock.lisp\tab 1.4  1/15/92")\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class clock-application\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (defclass clock-application (application)\par   ((name          \:initform "Clock"          \:allocation \:class)\par    (document-type \:initform 'clock-document  \:allocation \:class)\par    (signature     \:initform "clock"          \:allocation \:class)\par    (file-type     \:initform nil              \:allocation \:class)\par    (idle-timeout  \:initform 1.0              \:allocation \:class))\par   (\:documentation "a simple digital clock application"))\par \par (defun make-clock-application ()\par   "start the clock-application"\par   (make-application \:class 'clock-application))\par \par (defmethod idle-action ((clock clock-application))\par   "periodically refresh the displayed time"\par   (loop for document in (document-list clock)\par \tab do (tick document)))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class clock-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (defclass clock-document (document)\par   ())\par \par (defmethod create-windows ((doc clock-document))\par   "create the windows belonging to this document"\par   (with-slots (main-shell main-view) doc\par     (setq main-shell (make-document-shell doc \:with-menu nil))\par     (setf (title main-shell) "Clock")\par     (set-motif-resources main-shell \:icon-name "Clock")\par     (setq main-view (make-label main-shell " 00\:00\:00 "))))\par \par (defmethod tick ((doc clock-document) &aux now)\par   "one second is over => refresh the clock"\par   (with-slots (main-view) doc\par     (setq now (multiple-value-list (decode-universal-time (get-universal-time))))\par     (setf (label-string main-view)\par \tab   (format nil " ~2,'0d\:~2,'0d\:~2,'0d " (third now) (second now) (first now)))))\par     \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; main program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (register-application "clock" 'clock-application nil)\par '(make-clock-application)\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 5. Finder\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 5.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 We also have implemented a simple {\i Finder} to start applications and documents in a hierarchical file system. Its function is similar to the Macintosh Finder. The contents of a directory a shown in a scrollable selection-list. Several directories can be shown in different windows (folders) at the same time. Double-clicking a file name opens a document or starts an application. Double-clicking a subdirectory creates a new finder window. Instead of double clicking the user can first select a file and then press the {\f22 start} button.\par \pard \s2\qj\ri1\sb40\sa100 Using a push-button the user can go back to the parent directory. When the {\f22 refresh} button is pressed, the contents of the directory are read and displayed again. When the Finder is started it first shows the current directory on UNIX machines. On a Symbolics the Finder begins with the root directory.\par \pard \s2\qj\ri1\sb40\sa100 The size of a folder-window can be modified and stored on disk just like any other document.\par \pard\plain \s7\qc\ri1\sb200\sa200\keepn \f34 {{\pict\macpict\picw285\pich352 198f000000000160011d1101a00082a0008e01000a0000000002d0024098002400000000011f012000000000011f011d00000000011f011d000102dd000bfe000080e500034000002009002ae2aa03caaaaae0090315555595e255006009002ae2aa03caaaaae0090315555595e25500600c032bffffbfe5ff03dffffae0070016e0000105600c002ae5aa06ab2aaacaaab2e0110316555595fe55005ff0ff00fdf855006014002afbaa00bff0ff00fefeaa06ab2aaacaaab2e0200316555595fe5503500fff3ffeff00f9feff009ffcff01e7fdfb5503540055601c002afbaa03b3ffff3ffaff009ffcff01e7fefeaa06ab2aaac8abb2e01f0316555595fe551253c93930c93ffe49270ffc9870cca23864c30df855006024022aa002fdaa12b3c89226413f3c8912667913264c9993226666feaa06ab2a0ac8abb2e0240316455d95fe55125049932647ff8cc933e7199327cc999326663dfd55015475fe55006022002afbaa12b3c993204fffe4c93307c99327cc999026678efeaa06ab2aaac8abb2e02403164ffd95fe551253c99327cfff8cc93267199327cc9993e667c5fd550154f5fe55006022002afbaa12b3c992264f3f3c893266791326489993266466feaa06ab2aaac8abb2e01f0316555595fe551253c99930cf3ffe493313fc9870e4999866730df855006018002afbaa00bffbff00cff7ff00fefeaa06ab2aaac9ffb2e0160316555595fe55005ffcff01fccff7ff00fdf855006019002afbaa00bffcff01fe1ff7ff00fefeaa06ab2aaacaaab2e00e0316ffffbfe7ff057fffdffff56007007fe0ff01f7e0070001e05501402007002be0aa01a2e008011740e10001656008012b80e1000162e008011740e10001656008012b80e1000162e008011740e10001656008012b80e1000162e008011740e10001656008012b80e1000162e008011740e10001656010052b80000030f0fc00001ceb000162e01205174007f83030fe00027e000ceb0001656012052b8003180030fe000233000ceb000162e0150e17400318f0303c0000318f0dce71dcee00016560150e2b800340303066000031998e663338ee000162e0150e174003c03030c3000031b0cc663318ee00016560150e2b8003403030ff000031bfcc663318ee000162e0150e174003003030c0000031b00c663318ee00016560150e2b80030030306700003319ce667338ee000162e0150e174007c0fcfc3e00007e0f9dc3b9d8ee000165600c012b80f5000018ee000162e00c011740f5000018ee000165600c012b80f50000f0ee000162e008011740e10001656008012b80e1000162e008011740e10001656008012b80e1000162e008011740e10001656008012b80e1000162e008011740e10001656008012b80e1000162e00801177fe1ff01e56007002be0ff01e2e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e00d02170015ef550040f5000105600d022b002aefaa00c0f5000102e00d02170010ef0000c0f5000105600d022b0020ef0000c0f5000102e00d02170010ef0000c0f5000105600d022b0020ef0000c0f5000102e01902170010fc000006fe000030fe00000cfd0000c0f5000105601a032b0023f8fd0004060007e030fe00000cfd0000c0f5000102e019031700118cfd000306000330fd00000cfd0000c0f5000105601c152b00218cf8771e3b8fc00318f0ee3c1e9f8787771cc0f5000102e01c151700118c0c38331cc6000318307066338c0cc38318c0f5000105601c152b0021980c306198c60003183060c3618c18630318c0f5000102e01c15170011f0fc307f98c60003183060ff600c186301b0c0f5000105601c152b0021818c306018c60003183060c0600c186301b0c0f5000102e01c15170011819c303398c6600330306067318cccc300e0c0f5000105601c152b0023e0ee7e1f3de3c007e0fcfc3e1f078787e0e0c0f5000102e00e02170010f00001c0c0f5000105600e022b0020f00001c0c0f5000102e00f02170010f1000203e0c0f5000105600d022b0020ef0000c0f5000102e00d02170010ef0000c0f5000105600d022b0020ef0000c0f5000102e00d0217001fefff00c0f5000105600d022b003fefff00c0f5000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0140017fd000030fe000101c0fb000018f10001056013002bfd000030fd0000c0fb000018f1000102e0130217000efc00027000c0fb000018f1000105601a132b000381dcf1dc7c1c0ec783d73ed878ee3f0fc0f3000102e01a13170000e33830e6060719ccc6731b6ccc731818c0f30001056019122b0000331830c6060198d86c331b6d86631818f2000102e01a13170000e31830c67e0718d86c031b6dfe63180f80f3000105601a132b0003831830c6c61c18d86c031b6d80631800c0f3000102e01a1317000e033830c6ce7019ccc6333b6cce631998c0f3000105601a132b000001d8fdef77000ee783e1df6e7cf78f1f80f3000102e00b0017fe000018e4000105600b002bfe000018e4000102e00b0017fe0000f0e40001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e00b0217003fe4ff030fffe5600c022b003fe5ff04fe0fffe2e00c02170030e50004010c1045600c022b0030e50004020c2822e00c02170030e50004010c1845601f152b003ff3f3dffe007f3fc3aff1e8007afe7fbf0fcff0f80004020c3c22e01f1517003630c18cc6003198c6edb33800ce633199830db0f80004010c5c45601f152b003630c18cc6003198cc6db3180186633198c30db0f80004020cbe22e01f1517003680c18cd000319a0c0183000180633418c30180f80004010c7e45601f152b003780c0d8f07f331e0c0181f00180663c18c30180f80004020cff22e01f1517003680c0d8d0003e1a0c018018019f7c3418c30180f80004010d7f45601f152b003600c0d8c6003318cc0183180186663198c30180f80004020effa2e01f1517003600c070c6003198c661839860c6633199830180f80004010dffc5601f152b003f83f071fe0079ffc3c3c2f0607ef3ffbf0fc3c0f80004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c004560170d2b003ff7c1f1fe0071df83af7f3cf00004020c0022e0170d170036330071b600318606e66618f00004010c004560170d2b00363300d9b6003b860c66c330f00004020c0022e0170d1700368300d830003b860c078330f00004010c004560170d2b00378300d8300035860c07c1e0f00004020c0022e0170d17003683198c300035860c0660c0f00004010c004560170d2b00360319fc300031860c0660c0f00004020c0022e0170d17003603198c30183186066630c0f00004010c004560170d2b003f87fbde78187bdf83cf3bf0f00004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c00456021172b003ff1e3dffc000e9f9fc1d7c3fc7a001ebf9fefc3f3fcfa0004020c0022e0211717003633318cc6001b860c6373018cce003398cc6660c36cfa0004010c00456021172b003636198cc60031860c6633018cc6006198cc6630c36cfa0004020c0022e0211717003686198cc60030060c660301a0c0006018cd0630c060fa0004010c00456021172b003786198ccc7f30060cc60301e07c0060198f0630c060fa0004020c0022e0211717003686198cf80030060f860319a0060067df0d0630c060fa0004010c00456021172b003606198ccc0030060cc603198cc60061998c6630c060fa0004020c0022e0211717003603318cc60019860c6333198ce6183198cc6660c060fa0004010c00456021172b003f81e0f9e7000f1f9e71e7fbfcbc181fbcffefc3f0f0fa0004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045601f152b003ff1e3dffc007f3fc3aff1e8007afe7fbf0fcff0f80004020c0022e01f1517003633318cc6003198c6edb33800ce633199830db0f80004010c0045601f152b003636198cc6003198cc6db3180186633198c30db0f80004020c0022e01f1517003686198cc600319a0c0183000180633418c30180f80004010c0045601f152b003786198ccc7f331e0c0181f00180663c18c30180f80004020c0022e01f1517003686198cf8003e1a0c018018019f7c3418c30180f80004010c0045601f152b003606198ccc003318cc0183180186663198c30180f80004020c0022e01f1517003603318cc6003198c661839860c6633199830180f80004010c0045601f152b003f81e0f9e70079ffc3c3c2f0607ef3ffbf0fc3c0f80004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010d554560160c2b0033d3f39ef8003e3f9fcf80ef0004020eaaa2e0150b17003670c18c38000e18cc66ee0004010dffc560150b2b003c30c1cc6c001b18cc66ee0004020effa2e0150b17003c00c1cc6c001b18cc66ee0004010dffc560150b2b003c00c1ac6c001b198cc6ee0004020effa2e0160c17003cf8c1acc600319f0f8630ef0004010dffc560160c2b003c30c19cfe003f980c0630ef0004020effa2e0160c17003630c19cc61831980c0630ef0004010dffc560160c2b0033f3f3cdef187bfe1f0ff0ef0004020effa2e00c02170030e50004010dffc5600c022b0030e50004020effa2e00c02170030e50004010dffc5600c022b0030e50004020effa2e00c02170030e50004010dffc5600c022b0030e50004020effa2e00c02170030e50004010dffc560180e2b0033d3f39ef8007f1f9fee3be3f8f10004020effa2e0180e17003670c18c380031861b6630e18cf10004010dffc560180e2b003c30c1cc6c0031861b6771b18cf10004020c0022e0180e17003c00c1cc6c003186030771b18cf10004010c004560180e2b003c00c1ac6c003f060306b1b198f10004020c0022e0180e17003cf8c1acc60031860306b319f0f10004010c004560180e2b003c30c19cfe003186030633f980f10004020c0022e0180e17003630c19cc61831860306331980f10004010c004560180e2b0033f3f3cdef187f1f878f7fbfe0f10004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045601f152b0033d3f39ef8007f3f878f79ebfdfc003e3f9fcf80f80004020c0022e01e1417003670c18c38003198ccc633398cc6000e18cc66f70004010c0045601e142b003c30c1cc6c003198d866b3198cc6001b18cc66f70004020c0022e01e1417003c00c1cc6c003198d866b301a0c6001b18cc66f70004010c0045601e142b003c00c1ac6c7f3f199866b1f1e0cc001b198cc6f70004020c0022e01f1517003cf8c1acc600319f18677019a0f800319f0f8630f80004010c0045601f152b003c30c19cfe003199986773198ccc003f980c0630f80004020c0022e01f1517003630c19cc6003198ccc633998cc61831980c0630f80004010c0045601f152b0033f3f3cdef007f3ce78632f3fde7187bfe1f0ff0f80004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c00456021172b0033d7f1f1fcf7bf07400ff7e1f9fe3c7f000f8fe7f3e0fa0004020c0022e02117170036731870c6630c0dc006333061b66631800386331980fa0004010c00456021172b003c3318d8c6630c18c006331861b6c3318006c6331980fa0004020c0022e0211717003c0318d8c6630c18000683186030c3318006c6331980fa0004010c00456021172b003c0330d8cc7f0c180fe783186030c3330006c6633180fa0004020c0022e0211717003cfbe18cf8630c18000683186030c33e000c67c3e18cfa0004010c00456021172b003c3331fcc0630c18000633186030c333000fe603018cfa0004020c0022e0211717003633198cc0630c0cc006333060306631860c6603018cfa0004010c00456021172b0033f79fdff0f7bf07800ff7e1f8783c79c61eff87c3fcfa0004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c0045600c022b0030e50004020c0022e00c02170030e50004010c00456021172b0033d7f1f1fcf7bf074003c7bffdfcf7ff800f8fe7f3e0fa0004020c0022e02117170036731870c6630c0dc006631b6cc6636d800386331980fa0004010c00456021172b003c3318d8c6630c18c00c331b6cc6636d8006c6331980fa0004020c0022e0211717003c0318d8c6630c18000c331860c6630c0006c6331980fa0004010d55456021172b003c0330d8cc7f0c180fec331860cc630c0006c6633180fa0004020eaba2e0211717003cfbe18cf8630c18000c331860f8630c000c67c3e18cfa0004010d7f456021172b003c3331fcc0630c18000c331860c0630c000fe603018cfa0004020cff22e0211717003633198cc0630c0cc006631860c0630c060c6603018cfa0004010c7e456021172b0033f79fdff0f7bf078003c1f0f1f03e1e061eff87c3fcfa0004020cbe22e00c02170030e50004010c5c45600c022b0030e50004020c3c22e00c02170030e50004010c1845600c022b0030e50004020c3822e00c02170030e50004010c1045600b022b003ae4aa030eaaa2e00b02170035e455030d55456007002be0000102e0070017e00001056007002be0000102e0070017e0000105600b022b003fe4ff03000002e00c0217003fe5ff04fe000005600e032b003004e755055001000002e00e031700300ae7aa05ca02000005600f042b0030567fe8ff05d501000002e00f04170030bebfe8ff05cea2000005600f042b00357e7fe8ff05d7d1000002e00f0417003bfebfe8ff05cffe000005600f042b0037fe7fe8ff05d7f9000002e0980024011f000001600120011f00000160011d011f00000160011d00010f04170031febfe8ff05cfe2000005600f042b00307e7fe8ff05d781000002e00f041700301ebfe8ff05ce02000005600f042b0030067fe8ff05d801000002e00b0217003ae4aa03000005600b022b0035e45503000002e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056015022b0002f9aa00a0fc000001f7550054fc000102e01302170005f9550050fc000002f6aafc0001056015022b0002f9000030fc000001f7000006fc000102e01502170004f9000030fc000002f7000006fc0001056015022b0002f9000030fc000001f7000006fc000102e01502170004f9000030fc000002f7000006fc0001056020052b0002000006fe0002c00030fc000001fd000078fe0002700006fc000102e02105170004000f46fe0002c00030fc000502001fc000c0fe0002300006fc0001056021052b00020019c6fe0002c00030fc000501000c6000c0fe0002300006fc000102e0210b1700040018cfc7c3b9f80030fc000b02000c63c1f1dc783f370006fc00010560210b2b00020018060061c0c00030fc000b01000c6660c0e0cc63398006fc000102e0210b170004000f86006180c00030fc000b02000ccc30c0c18660318006fc00010560210b2b00020000c607e180c00030fc000b01000f8ff0c0c1fe3e318006fc000102e0210b1700040018c60c6180c00030fc000b02000ccc00c0c18003318006fc00010560210b2b0002001cc66ce180cc0030fc000b01000c6670c0c0ce63318006fc000102e0210b170004001783c773f0780030fc000b02001e73e1f1f87c7e7bc006fc0001056015022b0002f9000030fc000001f7000006fc000102e01502170004f9000030fc000002f7000006fc0001056015027f0002f9000030fc000001f7000006fc000107e01402010004f9000030fc000002f7000006fb00002015022b0002f9000030fc000001f7000006fc000102e01502170004f9000030fc000002f7000006fc0001056015022b0003f9ff00f0fc000001f7ff00fefc000102e01502170007f9ff00f0fc000003f7ff00fefc0001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070017e00001056007002be0000102e0070016e00001056009002ae2aa03caaaaae0090315555595e255006009002ae2aa03caaaaae0090315555595e25500600c033fffffbfe5ff03dfffffe006007fdfff00e002dd0002dd00a0008fa00083ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 \page 5.2 Implementation\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 A subclass of {\f22 application} is defined as usual. The function {\f22 AC} (Assisting-Computer) is introduced as a synonym for {\f22 make-finder} for GMD purposes.\par \pard \s2\qj\ri1\sb40\sa100 The class {\f22 finder-document} contains slots for pathnames deduced from the slot {\f22 file-pathname} of the superclass. There is an after-demon for the method {\f22 initialize-instance}, because the {\f22 name} of a {\f22 finder-document} shown as the window title shall be the directory portion of the pathname.\par \pard \s2\qj\ri1\sb40\sa100 The shell for the Finder was constructed using the Interface Builder. The code generated by the Interface Builder is contained in the file {\f22 finder-shell.lisp}. The file contains the definition of class {\f22 finder-shell}, a subclass of {\f22 document-shell}, and the corresponding constructor function. The class has slots for the widgets which are generated in the constructor function. In the method {\f22 create-windows} we call the constructor function {\f22 make-finder-shell} which creates a form widget containing a scrollable selection-list and some buttons. The callbacks for the buttons have to be explicitly set afterwards. Finally, some superfluous menu entries are removed. The {\f22 Save} entry is replaced by {\f22 Save Window Size} because only the size is stored on disk.\par \pard \s2\qj\ri1\sb40\sa100 The Finder is somewhat unusual in that the documents correspond to directories rather than normal files. Therefore, the method {\f22 read-from-file} is overridden whereas in other applications the method {\f22 read-from-stream} is overridden. The default version of {\f22 read-from-file} opens the file, reads the header, calls {\f22 create-windows} and then {\f22 read-from-stream}. The Finder version of {\f22 read-from-file}, however, reads the header from the file {\f22 finderinfo.text} placed in the directory, calls {\f22 create-windows} and then determines the list of files of the directory. This list is shown in the scrollable selection-list. Analogously, the method {\f22 write-to-file} is overridden to write the header to the finderinfo file.\par \pard \s2\qj\ri1\sb40\sa100 To start the selected file we simply have to call the GINA function {\f22 start-file}. If the selected file is a subdirectory, the value stored in the selection-list and passed to {\f22 start-file }is a wildcard. It is always the application with the signature {\f22 "finder"} which is responsible for handling wildcard pathnames. So if you want to implement another Finder it must replace this Finder and use the same signature.\par \pard \s2\qj\ri1\sb40\sa100 To refresh the file list we simply list the files contained in the directory and call {\f22 set-item-list} for the scrollable selection-list. Subdirectories are placed at the beginning of the list.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 5.3 Limitations and Extensions\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 As a simple extension, it is possible to periodically check if the directory was modified and refresh the file list if necessary. Facilities for moving and copying files could also be added.\par \pard \s2\qj\ri1\sb40\sa100 \par \par \par \par \par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 5.4 Source Code\par \pard\plain \s10 \f22\fs12 ;;; -*- Mode\:LISP;Syntax\: Common-Lisp;Package\: GINA ;Base\:10-*-\par \par (in-package \:GINA)\par (setq *sccs-id* "@(#)finder.lisp\tab 1.4  1/15/92")\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class finder\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (defclass finder (application)\par   (;; overrides\par    (name          \:initform "Finder"          \:allocation \:class)\par    (document-type \:initform 'finder-document  \:allocation \:class)\par    (signature     \:initform "finder"          \:allocation \:class)\par    (file-type     \:initform "directory"       \:allocation \:class)\par    ;;(idle-timeout  \:initform 10                \:allocation \:class)\par    )\par   (\:documentation "a simple menu oriented finder"))\par \par (eval-when (eval load)\par   (export 'make-finder))\par \par (defun make-finder (&key (display-host *default-display-host*)\par \tab \tab          (toolkit-host *default-toolkit-host*)\par \tab \tab \tab  (document-pathname (current-directory-wildcard)))\par   "start the finder application"\par   (make-application \:display-host display-host\par \tab \tab     \:toolkit-host toolkit-host\par \tab \tab     \:document-pathname document-pathname\par \tab \tab     \:class 'finder))\par \par (eval-when (eval load)\par   (export 'ac))\par \par (defun AC (&optional (display-host *default-display-host*)\par \tab              (toolkit-host *default-toolkit-host*))\par   "just a synonym for the finder"\par   (make-finder \:display-host display-host\par \tab        \:toolkit-host toolkit-host))\par \par ;; impossible to find out if a directory has changed on Symbolics!!!\par ;(defmethod idle-action ((finder finder))\par ;  "periodically refresh the folders"\par ;  (loop for folder in (document-list finder)\par ;\tab do (refresh-file-list folder)))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class finder-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass finder-document (document)\par   (;; related pathnames\par    ;; the slot file-pathname holds a wildcard like e.g. "w1\:>gina>documents>*.*.newest\par    (finderinfo       \:accessor finderinfo) ;; e.g."w1\:>gina>documents>finderinfo.text"\par    (parent-directory \:accessor parent-dir \:initform nil) ;; e.g. "w1\:>gina.directory"\par    ;; overrides\par    (shell-width  \:initform 250)\par    (shell-height \:initform 300))\par   (\:documentation "the internal representaion of a folder"))\par \par (defmethod initialize-instance \:after ((doc finder-document) &rest initargs)\par   "some special inits"\par   (declare (ignore initargs))\par   ;;the name of a finder document is constructed in a different way\par   (setf (name doc) (directory-namestring (file-pathname doc))))\par \par (defmethod create-windows ((doc finder-document))\par   "create a window containig a scrollable list of files and some buttons"\par   (with-slots (main-shell parent-directory) doc\par     ;; create finder-shell containing the various widgets as slots\par     (setq main-shell (make-finder-shell doc))\par \par     ;; set callback of parent button\par     (setf (activate-callback (parent-button main-shell))\par \tab   (make-callback #'start-file parent-directory))\par     (set-motif-resources (parent-button main-shell)\par \tab \tab \tab  \:sensitive (when parent-directory t))\par \par     ;; set the callback of the start-button\par     (setf (default-action-button (file-list main-shell)) (start-button main-shell))\par     (setf (activate-callback (start-button main-shell))\par \tab   (make-callback #'start-selected-file doc))\par \par     ;; set the callback of the refresh-button\par     (setf (activate-callback (refresh-button main-shell))\par \tab   (make-callback #'refresh-file-list doc))\par \par     ;; remove or modify some main menu entries\par     (remove-menu-entry (main-menu main-shell) "File" "New")\par     (remove-menu-entry (main-menu main-shell) "File" "Open..")\par     (remove-menu-entry (main-menu main-shell) "File" "Minifinder")\par \par     ;; saving a documnet means storing its size\par     (setf (label-string (save-menu-entry doc)) "Save Window Size")\par     (setf (sensitive    (save-menu-entry doc)) t)\par     \par     (remove-menu-entry (main-menu main-shell) "File" "Save as..")\par     (remove-menu-entry (main-menu main-shell) "File" "Revert")\par \par     (remove-menu-entry (main-menu main-shell) "Edit" "Undo")\par     (remove-menu-entry (main-menu main-shell) "Edit" "Redo")\par     (remove-menu-entry (main-menu main-shell) "Edit" "Replay History")\par     (remove-menu-entry (main-menu main-shell) "Edit" "History Scroller")\par     \par     ))\par \par \par \par \par \par \par (defmethod read-from-file ((doc finder-document) wildcard-pathname &key (create-windows t))\par   "list the directory instead of normally reading the file"\par   (declare (ignore create-windows))\par   ;; the parameter is a wildcard rather than a specific file !!\par   ;; wildcard-pathname is of the form "w1\:>gina>documents>*.*.newest"\par   (with-slots (finderinfo parent-directory main-shell) doc\par \par     ;; something like "w1\:>gina>documents>finderinfo.text"\par     (setq finderinfo (make-pathname \:name "finderinfo" \:type "text"\par \tab \tab \tab \tab     \:defaults wildcard-pathname))\par \par     ;; something like "w1\:>gina.directory"\par     (when (not (root-directory-p wildcard-pathname))\par       (setq parent-directory (parent-directory-wildcard wildcard-pathname)))\par \par     ;; read the finderinfo file placed in the directory if any\par     (when (probe-file finderinfo)\par       (with-open-file (stream finderinfo \:direction \:input)\par \tab (read-header-from-stream doc stream)))\par \par     ;; now that we know the size, we can create the windows\par     (create-windows doc)\par \par     ;; show the wildcard in the label\par     (setf (label-string (directory-label main-shell))\par \tab   (directory-namestring wildcard-pathname))\par \par     ;; make a view containing the filenames and put it into the scroller\par     (refresh-file-list doc)))\par \par (defmethod write-to-file ((doc finder-document) pathname)\par   "write the finderinfo to the directory"\par   (declare (ignore pathname))\par   (with-open-file (stream (finderinfo doc) \:direction \:output \:if-exists \:new-version)\par     (write-header-to-stream doc stream)))\par \par (defmethod start-selected-file ((doc finder-document))\par   "start the file which has been selected in the file-list"\par   (with-clock-cursor\par     (start-file (value (file-list (main-shell doc))) \:from-document doc)))\par \par (defmethod refresh-file-list ((doc finder-document) &aux files items)\par   "read the directory again and build a new file-list"\par   (with-slots (file-pathname main-shell) doc\par     (with-clock-cursor\par       ;; make an item-list of the filenames and put it into the scroller\par       (setq files (sort (directory file-pathname) #'pathname-name<))\par       (setq items\par \tab     (append\par \tab       (loop for file in files\par \tab \tab     when (directoryp file)\par \tab \tab       collect (list (concatenate 'string "-> " (pathname-name file))\par \tab \tab \tab \tab     (subdirectory-wildcard file)))\par \tab       (loop for file in files\par \tab \tab     when (not (directoryp file))\par \tab \tab       collect (list (name-and-type file) file))))\par \par       ;; change the item list\par       (set-item-list (file-list main-shell) items)\par       )))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; main program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (register-application "finder" 'finder "directory")\par '(make-finder)\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 Code generated by Interface Builder\:\par \pard\plain \s10 \f22\fs12 ;;;-*-Mode\:LISP; Syntax\: Common-Lisp;Package\:gina;-*-\par \par ;; !!! Do not edit !!!\par ;; This code was generated by the GINA Interface Builder.\par \par (in-package \:gina)\par \par (defclass finder-shell\par           (document-shell)\par           ((form \:accessor form) (parent-button \:accessor parent-button)\par            (directory-label \:accessor directory-label)\par            (file-list \:accessor file-list) (button-row \:accessor button-row)\par            (start-button \:accessor start-button)\par            (refresh-button \:accessor refresh-button))\par           (\:documentation ""))\par (defun make-finder-shell (doc &key (initargs nil) (motif-resources nil)\par                           (class 'finder-shell) &aux box)\par   (setq box\par         (make-document-shell\par           doc\par           \:class\par           class\par           \:initargs\par           initargs\par           \:motif-resources\par           motif-resources))\par   (setf (form box) (make-form box \:name "form"))\par   (setf (parent-button box)\par         (make-push-button (form box) "Parent Directory" \:name "parent-button"))\par   (setf (directory-label box)\par         (make-label (form box) "/home/spenke" \:name "directory-label"))\par   (setf (file-list box)\par         (make-scrollable-selection-list\par           (form box)\par           '("file1" "file2" "file3")\par           \:name\par           "file-list"))\par   (setf (button-row box)\par         (make-row-column\par           (form box)\par           \:name\par           "button-row"\par           \:orientation\par           \:horizontal\par           \:spacing\par           50))\par   (setf (start-button box)\par         (make-push-button\par           (button-row box)\par           " Open "\par           \:name\par           "start-button"\par           \:recompute-size\par           nil))\par   (setf (refresh-button box)\par         (make-push-button\par           (button-row box)\par           " Refresh "\par           \:name\par           "refresh-button"\par           \:recompute-size\par           nil))\par   (define-form-constraint\par     (parent-button box)\par     \:top-attachment\par     \:form\par     \:top-offset\par     10\par     \:left-attachment\par     \:form\par     \:left-offset\par     10\par     \:right-attachment\par     \:none\par     \:bottom-attachment\par     \:none)\par   (define-form-constraint\par     (directory-label box)\par     \:top-attachment\par     \:widget\par     \:top-widget\par     (parent-button box)\par     \:top-offset\par     10\par     \:left-attachment\par     \:form\par     \:left-offset\par     10\par     \:right-attachment\par     \:none\par     \:bottom-attachment\par     \:none)\par   (define-form-constraint\par     (file-list box)\par     \:top-attachment\par     \:widget\par     \:top-widget\par     (directory-label box)\par     \:top-offset\par     10\par     \:left-attachment\par     \:form\par     \:left-offset\par     10\par     \:right-attachment\par     \:form\par     \:right-offset\par     10\par     \:bottom-attachment\par     \:widget\par     \:bottom-widget\par     (button-row box)\par     \:bottom-offset\par     10)\par   (define-form-constraint\par     (button-row box)\par     \:top-attachment\par     \:none\par     \:left-attachment\par     \:form\par     \:left-offset\par     10\par     \:right-attachment\par     \:none\par     \:bottom-attachment\par     \:form\par     \:bottom-offset\par     9)\par   box)\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 6. Graphic-Editor\par \pard\plain \s7\qc\ri1\sb200\sa200\keepn \f34 {{\pict\macpict\picw419\pich534 34a900000000021601a31101a00082a0008e01000a0000000002d002409800360000000000c301a80000000000c301a30000000000c301a3000102cb000dfe000040d5000001fe00018000070015ce550180000e030aaaaacad5aa05ab2aaaab8000070015ce550180000e030aaaaacad5aa05ab2aaaab80000d0315ffffdfd4ff047ffff5800008000bcf00020b8000070015ce5501800018030b2aaacaf6aa00afefff00eaf6aa07acaaab2aaacb80000f0015f3550057efff00f5f05501800027030b2aaacaf6aa13af07ffffcf9fff03e4cfffffe73fe6667ff9fceaf6aa07acaaab2002cb80001e0015f355135673ffffcfffff3fe7cfffffe73fe7e67ff9f0f5f05501800027030b2aaacaf6aa13acfe4864c9987f3f24861927e724c24261c9fceaf6aa07acaaab22aecb80002402155001f5551354fe032244933f3e44ccc827e72266664c91fcf5f5550050fd5501800027030b22aecaf6aa13acc23f264c93ff0264ccc8ffe72666664c99fceaf6aa07acaaab22aecb8000230015f3551354f278264c93ff3e64ccc9ffe72666664099fcf5f5550151d5fe5501800027030b27fecaf6aa13acf273264c93ff3e64ccc9ffe72666664f99fceaf6aa07acabab22aecb80001e0015f35513567273224c933f3e44c8c9e7f26664644c91fcf5f05501800027030b2aaacaf6aa13af0a7884cc987f0324e619e7f066727261c9fceaf6aa07acaaab22aecb8000150015f3550357ffffe7f2ff00f5f3550457fd5580001b030b2aaacaf6aa03afffffe7f2ff00eaf6aa07acaaab2aaacb8000120015f3550357ffffe7f2ff00f5f05501800010030b7fffdfd7ff07fdffff7fffcb800008003fcfff02df8000080000cfaa02808000090115d5d055029580000a010ba0d10003018b80000a0115c0d10003019580000a010ba0d10003018b80000a0115c0d10003019580000a010ba0d10003018b80000a0115c0d10003019580000a010ba0d10003018b80000a0115c0d10003019580000a010ba0d10003018b8000180515c000001878fc0002e0c180fd0000e0e200030195800020050ba003fc1818fe00093fc060c1800003f00060fd00011f80e80003018b8000200515c0018c0018fe000918c06001800001980060fd00010cc0e8000301958000241b0ba0018c78181e000018c763c3f000018c786e738ee0000c6773e70eeb0003018b8000241b15c001a018183300001a0ce0c18000018ccc733199c0000c6380336ceb000301958000241b0ba001e018186180001e0c60c18000018d86633198c0000c6300336ceb0003018b8000241b15c001a018187f80001a0c60c18000018dfe633198c0000c6303f36ceb000301958000241b0ba00180181860000018cc60c18000018d80633198c0000c630631f8eb0003018b8000241b15c00180181833800018cce0c198000198ce733399c0000cc3067198eb000301958000241b0ba003e07e7e1f00003fc773f0f00003f07cee1dcec0001f87e3b998eb0003018b80000e0115c0ee0000c0e50003019580000e010ba0ee0000c0e50003018b80000f0115c0ef00010780e50003019580000a010ba0d10003018b80000a0115c0d10003019580000a010ba0d10003018b80000a0115c0d10003019580000a010ba0d10003018b80000a0115c0d10003019580000a010ba0d10003018b80000a0115c0d100030195800009010bbfd0ff028b8000080015cfff0295800010010b80fb00007fdaff05fc3fff8b800010011580fb00007fdaff05fc3fff95800010010b80fb000060da00050830410b80001101158ffcff01fc60da00050430a095800011010b8afcaa01a860da00050830610b80001101158cfc00010c60da00050430f095800011010b88fc00010860da00050831710b80001101158cfc00010c60da00050432f895800012020b887ffdff018860da00050831f90b80001202158c7ffdff010c60da00050433fc95800013020b887ffeff02fe8860da00050835fd0b80001302158c70fe0002010c60da0005043bfe95800013020b8870fe0002028860da00050837ff0b80001302158c70fe0002010c60da000504300095800013020b8870fe0002028860da00050835550b80001302158c70fe0002010c60da0005043aaa95800013020b8870fe0002028860da00050837ff0b80001308158c70000100010c60da0005043bfe95800013080b8870000700028860da00050837ff0b80001308158c70001f00010c60da0005043bfe95800013080b8870007f00028860da00050837ff0b80001308158c7001ff00010c60da0005043bfe95800013080b887000ff80028860da00050837ff0b80001308158c70003f80010c60da0005043bfe95800013080b8870001f80028860da00050837ff0b80001308158c70001380010c60da0005043bfe95800013080b8870003080028860da00050837ff0b80001308158c70002000010c60da0005043bfe95800013080b8870006000028860da00050837ff0b80001308158c70004000010c60da0005043bfe95800013080b887000c000028860da00050837ff0b80001308158c70018000010c60da0005043bfe95800013080b8870010000028860da00050837ff0b80001308158c70030000010c60da0005043bfe95800013080b8870020000028860da00050837ff0b80001308158c70060000010c60da0005043bfe95800013080b8870040000028860da00050837ff0b80001308158c700c0000010c60da0005043bfe95800013080b8870080000028860da00050837ff0b80001308158c70180000010c60da0005043bfe95800013020b8870fe0002028860da00050837ff0b80001302158c70fe0002010c60da0005043bfe95800013020b8870fe0002028860da00050837ff0b80001302158c70fe0002010c60da0005043bfe95800013020b8870fe0002028860da00050837ff0b80001202158c75fd55010c60da0005043bfe95800012020b886afdaa018860da00050837ff0b80001101158cfc55010c60da0005043bfe95800011010b88fc00010860da00050837ff0b80001202158c2afdaa018c60da0005043bfe95800011010b88fc55018860da00050837ff0b80001302158c2afeaa02ab8c60da0005043bfe95800013020b8850fe0002038860da00050837ff0b80001302158c20fe0002038c60da0005043bfe95800013020b8850fe0002038860da00050837ff0b80001302158c20fe0002038c60da0005043bfe9580001a020b8850fe0005038860000003f8ff00fee700050837ff0b80001b02158c20fe0006038c60000003e0f900003ee70005043bfe9580001b0c0b88503fffff038860000003e0f900003ee700050837ff0b80001b0c158c203fffff038c60000003e0f900003ee70005043bfe9580001b0c0b8850300003038860000003e0f900003ee700050837ff0b80001a0b158c20300003038c60000002f8000002e70005043bfe9580001a0b0b8850300003038860000002f8000002e700050837ff0b80001a0b158c20300003038c60000002f8000002e70005043bfe9580001a0b0b8850300003038860000002f8000002e700050837ff0b80001a0b158c20300003038c60000002f8000002e70005043bfe9580001a0b0b8850300003038860000002f8000002e700050837ff0b80001a0b158c20300003038c60000002f8000002e70005043bfe9580001a0b0b8850300003038860000002f8000002e700050837ff0b80001a0b158c20300003038c60000002f8000002e70005043bfe9580001a0b0b8850300003038860000002f8000002e700050837ff0b80001a0b158c20300003038c60000002f8000002e70005043bfe958000210b0b8850300003038860000002f8000002f600033fffff80f600050837ff0b8000230b158c20300003038c60000002f8000002f700057fc000007fc0f70005043bfe958000230b0b8850300003038860000002f8000002f800011f80fd00003ff700050837ff0b8000230b158c20300003038c60000002f8000002f9000101e0fb0000f0f80005043bfe958000220b0b8850300003038860000002f8000002f900001efa00000ff800050837ff0b8000220b158c20300003038c60000002f8000002f90000e0f90000e0f90005043bfe958000220b0b88503fffff038860000002f8000002fa000007f800001cf900050837ff0b8000230b158c203fffff038c60000002f8000002fa000038f800010380fa0005043bfe95800023020b8850fe0005038860000002f8000002fb000101c0f7000070fa00050837ff0b80002202158c20fe0005038c60000002f8000002fb000006f600000cfa0005043bfe95800022020b8850fe0005038860000002f8000002fb000018f6000003fa00050837ff0b80002202158c20fe0005038c60000002f8000002fb000060f50000c0fb0005043bfe95800022020b8850fe0005038860000002f8000002fb000080f5000020fb00050837ff0b80002202158c20fe0005038c60000002f8000002fc000003f4000018fb0005043bfe95800021020b885ffdff048860000002f8000002fc00000cf4000006fb00050837ff0b80002102158c3ffdff048c60000002f8000002fc000010f4000001fb0005043bfe95800021020b887ffdff048860000002f8000002fc000020f3000080fc00050837ff0b80002001158cfc00040c60000002f8000002fc000040f3000040fc0005043bfe95800022020b882afdaa048860000002f8000002fd00010180f3000030fc00050837ff0b80002001158cfc55048c60000002f8000002fd000002f2000008fc0005043bfe95800022020b882afeaa05ab8860000002f8000002fd000004f2000004fc00050837ff0b80002202158c50fe0005038c60000002f8000002fd000004f2000004fc0005043bfe95800022020b8820fe0005038860000002f8000002fd000008f2000002fc00050837ff0b80002202158c50fe0005038c60000002f8000002fd000010f2000001fc0005043bfe95800022020b8820fe0005038860000002f8000002fd000020f1000080fd00050837ff0b80002202158c50fe0005038c60000002f8000002fd000020f1000080fd0005043bfe95800022020b8820fe0005038860000002f8000002fd000040f1000040fd00050837ff0b8000220b158c50007f00038c60000002f8000002fd000040f1000040fd0005043bfe958000220b0b882001ffc0038860000002f8000002fd000080f1000020fd00050837ff0b8000220b158c500380e0038c60000002f8000002fd000080f1000020fd0005043bfe958000220b0b8820060030038860000002f8000002fd000080f1000020fd00050837ff0b8000220b158c500c0018038c60000002f8000002fe000001f0000010fd0005043bfe958000220b0b882018000c038860000002f8000002fe000001f0000010fd00050837ff0b8000220b158c5018000c038c60000002f8000002fe000001f0000010fd0005043bfe958000220b0b8820300006038860000002f8000002fe000001f0000010fd00050837ff0b8000220b158c50300006038c60000002f8000002fe000001f0000010fd0005043bfe958000220b0b8820300006038860000002f8000002fe000001f0000010fd00050837ff0b8000220b158c50300006038c60000002f8000002fe000001f0000010fd0005043bfe958000220b0b8820300006038860000002f8000002fe000001f0000010fd00050837ff0b8000220b158c50300006038c60000002f8000002fd000080f1000020fd0005043bfe958000220b0b8820300006038860000002f8000002fd000080f1000020fd00050837ff0b8000220b158c5018000c038c60000002f8000002fd000080f1000020fd0005043bfe958000220b0b882018000c038860000002f8000002fd000040f1000040fd00050837ff0b8000220b158c500c0018038c60000002f8000002fd000040f1000040fd0005043bfe958000220b0b8820060030038860000002f8000002fd000020f1000080fd00050837ff0b8000220b158c500380e0038c60000002f8000002fd000020f1000080fd0005043bfe958000220b0b882001ffc0038860000002f8000002fd000010f2000001fc00050837ff0b8000220b158c50007f00038c60000002f8000002fd000008f2000002fc0005043bfe95800022020b8820fe0005038860000002f8000002fd000004f2000004fc00050837ff0b80002202158c50fe0005038c60000002f8000002fd000004f2000004fc0005043bfe95800022020b8820fe0005038860000002f8000002fd000002f2000008fc00050837ff0b80002302158c50fe0005038c60000002f8000002fd00010180f3000030fc0005043bfe95800022020b8820fe0005038860000002f8000002fc000040f3000040fc00050837ff0b80002202158c50fe0005038c60000002f8000002fc000020f3000080fc0005043bfe95800022020b8820fe0005038860000002f8000002fc000010f4000001fb00050837ff0b80002102158c5ffdff048c60000002f8000002fc00000cf4000006fb0005043bfe95800021020b883ffdff048860000002f8000002fc000003f4000018fb00050837ff0b80002102158c7ffdff048c60000002f8000002fb000080f5000020fb0005043bfe95800020010b88fc00040860000002f8000002fb000060f50000c0fb00050837ff0b80002102158c2afdaa048c60000002f8000002fb000018f6000003fa0005043bfe95800021010b88fc55058860000003e0f900003efb000006f600000cfa00050837ff0b80002402158c2afeaa06ab8c60000003e0f900003efb000101c0f7000070fa0005043bfe95800024020b8850fe0006038860000003e0f900003efa000038f800010380fa00050837ff0b80002302158c20fe0006038c60000003e0f900003efa000007f800001cf90005043bfe95800098003600c30000018601a800c30000018601a300c30000018601a3000122020b8850fe0005038860000003f8ff00fef90000e0f90000e0f900050837ff0b80001b02158c20fe0002038c60ec00001efa00000ff80005043bfe9580001c020b8850fe0002038860ec000101e0fb0000f0f800050837ff0b80001c02158c20fe0002038c60eb00011f80fd00003ff70005043bfe9580001c080b8850000001838860ea00057fc000007fc0f700050837ff0b80001a08158c20000003038c60e900033fffff80f60005043bfe95800013080b8850000006038860da00050837ff0b80001308158c2000000c038c60da0005043bfe95800013080b8850000018038860da00050837ff0b80001308158c20000030038c60da0005043bfe95800013080b8850000060038860da00050837ff0b80001308158c200000c0038c60da0005043bfe95800013080b8850000180038860da00050837ff0b80001308158c20000300038c60da0005043bfe95800013080b8850000600038860da00050837ff0b80001308158c20000c00038c60da0005043bfe95800013080b8850001800038860da00050837ff0b80001308158c20003000038c60da0005043bfe95800013080b8850006000038860da00050837ff0b80001308158c2000c000038c60da0005043bfe95800013080b8850018000038860da00050837ff0b80001308158c20030000038c60da0005043bfe95800013080b8850060000038860da00050837ff0b80001308158c200c0000038c60da0005043bfe95800013080b8850180000038860da00050837ff0b80001308158c20300000038c60da0005043bfe95800013020b8850fe0002038860da00050837ff0b80001302158c20fe0002038c60da0005043bfe95800013020b8850fe0002038860da00050837ff0b80001302158c20fe0002038c60da0005043bfe95800013020b8850fe0002038860da00050837ff0b80001302158c20fe0002038c60da0005043bfe95800012020b885ffdff018860da00050837ff0b80001202158c3ffdff018c60da0005043bfe95800012020b887ffdff018860da00050837ff0b80001101158cfc00010c60da0005043bfe95800012020b882afdaa018860da00050837ff0b80001101158cfc55018c60da0005043bfe95800013020b882afeaa02ab8860da00050837ff0b80001302158c50fe0002038c60da0005043bfe95800013020b8820fe0002038860da00050837ff0b80001302158c50fe0002038c60da0005043bfe95800013020b8820fe0002038860da00050837ff0b80001302158c50fe0002038c60da0005043bfe95800013020b8820fe0002038860da00050837ff0b80001302158c50fe0002038c60da0005043bfe95800013080b8820000600038860da00050837ff0b80001308158c50000f00038c60da0005043bfe95800013080b8820000b00038860da00050837ff0b80001308158c50001980038c60da0005043bfe95800013080b8820001180038860da00050837ff0b80001308158c500030c0038c60da0005043bfe95800013080b88200020c0038860da00050837ff0b80001308158c50006060038c60da0005043bfe95800013080b8820004060038860da00050837ff0b80001308158c5000c030038c60da0005043bfe95800013080b8820018030038860da00050837ff0b80001308158c50010018038c60da0005043bfe95800013080b8820030018038860da00050837ff0b80001308158c5002000c038c60da0005043bfe95800013080b882006000c038860da00050837ff0b80001308158c50040006038c60da0005043bfe95800013080b88200c0006038860da00050837ff0b80001308158c50080003038c60da0005043ffe95800013080b8820180003038860da00050830010b80001308158c501fffff838c60da000504300095800013080b88203fffff838860da00050830010b80001302158c50fe0002038c60da00050430009580001f020b8820fe0002038860e700080f800000fe000003e0fd00050830010b80001f02158c50fe0002038c60e700080f80000301800003e0fd00050430009580001f020b8820fe0002038860e700080f80000c00600003e0fd00050830010b80001f02158c50fe0002038c60e700080f80003000180003e0fd00050430009580001f020b8820fe0002038860e700080f80004000040003e0fd00050830010b80001802158c5ffdff018c60e40002800002fa000504300095800020020b883ffdff04886000000ff1ff00f8f9000301000001fa00050830010b80002102158c7ffdff048c60000008f1000008f9000002fe000080fb000504300095800020010b88fc00040860000008f1000008f9000002fe000080fb00050830010b80002102158c2afdaa048c60000008f1000008f9000004fe000040fb000504300095800020010b88fc55048860000008f1000008f9000008fe000020fb00050830010b80002202158c2afeaa05ab8c60000008f1000008f9000010fe000010fb000504300095800022020b8850fe0005038860000008f1000008f9000010fe000010fb00050830010b80002202158c20fe0005038c60000008f1000008f9000020fe000008fb000504300095800022020b8850fe0005038860000008f1000008f9000020fe000008fb00050830010b80002202158c20fe0005038c60000008f1000008f9000040fe000004fb000504300095800022020b8850fe0005038860000008f1000008f9000080fe000002fb00050830010b80002202158c20fe0005038c60000008f1000008f9000080fe000002fb0005043000958000220b0b8850000400038860000008f1000008fa000001fd000001fb00050830010b8000220b158c20000400038c60000008f1000008fa000001fd000001fb0005043000958000220b0b8850000e00038860000008f1000008fa000001fd000001fb00050830010b8000220b158c20000e00038c60000008f1000008fa000002fc000080fc0005043000958000220b0b8850001e00038860000008f1000008fa000002fc000080fc00050830010b8000220b158c20001f00038c60000008f1000008fa000004fc000040fc0005043000958000220b0b8850003300038860000008f1000008fa000004fc000040fc00050830010b8000220b158c20003300038c60000008f1000008fa000004fc000040fc0005043000958000220b0b8850006300038860000008f1000008fa000008fc000020fc00050830010b8000220b158c20006180038c60000008f1000008fa000008fc000020fc0005043000958000220b0b885000c180038860000008f1000008fa000010fc000010fc00050830010b8000220b158c2000c180038c60000008f1000008fa000010fc000010fc0005043000958000220b0b8850018180038860000008f1000008fa000010fc000010fc00050830010b8000220b158c2001ffc0038c60000008f1000008fa000010fc000010fc0005043000958000220b0b885003ffc0038860000008f1000008fa000020fc000008fc00050830010b8000220b158c200300c0038c60000008f1000008fa000020fc000008fc0005043000958000220b0b88500600c0038860000008f1000008fa000020fc000008fc00050830010b8000220b158c20060060038c60000008f1000008fa000040fc000004fc0005043000958000220b0b88500c0060038860000008f1000008fa000040fc000004fc00050830010b8000220b158c200c0074038c60000008f1000008fa000040fc000004fc0005043000958000220b0b8850180038038860000008f1000008fa000040fc000004fc00050830010b80002202158c20fe0005038c60000008f1000008fa000080fc000002fc000504300095800022020b8850fe0005038860000008f1000008fa000080fc000002fc00050830010b80002202158c20fe0005038c60000008f1000008fa000080fc000002fc000504300095800022020b8850fe0005038860000008f1000008fa000080fc000002fc00050830010b80002202158c20fe0005038c60000008f1000008fa000080fc000002fc000504300095800022020b8850fe0005038860000008f1000008fb000001fb000001fc00050830010b80002202158c20fe0005038c60000008f1000008fb000001fb000001fc000504300095800021020b885ffdff048860000008f1000008fb000001fb000001fc00050830010b80002102158c3ffdff048c60000008f1000008fb000001fb000001fc000504300095800021020b887ffdff048860000008f1000008fb000001fb000001fc00050830010b80002001158cfc00040c60000008f1000008fb000002fa000080fd000504300095800020010b88fc00040860000008f1000008fb000002fa000080fd00050830010b80002001158cfc00040c60000008f1000008fb000002fa000080fd000504300095800020010b8ffcff04f860000008f1000008fb000002fa000080fd00050830010b800020011585fc55045460000008f1000008fb000002fa000080fd00050430009580001f010b80fb000360000008f1000008fb000002fa000080fd00050830010b80001f011580fb000360000008f1000008fb000002fa000080fd00050430009580001f010b80fb000360000008f1000008fb000004fa000040fd00050830010b80001f011580fb000360000008f1000008fb000004fa000040fd00050430009580001f010b80fb000360000008f1000008fb000004fa000040fd00050830010b80001f011580fb000360000008f1000008fb000004fa000040fd00050430009580001f010b80fb000360000008f1000008fb000004fa000040fd00050830010b80001f011580fb000360000008f1000008fb000004fa000040fd00050430009580001f010b80fb000360000008f1000008fb000004fa000040fd00050830010b80001f011580fb000360000008f1000008fb000004fa000040fd00050430009580001f010b80fb000360000008f1000008fb000004fa000040fd00050830010b80001f011580fb000360000008f1000008fb000004fa000040fd00050430009580001f010b80fb000360000008f1000008fb000004fa000040fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000008fa000020fd00050430009580001f010b80fb000360000008f1000008fb000008fa000020fd00050830010b80001f011580fb000360000008f1000008fb000004fa000040fd00050430009580001f010b80fb000360000008f1000008fb000004fa000040fd00050830010b80001f011580fb000360000008f1000008fb000004fa000040fd00050430009580001f010b80fb000360000008f1000008fb000004fa000040fd00050830010b80001f011580fb000360000008f1000008fb000004fa000040fd00050430009580001f010b80fb000360000008f1000008fb000004fa000040fd00050830010b80001f011580fb000360000008f1000008fb000004fa000040fd00050430009580001f010b80fb000360000008f1000008fb000004fa000040fd00050830010b80001f011580fb000360000008f1000008fb000004fa000040fd00050430009580001f010b80fb000360000008f1000008fb000004fa000040fd00050830010b80001f011580fb000360000008f1000008fb000004fa000040fd00050430009580001f010b80fb000360000008f1000008fb000002fa000080fd00050830010b80001f011580fb000360000008f1000008fb000002fa000080fd00050430009580001f010b80fb000360000008f1000008fb000002fa000080fd00050830010b80001f011580fb000360000008f1000008fb000002fa000080fd00050430009580001f010b80fb000360000008f1000008fb000002fa000080fd00050830010b80001f011580fb000360000008f1000008fb000002fa000080fd00050430009580001f010b80fb000360000008f1000008fb000002fa000080fd00050830010b80001f011580fb000360000008f1000008fb000001fb000001fc00050430009580001f010b80fb000360000008f1000008fb000001fb000001fc00050830010b80001f011580fb000360000008f1000008fb000001fb000001fc00050430009580001f010b80fb000360000008f1000008fb000001fb000001fc00050830010b80001f011580fb000360000008f1000008fb000001fb000001fc00050430009580001f010b80fb000360000008f1000008fa000080fc000002fc00050830010b80001f011580fb000360000008f1000008fa000080fc000002fc00050430009580001f010b80fb000360000008f1000008fa000080fc000002fc00050830010b80001f011580fb000360000008f1000008fa000080fc000002fc00050430009580001f010b80fb000360000008f1000008fa000080fc000002fc00050830010b80001f011580fb000360000008f1000008fa000040fc000004fc00050430009580001f010b80fb000360000008f1000008fa000040fc000004fc00050830010b80001f011580fb000360000008f1000008fa000040fc000004fc00050430009580001f010b80fb000360000008f1000008fa000040fc000004fc00050830010b800098003601860000021601a801860000021601a301860000021601a300011f011580fb000360000008f1000008fa000020fc000008fc00050430009580001f010b80fb000360000008f1000008fa000020fc000008fc00050830010b80001f011580fb000360000008f1000008fa000020fc000008fc00050430009580001f010b80fb000360000008f1000008fa000010fc000010fc00050830010b80001f011580fb000360000008f1000008fa000010fc000010fc00050430009580001f010b80fb000360000008f1000008fa000010fc000010fc00050830010b80001f011580fb000360000008f1000008fa000010fc000010fc00050430009580001f010b80fb000360000008f1000008fa000008fc000020fc00050830010b80001f011580fb000360000008f1000008fa000008fc000020fc00050430009580001f010b80fb000360000008f1000008fa000004fc000040fc00050830010b80001f011580fb000360000008f1000008fa000004fc000040fc00050430009580001f010b80fb000360000008f1000008fa000004fc000040fc00050830010b80001f011580fb000360000008f1000008fa000002fc000080fc00050430009580001f010b80fb00036000000ff1ff00f8fa000002fc000080fc00050830010b800018011580fb000060e6000001fd000001fb000504300095800018010b80fb000060e6000001fd000001fb00050830010b800018011580fb000060e6000001fd000001fb000504300095800018010b80fb000060e5000080fe000002fb00050830010b800018011580fb000060e5000080fe000002fb000504300095800018010b80fb000060e5000040fe000004fb00050830010b800018011580fb000060e5000020fe000008fb000504300095800018010b80fb000060e5000020fe000008fb00050830010b800018011580fb000060e5000010fe000010fb000504300095800018010b80fb000060e5000010fe000010fb00050830010b800018011580fb000060e5000008fe000020fb000504300095800018010b80fb000060e5000004fe000040fb00050830010b800018011580fb000060e5000002fe000080fb000504300095800018010b80fb000060e5000002fe000080fb00050830010b800017011580fb000060e5000301000001fa000504300095800016010b80fb000060e40002800002fa00050830010b80001c011580fb000060e700080f80004000040003e0fd00050430009580001c010b80fb000060e700080f80003000180003e0fd00050830010b80001c011580fb000060e700080f80000c00600003e0fd00050430009580001c010b80fb000060e700080f80000301800003e0fd00050830010b80001c011580fb000060e700080f800000fe000003e0fd000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050830010b800010011580fb000060da000504300095800010010b80fb000060da00050835550b800010011580fb000060da0005043aae95800010010b80fb000060da00050835fd0b800010011580fb000060da00050433fc95800010010b80fb000060da00050831f90b800010011580fb000060da00050432f895800010010b80fb000060da00050831710b800010011580fb000060da00050430f095800010010b80fb000060da00050830610b800010011580fb000060da00050430e095800010010b80fb000060da00050830410b800010011580fb000075da5505543aaa95800010010b80fb00006adaaa05a835550b800009011580d0000215800009013f80d000021f800008010080cf0001800009010b80d000020b800010011580fb00007fdaff05fc000015800010010b80fb00007fdaff05fc00000b800016011580fb00016008f6aa00a8e800062008000015800016010b80fb00016015f6550054e80006500400000b800016011580fb000160acf6ff00fce800062a08000015800017010b80fb0002617d7ff7ff00fce800065d0400000b800016011580fb00016afcf6ff00fce800063ea8000015800017010b80fb000277fd7ff7ff00fce800065ff400000b800016011580fb00016ffcf6ff00fce800063fe8000015800017010b80fb000263fd7ff7ff00fce800065f8400000b800016011580fb000160fcf6ff00fce800063e08000015800017010b80fb0002603d7ff7ff00fce80006780400000b800016011580fb0001600cf6ff00fce800062008000015800010010b80fb000075da55055400000b800010011580fb00006adaaa05a8000015800009010b80d000020b8000080015cf00021580000e030aaaaacad5aa05ab2aaaab8000070015ce550180000e030aaaaacad5aa05ab2aaaab8000070015ce550180000d031fffffdfd4ff047fffff800007003fceff01800002cb00a0008fa00083ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 6.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 Using this editor, circles and rectangles can be drawn, selected, moved, and resized using the mouse. The view is automatically scrolled if the mouse is moved outside while dragging or drawing an object. All commands are undoable. The history scroller can be used to travel through the command history. If necessary, the view is scrolled, to show the effect of an undo or redo operation.\par \pard \s2\qj\ri1\sb40\sa100 The palette on the left is used to select the desired mode. In select mode existing objects can be selected by either clicking the mouse into them or dragging a dashed rectangle around them. Objects can be moved around if the mouse is held down and moved. If one of the four little resize handles is hit an object is resized. In rectangle and circle mode new rectangles (circles) are drawn even if the mouse goes down in an existing object. Squares and true circles with equal width and height are drawn, when pressing the left mouse button with shift for dragging. The three remaining modes are not implemented.\par \pard \s2\qj\ri1\sb40\sa100 There is a main menu entry {\f22 Clear All} which can be used to delete all objects.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 6.2 Implementation\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 The palette is implemented as a radio button group with a pixmap for each button. Each item in the item list consists of a pathname and keyword for the mode. When a radio button is pressed, the method {\f22 set-mode} of class {\f22 graphic-editor-view} is called. Form constraints define that the size of the palette is fixed and the size of the scroller containing the drawing area is variable.\par \pard \s2\qj\ri1\sb40\sa100 When a document is saved, the representation of each object is written in a loop. The representation of each object begins with a keyword for the type of object ({\f22 \:circle} or {\f22 \:rectangle}). Before that, the number of objects is written, so that it is easier to read in the description later. When a document is read from a stream, we have to deinstall any existing objects first, because we can be in a {\f22 revert} command. There are {\f22 read-from-stream} methods specialized for the keywords {\f22 \:circle} and {\f22 \:rectangle} which create new objects from the parameters found in the input stream. \par \pard \s2\qj\ri1\sb40\sa100 When a mouse button is pressed in the graphic editor view, a mouse command is created depending on the currently selected mode. When the drawing mode is changed, the slot {\f22 propagate-button-press} of class view is also modified, because in circle and rectangle mode {\f22 button-press} messages are handled directly by the view while in select mode {\f22 button-press} is passed to the object hit (if any).\par The class {\f22 rectangle} is a straightforward subclass of {\f22 direct-manipulation-object} which overrides the method {\f22 draw} to define the shape of a rectangle. Facilities for moving, selecting and resizing objects are inherited by the superclass. The method {\f22 constrain-size} is overridden to guarantee the a square remains a square.\par \pard \s2\qj\ri1\sb40\sa100 The class {\f22 circle} is implemented analogously to class {\f22 rectangle}, but in addition the method {\f22 draw-outline} is overridden. This method is responsible for drawing the feedback while an object is moved or resized. The default feedback is a dashed rectangle but we prefer a dashed circle.\par \pard \s2\qj\ri1\sb40\sa100 A {\f22 rectangle-drawer }is a special kind of {\f22 mouse-down-command}. The feedback is a dashed rubberband rectangle. The mouse coordinates used in the command are constrained so that the feedback rectangle always has positive width and height. If shift is held down the minimum of width and height is used for both so that a square is drawn. In the method {\f22 doit} a new rectangle is created and installed in the view. In case of a redo, {\f22 doit} is also called and just installs the already existing rectangle. Alternatively, we could have overridden the method {\f22 redoit} which by default calls {\f22 doit}. To undo the command the rectangle is deinstalled. Note that view-objects can - other than widgets - exist without having a parent. The class {\f22 circle-drawer} is implemented analogously.\par \pard \s2\qj\ri1\sb40\sa100 A {\f22 clear-all-command} stores the list of objects being cleared, so that they can be installed again in {\f22 undoit}.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 6.3 Limitations and Extensions\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 The commands and graphical objects for the remaining modes shown in the palette could be implemented as a simple and straightforward extension of this demo. \par \pard \s2\qj\ri1\sb40\sa100 Currently, circles are selected even if the the mouse is clicked outside the circle itself, but the enclosing rectangle is hit. To fix this problem, the method {\f22 point-inside} of class {\f22 circle} could be overridden to check more precisely, whether a point lies inside the circle. The default method just checks if the enclosing rectangle is hit.\par \pard \s2\qj\ri1\sb40\sa100 The next step towards a serious graphic editor would be to add attributes like line width to the objects and to modify the graphic contexts in the {\f22 draw} methods accordingly.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 6.4 Source Code\par \pard\plain \s10 \f22\fs12 ;;;-*-Mode\:LISP;Syntax\: Common-Lisp;Package\:gredit;Base\:10-*-\par \par (in-package \:GINA)\par (defginapackage \:gredit) \par (in-package \:gredit)\par (setq *sccs-id* "@(#)graphic-editor.lisp\tab 1.7  1/20/92")\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class graphic-editor-application\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass graphic-editor-application (application)\par   (;; overrides\par    (name                 \:initform "Graphic Editor"         \:allocation \:class)\par    (document-type        \:initform 'graphic-editor-document \:allocation \:class)\par    (signature            \:initform "gredit"                 \:allocation \:class)\par    (file-type            \:initform "gredit"                 \:allocation \:class))\par   (\:documentation "a simple graphic editor application"))\par \par (defun make-graphic-editor-application ()\par   "start the graphic-editor-application"\par   (make-application \:class 'graphic-editor-application))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class graphic-editor-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass graphic-editor-document (document)\par   (;; overrides\par    (shell-width  \:initform 400)\par    (shell-height \:initform 500))\par   (\:documentation "application dependent document type"))\par \par (defmethod create-windows ((doc graphic-editor-document)\par \tab \tab \tab    &aux scroller form radio-group)\par   "create the windows belonging to this document"\par   (with-slots (main-shell main-view) doc\par     (setq main-shell (make-document-shell doc))\par     ;; create a form containing the different parts\par     (setq form      (make-form main-shell))\par     (setq scroller  (make-scroller form))    \par     (setq main-view (make-graphic-editor-view scroller doc))\par     (setq radio-group\par \tab   (make-radio-button-group form\par \tab \tab \tab    '(("arrow"     \:select-mode)\par                              ("rectangle" \:rect-mode)\par \tab \tab \tab      ("circle"    \:circle-mode)\par \tab \tab \tab      ("line"      \:line-mode)\par \tab \tab \tab      ("triangle"  \:poly-mode)\par                              ("glyph"     \:text-mode))\par                            \:value-changed-callback\par                               (make-callback #'set-mode main-view)\par \tab \tab \tab    \:button-label-type \:pixmap\par \tab \tab \tab    \:button-resources '(\:shadow-thickness 3)))\par     \par     ;; layout definition\:\par     (define-form-constraint radio-group\par \tab \tab \tab     \:top-attachment \:form\par \tab \tab \tab     \:left-attachment \:form)\par     (define-form-constraint scroller\par \tab \tab \tab     \:left-attachment \:widget \:left-widget radio-group\par \tab \tab \tab     \:top-attachment \:form \par \tab \tab \tab     \:right-attachment \:form\par \tab \tab \tab     \:bottom-attachment \:form)\par     \par     ;; add some menu commands\par     (add-menu-command (main-menu main-shell)\par \tab \tab       "Draw" "Clear All"\par \tab \tab       (make-callback #'make-clear-all-command doc))\par     ))\par \par \par \par \par (defmethod write-to-stream ((doc graphic-editor-document) stream)\par   "write the document to the specified stream"\par   ;; write number of objects\par   (format stream "~d~%" (length (view-objects (main-view doc))))\par   \par   ;; write all objects\par   (loop for object in (view-objects (main-view doc))\par \tab do (write-to-stream object stream)))\par \par (defmethod read-from-stream ((doc graphic-editor-document) stream\par \tab \tab \tab      &aux nr-of-objects) \par   "read the document from the specified stream"\par   ;; deinstall existing objects\par   (loop for object in (view-objects (main-view doc))\par \tab do (deinstall object))\par   \par   ;; read number of objects\par   (setq nr-of-objects (read stream))\par \par   ;; read positions of objects\par   (loop repeat nr-of-objects\par \tab as class = (read stream)\par \tab do (install (read-from-stream class stream)\par \tab \tab     (main-view doc) (read stream) (read stream)) ;; x-pos y-pos\par \tab    ))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class graphic-editor-view\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass graphic-editor-view (view)\par   ((drawing-mode \:accessor drawing-mode \:initform \:select-mode))\par   (\:documentation "a view with special reaction to clicks"))\par \par (defun make-graphic-editor-view (parent doc)\par   (make-view parent\par \tab      \:width 1000 \:height 1000 \:document doc\par \tab      \:class 'graphic-editor-view))\par \par (defmethod button-press ((view graphic-editor-view) code repetition x y)\par   "react to button-press event in the window"\par   (declare (ignore repetition))\par   (case (drawing-mode view)\par     (\:select-mode  (make-object-selector  view x y code))\par     (\:rect-mode    (make-rectangle-drawer view x y code))\par     (\:circle-mode  (make-circle-drawer    view x y code))))\par \par (defmethod set-mode ((view graphic-editor-view) new-mode old-mode)\par   "depending on the palette, button-press is propagated to the objects or not"\par   (declare (ignore old-mode))\par   (with-slots (drawing-mode propagate-button-press) view\par     (setq drawing-mode new-mode)\par     (setq propagate-button-press (eql drawing-mode \:select-mode))))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class rectangle\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass rectangle (direct-manipulation-object)\par   (;;overrides\par    (facilities \:initform \:resizable \:allocation \:class\par \tab        \:documentation "rectangles can be moved, selected and resized")\par    (outlines   \:initform t          \:allocation \:class\par \tab        \:documentation\par \tab        "just move an outline of the object, not the object itself")\par    (ensure-square \:accessor ensure-square \:initarg \:ensure-square))\par   (\:documentation "a rectangular object in the view"))\par \par (defun make-rectangle (width height &key (ensure-square nil))\par   (make-direct-manipulation-object \par    width height \:class 'rectangle\par    \:initargs (list \:ensure-square ensure-square)))\par \par (defmethod draw ((rect rectangle) count x y width height)\par   "draw rect into the view"\par   (declare (ignore x y width height))\par   (when (zerop count) ;; Ignore all but the last exposure event\par     (draw-rectangle rect 0 0 (width rect) (height rect))))\par \par \par (defmethod constrain-size ((rect rectangle) width height)\par   "make sure that width and height remain equal"\par   (if (not (ensure-square rect))\par       ;; just return width and height unmodified\par       (values width height)\par     ;; else\: compute minimum\par     (values (min width height) (min width height))))\par \par \par (defmethod write-to-stream ((rect rectangle) stream)\par   "write textual representation of a rectangle to stream"\par   (with-slots (x-pos y-pos width height) rect\par     (format stream "\:rectangle ~d ~d ~d ~d~%" width height x-pos y-pos)))\par \par (defmethod read-from-stream ((class (eql \:rectangle)) stream)\par   "create a rectangle from its textual representation"\par   (make-rectangle (read stream) (read stream)))  ;; width height\par        \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class circle\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass circle (direct-manipulation-object)\par   (;;overrides\par    (facilities \:initform \:resizable  \:allocation \:class)\par    (outlines   \:initform t           \:allocation \:class)\par    (ensure-true-circle \:accessor ensure-true-circle \par \tab \tab        \:initarg \:ensure-true-circle))\par   (\:documentation "a circle in the view"))\par \par (defun make-circle (width height &key (ensure-true-circle nil))\par   (make-direct-manipulation-object \par    width height \:class 'circle\par    \:initargs (list \:ensure-true-circle ensure-true-circle)))\par \par (defmethod draw ((cc circle) count x y width height)\par   "draw circle into the view"\par   (declare (ignore x y width height))\par   (when (zerop count) ;; Ignore all but the last exposure event\par     (draw-arc cc 0 0 (width cc) (height cc) 0 (* 2 pi))))\par \par (defmethod draw-outline ((cc circle) new-x new-y width height &key clear)\par   "draw circular outline"\par   (declare (ignore clear))\par   (with-slots (parent-view) cc\par     (xlib\:with-gcontext ((gcontext parent-view) \:line-style \:dash)\par       (draw-arc parent-view new-x new-y width height 0 (* 2 pi)))))\par \par (defmethod constrain-size ((cc circle) width height)\par   "make sure that width and height remain equal"\par   (if (not (ensure-true-circle cc))\par       ;; just return width and height unmodified\par       (values width height)\par     ;; else\: compute minimum\par     (values (min width height) (min width height))))\par \par (defmethod write-to-stream ((obj circle) stream)\par   "write textual representation of object to stream"\par   (with-slots (x-pos y-pos width height) obj\par     (format stream "\:circle ~d ~d ~d ~d~%" \par                    width height x-pos y-pos)))\par \par (defmethod read-from-stream ((class (eql \:circle)) stream)\par   "create a circle from its textual representation"\par   (make-circle (read stream) (read stream)))  ;; width height\par        \par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class rectangle-drawer\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass rectangle-drawer (mouse-down-command)\par   (;; overrides\par    (name \:initform "Draw Rectangle" \:allocation \:class)\par    (hysteresis \:initform 5          \:allocation \:class)\par    ;; instance-variables\par    (shift-pressed \:accessor  shift-pressed \:initarg \:shift-pressed)\par    (new-rectangle \:accessor new-rectangle \:initform nil))\par   (\:documentation "a mouse-down-command to draw a rectangle"))\par \par (defun make-rectangle-drawer (view x y code)\par   (make-mouse-down-command (document view) view x y\par \tab \tab \tab    \:cursor \:crosshair\par \tab \tab \tab    \:class 'rectangle-drawer\par \tab \tab \tab    \:initargs (list \:shift-pressed (eq code \:extend))))\par \par (defmethod constrain-mouse ((cmd rectangle-drawer) x y &aux edge-length)\par   "make sure width and height of outline is > 0; ensure square"\par   (with-slots (start-x start-y shift-pressed) cmd\par     (setq x (max x (1+ start-x)))\par     (setq y (max y (1+ start-y)))\par     (when shift-pressed\par       ;; we draw a square\par       (setq edge-length (min (- x start-x) (- y start-y)))\par       (setq x (+ start-x edge-length))\par       (setq y (+ start-y edge-length))))\par   (values x y))\par \par (defmethod draw-feedback ((cmd rectangle-drawer) x y &key clear)\par   "draw rectangular feedback"\par   (declare (ignore clear))\par   (with-slots (start-x start-y view) cmd\par     (xlib\:with-gcontext ((gcontext view) \:line-style \:dash)\par       (draw-rectangle view start-x start-y (- x start-x)  (- y start-y)))))\par \par (defmethod doit ((cmd rectangle-drawer))\par   "install the specified rectangle"\par   (with-slots (start-x start-y last-x last-y view \par \tab \tab        new-rectangle shift-pressed) cmd\par     (when (not new-rectangle)\par       (setq new-rectangle (make-rectangle (- last-x start-x) (- last-y start-y)\par \tab \tab \tab \tab \tab   \:ensure-square shift-pressed)))\par     (install new-rectangle view start-x start-y)\par     ))\par \par (defmethod undoit ((cmd rectangle-drawer))\par   "deinstall the specified rectangle again"\par   (with-slots (new-rectangle) cmd\par     (deinstall new-rectangle)))\par \page ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class circle-drawer\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass circle-drawer (mouse-down-command)\par   (;; overrides\par    (name \:initform "Draw Circle"    \:allocation \:class)\par    (hysteresis \:initform 5          \:allocation \:class)\par    ;; instance-variables\par    (shift-pressed \:accessor  shift-pressed \:initarg \:shift-pressed)\par    (new-circle \:accessor new-circle \:initform nil))\par   (\:documentation "a mouse-down-command to draw a circle"))\par \par (defun make-circle-drawer (view x y code)\par   (make-mouse-down-command (document view) view x y\par \tab \tab \tab    \:cursor \:crosshair\par \tab \tab \tab    \:class 'circle-drawer\par \tab \tab \tab    \:initargs (list \:shift-pressed (eq code \:extend))))\par \par (defmethod constrain-mouse ((cmd circle-drawer) x y &aux diameter)\par   "make sure width and height of outline is > 0"\par   (with-slots (start-x start-y shift-pressed) cmd\par     (setq x (max x (1+ start-x)))\par     (setq y (max y (1+ start-y)))\par     (when shift-pressed\par       ;; we draw a true circle\par       (setq diameter (min (- x start-x) (- y start-y)))\par       (setq x (+ start-x diameter))\par       (setq y (+ start-y diameter))))\par   (values x y))\par \par (defmethod draw-feedback ((cmd circle-drawer) x y &key clear)\par   "draw circular feedback"\par   (declare (ignore clear))\par   (with-slots (start-x start-y view) cmd\par     (xlib\:with-gcontext ((gcontext view) \:line-style \:dash)\par       (draw-arc view start-x start-y (- x start-x) (- y start-y) 0 (* 2 pi)))))\par \par (defmethod doit ((cmd circle-drawer))\par   "install the specified circle"\par   (with-slots (start-x start-y last-x last-y view new-circle shift-pressed) cmd\par     (when (not new-circle)\par       (setq new-circle (make-circle (- last-x start-x) (- last-y start-y)\par \tab \tab \tab \tab     \:ensure-true-circle shift-pressed)))\par     (install new-circle view start-x start-y)))\par \par (defmethod undoit ((cmd circle-drawer))\par   "deinstall the specified circle again"\par   (with-slots (new-circle) cmd\par     (deinstall new-circle)))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class clear-all-command\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass clear-all-command (command)\par   (;; overrides\par    (name \:initform "Clear All Command" \:allocation \:class)\par    ;; instance-parameters\par    (objects \:accessor objects \:initarg \:objects\par \tab     \:documentation "objects being cleared"))\par   (\:documentation "a command to delete all objects"))\par \par (defun make-clear-all-command (document)\par   "create a new command object with appropriate parameters"\par   (make-command document\par \tab \tab \:class 'clear-all-command\par \tab \tab \:initargs `(\:objects ,(view-objects (main-view document)))))\par \par (defmethod doit ((cmd clear-all-command))\par   "delete all objects from the view"\par   (loop for object in (objects cmd)\par \tab do (deinstall object)))\par \par (defmethod undoit ((cmd clear-all-command))\par   "reinstall all objects in the view"\par   (loop for object in (objects cmd)\par \tab do (install object (main-view (document cmd))\par \tab \tab     (x-pos object) (y-pos object))))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; main program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (register-application "gredit" 'graphic-editor-application "gredit")\par '(make-graphic-editor-application) \par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 7. Graphic-Output\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 7.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 This demo just shows the use of the graphics primitives of the X Window System. In the main view several rectangles, circles, lines etc. are shown. There are three modeless dialog boxes to change attributes of the graphics context like line width, arc mode etc. The changes are immediately reflected in the view.\par \pard\plain \s7\qc\ri1\sb200\sa200\keepn \f34 {{\pict\macpict\picw486\pich474 2ca20000000001da01e61101a00082a0008e01000a0000000002d0024098003e0000000000a801e80000000000a801e60000000000a801e6000102c3000cfe000040cc000420000010000a0015c9550465555570000cfe000040cc000420000030000a030aaaaacac9aa01b0000cfe000040cc000420000030000d0315ffffdfccff04effffd7000070001c6000130000f030b000040ce0006800020000ab0001103012aaacaf2aa00a0ee00edaa02a830000f0315000040ce000680002000097000230001ef551343e00000c18000f001800030018c019998006031f155069555640058300026030b000040f2001306300000c000019801800030018c0181980060f0f10006800020008ab0002203012aaacaf2aa13ac06de6cd99e030d9bdb3379818db3dbd9e36030edaa02a83000260315000040f200130c07f376edb3030d999db331818dd9999b36e030f1000680002000897000230001ef55134cf70366cdb0030d9999b330018d99999b366031f1550695556455d8300026030b000440f200130c361f66cdb0030d9999b330018d99999bf66030f10006801020008ab00025030127fecaf2aa13ac363366cdb0030d9999b330018d99999b066030f0aa057aaaaaa83000260315000040f2001306363376cdb30199b9bdb73580d999b9bb36e030f1000680002000897000230001ef551343d61deccd9e00f0d8db1b1980f998d8d9e36031f1550695556455d8300017030b000040ef000060fc000018e70006800020ff8ab0001803012aaacaf2aa03a0000060fc000018f700edaa02a83000170315000040ef000060fc000018e70006800020000970000f03017fffdfceff06bfffeffff8300008003fc7ff02fbf000080000c7aa02a01000090115d5c85502517000090101a0c8000230300008010bc0c700013000080101a0c70001b0000c0115c0dc000005ed5501f0000d0101a0dc000002eeaa02abb0000d010bc0dc000005eeff02fdb0000d0101a0dc000003ee000203b0000c0115c0dc000005ed5501f000160101a0dc0006032aaacaaaaabff7ff05eaaaaab3b00024050bc000001878fc00000ef8000006fe0000c0f4000005fc55005ff7ff00d5fe5501b000330501a003fc1818fe00023f0006fc00047a1d000006fe0000c0f40016032aaacaaaaab3cfffffcf39fc9fff3fffeaaaaab3b000310515c0018c0018fe0002198006fc0004ce37000006fe0000c0f4000005fc550053feff078739ff9fff3fffd5fe5501f000351901a0018c78181e000018c786e738ee000186631e3b8fc3c739f8f40016032aaacaaaaab3c9387fb6109093321870eaaaaab3b00034190bc001a0181833000018ccc733199c00018060331cc6066330c0f40002055001fe550a53c8933f33398089333326fd5501b000351901a001e0181861800018d86633198c000180606198c60c31e0c0f400160322aecaaaaab3c9933f33398c99333323eaaaaab3b000331915c001a018187f800018dfe633198c00019f606198c60ff0c0c0f4000005fc550b53c9903f03399c99333038d5fe5501f000351901a00180181860000018d80633198c000186606198c60c01e0c0f400160327fecaaaaab3c993fe79399c993333fc6aaaaab3b00032190bc001801818338000198ce733399c0000c6333318c6667330ccf4000005fc550a53c9933e79291c89232326fd5501b000351901a003e07e7e1f00003f07cee1dcec00007e1e1e3de3c3e73878f40016032aaacaaaaab009987e799c9c93939870eaaaaab3b000180115c0f500000ce9000005fc55005ff7ff00d5fe5501f0001a0101a0f500000ce90006032aaacaaaaabff7ff05eaaaaab3b00018010bc0f5000078e9000005fc55005ff7ff00d5fe5501b000100101a0dc0003037fffdff1ff02f3b0000d0115c0dc000005eeff02f5f0000e0101a0dc00010380ef000203b0000e010bc0dc00010580ef000205b0000e0101a0dc00010380ef000203b0000e0115c0dc00010580ef000205f000130101a0dc00010380f5000103c0fd000203b00013010bc0dc00010580f500010660fd000205b000130101bfdcff01e380f500010660fd000203b000120015dbff01e580f500010660fd000205f000120001dbff01e380f5000103c0fd000203b00012000bdbff01e580f500010660fd000205b000130101e0dc00010380f500010660fd000203b000130115e0dc00010580f500010660fd000205f000130101e0dc00010380f500010660fd000203b0001b010be0fc000007fd870086e700010580f5000103c0fd000205b000160101e0fc000007fd870086e700010380ef000203b000160115e0fcff0007fd87009ee700010580ef000205f000160101e0fcff0007fd87009ee700010380ef000203b00014010be0fcfffc00001ee70001058fefff0205b000150101e0fcfffc00001ee70001038ff0ff03fe03b000190115e0fcff001ee20001058cf6000015fe550500000105f000190101e0fcff001ee20001038cf600092aaaaaab00000203b00019010be0fcff001ee20001058cf600001ffeff0500000105b000190101e0fcff001ee20001038cf600092fffbfff00000203b0001b0115e0fcfffc00001ee70001058cf600001ffeff0500000105f0001b0101e0fcfffc00001ee70001038cf600092fffbfff00000203b0001b010be0fcfffc00001ee70001058cf600001ffeff0500000105b0001b0101e0fcfffc00001ee70001038cf600092fffbfff00000203b000190115e0fcff001ee20001058cf600001ffeff0500000105f000190101e0fcff001ee20001038cf600092fffbfff00000203b00019010be0fcff001ee20001058cf600001ffeff0500000105b000120101e0fcff001ee20001038eefaa0203b000140115e0fcfffc00001ee70001058def550205f000140101e0fcfffc00001ee700010380ef000203b00014010be0fcfffc00001ee700010580ef000205b000140101e0fcfffc00001ee700010380ef000203b000120115e0fcff001ee200010580ef000205f000120101e0fcff001ee200010380ef000203b00012010be0fcff001ee200010580ef000205b000120101e0fcff001ee200010380ef000203b000140115e0fcfffc00001ee700010580ef000205f000140101e0fcfffc00001ee700010380ef000203b0001d010be0fcfffc00001ee700030581e018fc0003c038c1c0fa000205b0001d0101e0fcfffc00001ee7000303806018fc0003c018c0c0fa000203b000190115e0fcff001ee20002058060fa000218c0c0fa000205f0001d0101e0fcff001ee2000c03806078ee1e003873c1d9f8dcfa000203b0001d010be0fcff001ee2000c058060187333001b60c338c0e6fa000205b0001d0101e0fcff001ee2000c0380601863619fdb60c318c0c6fa000203b0001f0115e0fcfffc00001ee7000c05806018637f801b60c318c0c6fa000205f0001f0101e0fcfffc00001ee7000c038060186360000fc0c318c0c6fa000203b0001f010be0fcfffc00001ee7000c058060186333800cc0c338ccc6fa000205b0001f0101e0fcfffc00001ee7000c0381f87ef79f000cc3f1dc79effa000203b000120115e0fcff001ee200010580ef000205f000120101e0fcff001ee200010380ef000203b00014010be0fcff001efc78e700010580ef000205b000140101e0fcff001efc78e700010380ef000203b000160115e0fc000018fd78007ee700010580ef000205f000160101e0fc000018fd78007ee700010380ef000203b0000e010be0dc00010580ef000205b0000e0101e0dc00010380ef000203b0000e0115e0dc00010580ef000205f0000e0101e0dc00010380ef000203b0000e010be0dc00010580ef000205b0000e0101e0dc00010380ef000203b0000e0115e0dc00010580ef000205f0000e0101e0dc00010380ef000203b00016010be0dc000305803c03fc000260003cf9000205b000160101e0dc000303800c03fc000260000cf9000203b000150115e0dc000205800cfb000260000cf9000205f000190101e0dc000c03800c0f1dc3c000fcfce38c0ffa000203b0001a010be0dc000d05800c030e6660018c60630c1980fb000205b0001a0101e0dc000d03800c030c6c33f98060630c30c0fb000203b0001a0115e0dc000d05800c030c6ff000f860360c3fc0fb000205f000190101e0dc000c03800c030c6c00000c60360c30fa000203b0001a010be0dc000d05800c030c6670018c661c0c19c0fb000205b0001a0101e0dc000d03803f0fdef3e001f83c1c3f0f80fb000203b000120115e0dc00010580f9000018f8000205f000120101e0dc00010380f9000018f8000203b00012010be0dc00010580f900007cf8000205b0000e0101e0dc00010380ef000203b0000e0115e0dc00010580ef000205f0000e0101e0dc00010380ef000203b0000e010be0dc00010580ef000205b0000f0101e0dc00010381f0ff03f803b0000f0115e0dc00010581f055035005f000100101e0dc0002038180f100031803b0000f010be0dc00010581f000031005b000100101e0dc0002038180f100031803b0000f0115e0dc00010581f000031005f000100101e0dc0002038180f100031803b00011010be0dc000305810004f200031005b000110101e0dc00030381800af200031803b000180115e0dc000305810011fd000303c0300efa00031005f000180101e0dc00040381802080fd0002c03006fa00031803b00018010be0dc00040581004040fd0002c00006fa00031005b000190101e0dc000b03818080200607e3c0c0f076fa00031803b000190115e0dc000b0581010010060c6660c030cefa00031005f000190101e0dc000b0381820018000c0c30c030c6fa00031803b00019010be0dc000b05810180300007cc30c030c6fa00031005b000190101e0dc000b038180c06000006c30c030c6fa00031803b000190115e0dc000b05810060c0060c6660c030cefa00031005f000190101e0dc000b0381803180060fc3c3f0fc77fa00031803b00011010be0dc00030581001bf200031005b000110101e0dc00030381800ef200031803b000110115e0dc000305810004f200031005f000100101e0dc0002038180f100031803b0000f010be0dc00010581f000031005b000100101e0dc0002038180f100031803b000180115e0fa00010f87f5000070f200010581f000031005f0001a0101e0fa00020f87c0f600007cf20002038180f100031803b0001a010be0fb0003030787c0f600007cf200010581f000031005b000240401e0000008fe00030f078782fd000010fb00017820f3000303818004f200031803b000250b15e00003ffe000000f878783fd00011fc0fc00017830f300030581000ef200031005f0002d0801e0000ffff800000ffe870080fe00011ff0fc00017878f300030381801bfe0003e0000380f900031803b0002d0c0be0003ffffe000007c38f0fc0fe00011ffcfc0001f0fcf3000a0581003580000060000180f900031005b0002d0201e000feff06000003c38f0f80fe00011ffefc0001f0f8f3000a0381806ec0000060000180f900031803b0002d0215e001feff05c00181e0001ffd00021fff80fd000101f0f3000a058100df60060767c1f9b8f900031005f0002d0201e003feff05e003c1c0003efd00021fffc0fd000103e0f3000a038181bfb0060ce06319ccf900031803b00098003e00a80000015001e800a80000015001e600a80000015001e600012f020be007feff06f007e000001c04fe00021fffe0fd000201c040f4000a0581037fc8000c6063018cf900031005b0002e0201e00ffeff06f003f00000081cfe00021fffe0fc000181c0f4000a0381813f90000c67e1f18cf900031803b0002e0215e00ffeff02f801f8fe00003efe00021ffff0fc000103e0f4000a0581009f20000c6c60198cf900031005f0002e0201e01ffeff02fc0078fe0000fefe00021ffff8fc00010fe0f4000a0381804e40060cece3198cf900031803b0002e020be01ffeff06fc0010000001fefe00021ffff8fc00011fe0f4000a058100248006077773f3def900031005b000250201e03ffeff00fefd000101f0fe00021ffffcfc00001ff3000303818011f200031803b000250215e03ffeff01fe1cfd0000c0fe00021ffffcfc00000cf300030581000af200031005f0001d0201e07ffdff013f80fa00021ffffeed000303818004f200031803b0001b020be07ffdff013fc0fa00021ffffeed00010581f000031005b000240201e07ffdff013fc0fe0006078000001ffffefb000078f40002038180f100031803b000240215e07ffdff010fc0fe00067f8000001ffffefc000107f8f400010581f000031005f000220201e07ffdfffc00067f8000001ffffefc000107f8f40002038180f100031803b00021020be07ffdfffc00067f8000001ffffefc000107f8f400010581f000031005b000120101e0fcffe10002038180f100031803b0001b0215e07ffdff010040eb000010fa000305810004f200031005f000200201e07ffdff013fc0fe00017f80f0000010fa00030381800af200031803b0002c020be07ffdff013fc0fe00017f80f0000038fa000305810011fe000fe0000380f0000001c00007001005b0002c0201e07ffdff013fc0fe00017f80f0000038fa000b038180208000006000018030fe0007c00003001803b0002b0215e07ffdff003efd00011f80f0000078fa000b058100404000006000018030fe0007c00003001005f0002b0201e07ffdff0020fd00010380f000007cfa00160381808020060763c739b8303c000ecf83f3701803b00026020be03ffeff00fee900007cfa00160581010010060ce66319cc30660019c0c633981005b0002c0201e03ffeff06fe007000000180ef0000fefa00160381820018000c6c33198c30c33f98c0c603181803b0002c0215e01ffeff06fc01f0000001e0ef0000fefa00160581018030000c6c33198c30ff0018cfc3e3181005f0002d0201e01ffeff06fc07f8000003f8f0000101fefa0016038180c060000c6c33198c30c00018d8c033181803b0002d020be00ffeff06f80fe0000001fef0000101fffa001605810060c0060ce66339cc30670019d9c633181005b0002d0201e00ffeff02f007c0fe0000fcf0000101fffa00160381803180060773c1dfb8fc3e000eeee7e7bc1803b000220215e007feff06f007830000107cf0000203ff80fb00030581001bf200031005f000220201e003feff06e00207c0007818f0000203ff80fb00030381800ef200031803b00021020be001feff05c0000780007cef000207ff80fb000305810004f200031005b000200201e000feff0500000f0f1c3eef000207ffc0fb0002038180f100031803b0001f0b15e0003ffffe00001f0f1e1eef000207ffc0fb00010581f000031005f000200b01e0000ffff800003e0e1e1fef00020fffe0fb0002038180f100031803b0001f070be00003ffe00000fe1e000fef00020fffe0fb00010581f000031005b0001d0101e0fb00030c1e1e0eef00021fffe0fb0002038180f100031803b0001a0115e0fa00011e1fee00021ffff0fb00010581f000031005f0001a0101e0fa00013e1fee00021ffff0fb00010381f0ff03f803b0001a010be0fa00011e0fee00023ffff8fb00010581f055035005b000140101e0e500023ffff8fb00010380ef000203b000140115e0e500027ffff8fb00010580ef000205f000160101e0f5f0f100027ffffcfb00010380ef000203b00016010be0f5f0f100027ffffcfb00010580ef000205b000160101e0f5f0f10002fffffefb00010380ef000203b000160115e0f5f0f10002fffffefb00010580ef000205f000170101e0f5f0f2000301fffffefb00010380ef000203b00017010be0f5f0f300010181fefffb00010580ef000205b000170101e0f5f0f3000101e1fefffb00010380ef000203b000190115e0f5f0f3000101fbfeff0080fc00010580ef000205f000170101e0e7000101fdfeff0080fc00010380ef000203b00021010be0e7000501f87fffff80fc0005058006000180fe000260003cf9000205b000210101e0e7000501f81fffffc0fc0005038006000180fe000260000cf9000203b0001d0115e0e7000501f807ffffc0fc00010580fa000260000cf9000205f000220101e0e7000501f001ffffe0fc000c03803e0f078ee000fcfce38c0ffa000203b00023010be0e7000501f0007fffe0fc000d05800619818730018c60630c1980fb000205b0002f0d01e9081008010008001000080001f3000501e0001fffe0fc000d03800630c18633f98060630c30c0fb000203b000230115e0e7000501e00007fff0fc000d05800630c1863000f860360c3fc0fb000205f000220101e0e7000501e00001fff0fc000c03800630c18630000c60360c30fa000203b00023010be0e7000501c000007ff8fc000d05800619818630018c661c0c19c0fb000205b000230101e0e7000501c000001ff8fc000d0380060f07ef7801f83c1c3f0f80fb000203b0001c0115e0e700050180000007f8fc0002058006fa000018f8000205f0001c0101e0e700050180000001fcfc0002038006fa000018f8000203b0001c010be0e700010180fe00007cfc000205803cfa00007cf8000205b000160101e0e7000001fd00001efc00010380ef000203b000160115e0e7000001fd000006fc00010580ef000205f0000e0101e0dc00010380ef000203b0000e010be0dc00010580ef000205b0000f0101e0dc00010381f0ff03f803b0000f0115e0dc00010581f055035005f000100101e0dc0002038180f100031803b0000f010be0dc00010581f000031005b000100101e0dc0002038180f100031803b0000f0115e0dc00010581f000031005f000100101e0dc0002038180f100031803b00011010be0dc000305810004f200031005b000110101e0dc00030381800ef200031803b000160115e0dc00030581001bfd0001c180f800031005f000170101e0dc00040381803580fe0001c180f800031803b00017010be0dc00040581006ec0fe00010180f800031005b000190101e0dc000b038180df600636c3c3f0f0eefa00031803b000190115e0dc000b058101bfb0061b60c1819870fa00031005f000190101e0dc000b0381837fc8001b60c1830c60fa00031803b00019010be0dc000b0581013f90001b60c183fc60fa00031005b000190101e0dc000b0381809f20001b60c1830060fa00031803b000190115e0dc000b0581004e40061b60c1999c60fa00031005f000190101e0dc000b0381802480063b73f0f0f8fcfa00031803b00011010be0dc000305810011f200031005b000110101e0dc00030381800af200031803b000251515e07d01000040000002000080040001800080060041f0000305810004f200031005f000220201e011fb000d020000800000024000800800c280f10002038180f100031803b00024160be011630e00c38038078e45e00c58020e59e010454440f100010581f000031005b000251601e0119110004400040211288004640791648016284440f10002038180f100031803b000241615e011110e0043803c021f108004440211448019104440f100010581f000031005f000251601e0111101004040440250289004440211449011284280f10002038180f100031803b00023150be011139e00e7803c018e44600e44020e44600e45f1f000010581f000031005b000110101e0dc000303818004f200031803b000110115e0dc00030581000af200031005f000150101e0dc000303818011fa00000efa00031803b00016010be0dc00040581002080fb000006fa00031005b000160101e0dc00040381804040fb000006fa00031803b000190115e0dc000b0581008020060ee3c73bb876fa00031005f000190101e0dc000b03818100100607066319cccefa00031803b00019010be0dc000b058102001800060c33198cc6fa00031005b000190101e0dc000b038181803000060c33198cc6fa00031803b000190115e0dc000b058100c06000060c33198cc6fa00031005f000190101e0dc000403818060c0fe060363398ccefa00031803b00019010be0dc000b0581003180060fc3c1dfde77fa00031005b000110101e0dc00030381801bf200031803b000110115e0dc00030581000ef200031005f000110101e0dc000303818004f200031803b0000f010be0dc00010581f000031005b000100101e0dc0002038180f100031803b0000f0115e0dc00010581f000031005f000100101e0dc0002038180f100031803b0000f010be0dc00010581f000031005b0001b0301e03f90e700011003fe000038fe0002038180f100031803b0002d0415e0041001fe000020fd000002fe0002400008f9000308001001fe00074400000805810004f200031005f000240301e00410f8000002fe000040f500011001fe0007440000080381800af200031803b0003a2d0be004178303e000607c001f000fc3e209f800182f0007c00208f89c181f178103e000407c5e3f0581001100001cfd0000f0fa00031005b0003a2d01e0041841041000208200008002041110400008308000200208046208009841041000408261080381802080000cfd000030fa00031803b0003a2d15e00410410400002080000080020410a0400008208000200110044208009041041001f08241080581004040000cfd000030fa00031005f0003b3201e004104103e000207c001f800207f040400008208007e00110fc40081f904107f000408241080381808020060dc3c7bcf030fa00031803b0003b320be00410410010002002002080020400a04000082080082000a1044008209041040000408241080581010010060e6663199830fa00031005b0003b3201e00410410410002082002180022401104400082080086000a10c4008219841040000408241088381820018000c6c331b0c30fa00031803b0003b3215e0041047c3e000f87c001e8001c3e20838003e208007a00040f4403e1e9787c3e000407c41070581018030000c6ff1b3fc30fa00031005f000190101e0dc000b038180c060000c6c01b30030fa00031803b00019010be0dc000b05810060c0060e6670e19c30fa00031005b000190101e0dc000b0381803180061dc3e0e0f8fcfa00031803b000110115e0dc00030581001bf200031005f000110101e0dc00030381800ef200031803b00011010be0dc000305810004f200031005b000100101e0dc0002038180f100031803b0000f0115e0dc00010581f000031005f000100101e0dc0002038180f100031803b0000f010be0dc00010581f000031005b000100101e0dc0002038180f100031803b0000f0115e0dc00010581f000031005f0000f0101e0dc00010381f0ff03f803b0000f010be0dc00010581f055035005b0000e0101e0dc00010380ef000203b0000e0115e0dc00010580ef000205f0000e0101e0dc00010380ef000203b0000e010be0dc00010580ef000205b0000e0101e0dc00010380ef000203b0000e0115e0dc00010580ef000205f0000e0101e0dc00010380ef000203b0000e010be0dc00010580ef000205b0000e0101e0dc00010380ef000203b0000e0115e0dc00010580ef000205f0000e0101e0dc00010380ef000203b00014010be0dc00010580fb0002c00078f8000205b000140101e0dc00010380fb0002c00018f8000203b000140115e0dc00010580fb0002c00018f8000205f000180101e0dc000b03801e9f1dc001f9f9c7181ef9000203b00018010be0dc000b058033818e600318c0c61833f9000205b000190101e0dc000c038061818c67f300c0c6186180fa000203b000190115e0dc000c0580601f8c6001f0c06c187f80fa000205f000180101e0dc000b038060318c600018c06c1860f9000203b00019010be0dc000c058031b38e600318cc38183380fa000205b000180101e0dc000b03801f1dcdc003f078387e1ff9000203b000150115e0dc0004058000000cfd000030f7000205f000150101e0dc0004038000000cfd000030f7000203b00015010be0dc0004058000001efd0000f8f7000205b0000e0101e0dc00010380ef000203b0000e0115e0dc00010580ef000205f0000e0101e0dc00010380ef000203b0000e010be0dc00010580ef000205b0000f0101e0dc00010381f0ff03f803b0000f0115e0dc00010581f055035005f000100101e0dc0002038180f100031803b00098003e0150000001da01e80150000001da01e60150000001da01e600010f010be0dc00010581f000031005b000100101e0dc0002038180f100031803b0000f0115e0dc00010581f000031005f000100101e0dc0002038180f100031803b00011010be0dc000305810004f200031005b000110101e0dc00030381800ef200031803b0001b0115e0dc00030581001bfd0006018000f000000cfd00031005f0001c0101e0dc00040381803580fe00060180003000000cfd00031803b0001c010be0dc00040581006ec0fe00060180003000000cfd00031005b0001d0101e0dc000f038180df60061dc3c3f000307c1f9f80fe00031803b0001c0115e0dc000e058101bfb0060e666180003006318cfd00031005f0001c0101e0dc000e0381837fc8000c6c3181fc3006300cfd00031803b0001c010be0dc000e0581013f90000c6c318000307e1f0cfd00031005b0001c0101e0dc000e0381809f20000c6c31800030c6018cfd00031803b0001d0115e0dc000f0581004e40060c6661980030ce318cc0fe00031005f0001d0101e0dc000f0381802480061ef3c0f000fc773f0780fe00031803b00011010be0dc000305810011f200031005b000110101e0dc00030381800af200031803b000110115e0dc000305810004f200031005f000100101e0dc0002038180f100031803b0000f010be0dc00010581f000031005b000100101e0dc0002038180f100031803b0000f0115e0dc00010581f000031005f000100101e0dc0002038180f100031803b0000f010be0dc00010581f000031005b000110101e0dc000303818004f200031803b000110115e0dc00030581000af200031005f000180101e0dc000a0381801100001c000180c0f900031803b00018010be0dc000a0581002080000c000180c0f900031005b000180101e0dc000a0381804040000c000180c0f900031803b000180115e0dc000a0581008020060dce73f1f8f900031005f000180101e0dc000a0381810010060e663180c0f900031803b00018010be0dc000a0581020018000c663180c0f900031005b000180101e0dc000a0381818030000c663180c0f900031803b000180115e0dc000a058100c060000c663180c0f900031005f000180101e0dc000a03818060c0060e667198ccf900031803b00018010be0dc000a0581003180061dc3b8f078f900031005b000110101e0dc00030381801bf200031803b000110115e0dc00030581000ef200031005f000110101e0dc000303818004f200031803b0000f010be0dc00010581f000031005b000100101e0dc0002038180f100031803b0000f0115e0dc00010581f000031005f000100101e0dc0002038180f100031803b0000f010be0dc00010581f000031005b000100101e0dc0002038180f100031803b000110115e0dc000305810004f200031005f000110101e0dc00030381800af200031803b00015010be0dc000305810011fa00000efa00031005b000160101e0dc00040381802080fb000006fa00031803b000160115e0dc00040581004040fb000006fa00031005f000190101e0dc000b0381808020060ee3c73bb876fa00031803b00019010be0dc000b05810100100607066319cccefa00031005b000190101e0dc000b038182001800060c33198cc6fa00031803b000190115e0dc000b058101803000060c33198cc6fa00031005f000190101e0dc000b038180c06000060c33198cc6fa00031803b00019010be0dc000405810060c0fe060363398ccefa00031005b000190101e0dc000b0381803180060fc3c1dfde77fa00031803b000110115e0dc00030581001bf200031005f000110101e0dc00030381800ef200031803b00011010be0dc000305810004f200031005b000100101e0dc0002038180f100031803b0000f0115e0dc00010581f000031005f000100101e0dc0002038180f100031803b0000f010be0dc00010581f000031005b000100101e0dc0002038180f100031803b0000f0115e0dc00010581f000031005f000110101e0dc000303818004f200031803b00011010be0dc00030581000af200031005b000190101e0dc000303818011fb00043000001803fd00031803b0001a0115e0dc00040581002080fc00043000001803fd00031005f000160101e0dc00040381804040f9000018fc00031803b0001d010be0dc00160581008020061dc771e1f0783d3f0f1dc3b8001005b0001d0101e0dc00160381810010060e63833030cc6718030e6670001803b0001d0115e0dc00160581020018000c6306183186c318030c6630001005f0001d0101e0dc00160381818030000c63061831fec018030c6630001803b0001d010be0dc0016058100c060000c6306183180c018030c6630001005b0001d0101e0dc001603818060c0060e63033030ce6319830c6670001803b0001d0115e0dc00160581003180060dc7e1e0307c3e0f0fdef3b0001005f0001a0101e0dc00060381801b00000cfe000030fb000530001803b0001a010be0dc00060581000e00000cfe000030fb000530001005b0001b0101e0dc000a0381800400001e000001e0fc000601e0001803b0000f0115e0dc00010581f000031005f000100101e0dc0002038180f100031803b0000f010be0dc00010581f000031005b000100101e0dc0002038180f100031803b0000f0115e0dc00010581f000031005f000100101e0dc0002038180f100031803b0000f010be0dc00010581f0ff03f005b0000f0101e0dc00010380f0aa03a803b0000e0115e0dc00010580ef000205f0000e0101e0dc00010380ef000203b0000e010be0dc00010580ef000205b0000e0101e0dc00010380ef000203b0000e0115e0dc00010580ef000205f0000e0101e0dc00010380ef000203b0000e010be0dc00010580ef000205b0000d0101e0dc000003ee000203b0000c0115e0dc000005ed5501f0000d0101e0dc000002eeaa02abb0000c010be0dc000007edff01b0000c0101e0dc00000fedff01b0000c0115e0cb000501061e1170000b0101e0ca0004862e2030000c010be0cb000501061c12b0000b0101e0ca0004860c2030000c0115e0cb00050106081170000b0101eacaaa0486aaa030000b010bd5ca5504055552b00008010180c70001300009013f80c8000203f00008010080c70001100009010b80c8000202b0000a0001c9ff0480000030000a0015c9ff040000017000120201e008dbaa00a8f400060800800000300012020be015db550054f400060501000002b000120201e0acdbff00fcf400060a808000003000130315e17d7fdcff00fcf4000607510000017000120201eafcdbff00fcf400060be8800000300013030bf7fd7fdcff00fcf4000607ff000002b000120201effcdbff00fcf400060bfc8000003000130315e3fd7fdcff00fcf4000607f10000017000120201e0fcdbff00fcf400060bc0800000300013030be03d7fdcff00fcf400060701000002b000120201e00cdbff00fcf400060c0080000030000b0115f5ca550400000170000b0101eacaaa04800000300009010b80c8000202b000070001c6000130000a0015c9550465555570000cfe000040cc000420000030000a030aaaaacac9aa01b0000cfe000040cc000420000030000d031fffffdfccff04effffff00007003fc6ff01f00002c30002c300a0008fa00083ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 7.2 Implementation\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 The main view of this application has a {\f22 draw} method which calls methods like {\f22 draw-rectangle}, {\f22 draw-arc}, etc. These methods directly correspond to the CLX functions with the same name (which they call). However, they do not have a {\f22 gcontext} parameter. Instead, the slot {\f22 gcontext} of class {\f22 view} is passed to each CLX function. Therefore, changes to the {\f22 gcontext} of the view caused by the dialog boxes affect the result of the calls to {\f22 draw-rectangle} etc. In some cases, attributes of the graphics contexts are explicitly set with the macro {\f22 with-gcontext}. For example, the first text line is always in font 6x10.\par \pard \s2\qj\ri1\sb40\sa100 Each dialog box is created when it is used for the first time. Later, we just call {\f22 pop-up} for the existing box. In each callback an attribute of the {\f22 gcontext} is modified.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 7.3 Source Code\par \pard\plain \s10 \f22\fs12 ;;; -*- Mode\: LISP; Syntax\: Common-Lisp; Package\: output;Base\: 10 -*-\par \par (in-package \:GINA)\par (defginapackage \:output)\par (in-package \:output)\par (setq *sccs-id* "@(#)graphic-output.lisp\tab 1.4  1/15/92")\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class graphic-output-application\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass graphic-output-application (application)\par   (;; overrides\par    (name          \:initform "Graphic Output"          \:allocation \:class)\par    (document-type \:initform 'graphic-output-document  \:allocation \:class)\par    (signature     \:initform "output"                  \:allocation \:class)\par    (file-type     \:initform "output"                  \:allocation \:class)))\par \par (defun make-graphic-output-application ()\par   "start the graphic-output-application"\par   (make-application \:class 'graphic-output-application))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class graphic-output-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass graphic-output-document (document)\par   (;; instance-variables\par    (line-dialog \:accessor line-dialog \:initform nil)\par    (fill-dialog \:accessor fill-dialog \:initform nil)\par    (font-dialog \:accessor font-dialog \:initform nil)\par    ;; overrides\par    (shell-width  \:initform 500)\par    (shell-height \:initform 500)))\par \par (defmethod create-windows ((doc graphic-output-document))\par   "create the windows belonging to this document"\par   (with-slots (main-shell main-view) doc\par     ;; create a simple document-shell\par     (setq main-shell (make-document-shell-with-scroller doc))\par     ;; create the view\par     (setq main-view (make-graphic-output-view  main-shell doc))\par     \par     ;; add some menu commands\par     (add-menu-command (main-menu main-shell)\par \tab \tab       "GContext" "Line ..."\par \tab \tab       (make-callback #'display-line-dialog doc))\par     (add-menu-command (main-menu main-shell)\par \tab \tab       "GContext" "Fill ..."\par \tab \tab       (make-callback #'display-fill-dialog doc))\par     (add-menu-command (main-menu main-shell)\par \tab \tab       "GContext" "Font ..."\par \tab \tab       (make-callback #'display-font-dialog doc))\par \par     ;; remove unnecessary menu entries\par     (remove-menu-entry (main-menu main-shell) "File" "Open..")\par     (remove-menu-entry (main-menu main-shell) "File" "Save")\par     (remove-menu-entry (main-menu main-shell) "File" "Save as..")\par     (remove-menu-entry (main-menu main-shell) "File" "Revert")\par \par     (remove-menu-entry (main-menu main-shell) "Edit" "Undo")\par     (remove-menu-entry (main-menu main-shell) "Edit" "Redo")\par     (remove-menu-entry (main-menu main-shell) "Edit" "Replay History")\par     (remove-menu-entry (main-menu main-shell) "Edit" "History Scroller")\par \par     ))\par \par (defmethod display-line-dialog ((doc graphic-output-document) &aux column)\par   "pop-up gcontext dialog, create if necessary"\par   (with-slots (line-dialog main-view) doc\par     (when (not line-dialog)\par       (setq line-dialog (make-modeless-dialog-box "Line Attributes" \:document doc))\par       (setq column (make-row-column line-dialog))\par       ;; a scale to adjust the line width\par       (make-scale column\par \tab \tab   \:orientation \:horizontal\par \tab \tab   \:title-string "line-width"\par \tab \tab   \:minimum 0 \:maximum 10 \:value 0\par \tab \tab   \:value-changed-callback\par \tab \tab   `(lambda (new)\par \tab \tab      (setf (xlib\:gcontext-line-width ',(gcontext main-view)) new)\par \tab \tab      (force-redraw ',main-view)))\par \par       ;; radio button group for line style\par       (make-radio-button-group\par \tab column '(("\:solid" \:solid)\par \tab \tab  ("\:dash" \:dash)\par \tab \tab  ("\:double-dash" \:double-dash))\par \tab \:label-string "line-style"\par \tab \:value-changed-callback\par \tab `(lambda (new old)\par \tab    (setf (xlib\:gcontext-line-style ',(gcontext main-view)) new)\par \tab    (force-redraw ',main-view)))\par \par       \par       ;; radio button group for join-style\par       (make-radio-button-group\par \tab column '(("\:miter" \:miter)\par \tab \tab  ("\:round" \:round)\par \tab \tab  ("\:bevel" \:bevel))\par \tab \:label-string "join-style"\par \tab \:value-changed-callback\par \tab `(lambda (new old)\par \tab    (setf (xlib\:gcontext-join-style ',(gcontext main-view)) new)\par \tab    (force-redraw ',main-view)))\par \par       ;; radio button group for cap-style\par       (make-radio-button-group\par \tab column '(("\:not-last" \:not-last)\par \tab \tab  ("\:butt" \:butt)\par \tab \tab  ("\:round" \:round)\par \tab \tab  ("\:projecting" \:projecting))\par \tab \:label-string "cap-style"\par \tab \:value-changed-callback\par \tab `(lambda (new old)\par \tab    (setf (xlib\:gcontext-cap-style ',(gcontext main-view)) new)\par \tab    (force-redraw ',main-view)))\par       )\par     (pop-up line-dialog)))\par \par (defmethod display-fill-dialog ((doc graphic-output-document) &aux column)\par   "create modeless dialog box"\par   (with-slots (fill-dialog main-view) doc\par     (when (not fill-dialog)\par       (setq fill-dialog (make-modeless-dialog-box "Fill Attributes" \:document doc))\par       (setq column (make-row-column fill-dialog))\par  \par       ;; radio button group for fill style\par       (make-radio-button-group\par \tab column '(("\:solid" \:solid)\par \tab \tab  ("\:tiled" \:tiled)\par \tab \tab  ("\:opaque-stippled" \:opaque-stippled)\par \tab \tab  ("\:stippled" \:stippled))\par \tab \:label-string "fill-style"\par \tab \:value-changed-callback\par \tab `(lambda (new old)\par \tab    (setf (xlib\:gcontext-fill-style (gcontext (main-view ',doc))) new)\par \tab    (force-redraw (main-view ',doc))))\par \par       ;; radio button group for fill rule\par       (make-radio-button-group \par \tab column '(("\:even-odd" \:even-odd)\par \tab \tab  ("\:even-odd" \:winding))\par \tab \:label-string "fill-rule"\par \tab \:value-changed-callback\par \tab `(lambda (new old)\par \tab    (setf (xlib\:gcontext-fill-rule (gcontext (main-view ',doc))) new)\par \tab    (force-redraw (main-view ',doc))))\par \par \par       ;; radio button group for arc-mode\par       (make-radio-button-group\par \tab column '(("\:chord" \:chord)\par \tab \tab  ("\:pie-slice" \:pie-slice))\par \tab \:label-string "arc-mode"\par \tab \:value-changed-callback\par \tab `(lambda (new old)\par \tab    (setf (xlib\:gcontext-arc-mode (gcontext (main-view ',doc))) new)\par \tab    (force-redraw (main-view ',doc))))\par \par       ;; option-menu for drawing-function\par       (make-option-menu\par \tab column `(("boole-clr" ,boole-clr)\par \tab \tab  ("boole-set" ,boole-set)\par \tab \tab  ("boole-1" ,boole-1)\par \tab \tab  ("boole-2" ,boole-2)\par \tab \tab  ("boole-c1" ,boole-c1)\par \tab \tab  ("boole-c2" ,boole-c2)\par \tab \tab  ("boole-and" ,boole-and)\par \tab \tab  ("boole-ior" ,boole-ior)\par \tab \tab  ("boole-xor" ,boole-xor)\par \tab \tab  ("boole-eqv" ,boole-eqv)\par \tab \tab  ("boole-nand" ,boole-nand)\par \tab \tab  ("boole-nor" ,boole-nor)\par \tab \tab  ("boole-andc1" ,boole-andc1)\par \tab \tab  ("boole-andc2" ,boole-andc2)\par \tab \tab  ("boole-orc1" ,boole-orc1)\par \tab \tab  ("boole-orc2" ,boole-orc2))\par \tab \:label-string "drawing-function"\par \tab \:initial-value boole-1\par \tab \:value-changed-callback\par \tab `(lambda (new old)\par \tab    (setf (xlib\:gcontext-function (gcontext (main-view ',doc))) new)\par \tab    (force-redraw (main-view ',doc))))\par     \par       )\par     (pop-up fill-dialog)))\par \par (defmethod display-font-dialog ((doc graphic-output-document) &aux column font-list)\par   "create modeless dialog box"\par   (with-slots (font-dialog main-view) doc\par     (when (not font-dialog)\par       (setq font-dialog (make-modeless-dialog-box "Fonts" \:document doc))\par       (setq column (make-row-column font-dialog))\par  \par       ;; font menu\par       (setq font-list\par \tab     (make-scrollable-selection-list column (xlib\:list-font-names *display* "*")))\par       (setf (default-action-button font-list)\par \tab     (make-push-button column "Change Font"\par \tab \tab \tab       \:activate-callback\par \tab \tab \tab       `(lambda ()\par \tab \tab \tab \tab  (setf (xlib\:gcontext-font (gcontext (main-view ',doc)))\par \tab \tab \tab \tab        (value ',font-list))\par \tab \tab \tab \tab  (force-redraw (main-view ',doc)))))\par       )\par     (pop-up font-dialog)))\par \par '(with-application-stopped\par    (print (xlib\:list-font-names *display* "*x*")))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class graphic-output-view\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass graphic-output-view (view)\par   ()\par   (\:documentation "a view with special draw method"))\par \par (defun make-graphic-output-view (parent document)\par   (make-view parent\par \tab      \:width 600 \:height 800 \:document document\par \tab      \:backing-store t\par \tab      \:class 'graphic-output-view))\par \par (defmethod draw ((view graphic-output-view) count x y width height)\par   "draw window contents"\par   (declare (ignore x y width height))\par   (with-slots (gcontext document) view\par     (when (zerop count) ;; Ignore all but the last exposure event\par \tab \par       ;; draw some rectangles\par       ;;(draw-rectangle view x y width height &optional fill-p)\par       (draw-rectangle view 5  5 40 40 t)\par       (xlib\:with-gcontext (gcontext \:line-width 4)\par \tab (draw-rectangle view 50 5 40 40 nil))\par \par       ;; draw some arcs\par       ;;(draw-arc view x y width height angle1 angle2 &optional fill-p)\par       (draw-arc view 5  100 40 40 0 (* 2 pi) t)\par       (draw-arc view 50 100 40 40 0 (* 2 pi) nil)\par \par       (draw-arc view 100 100 40 40 0 (* 0.5 pi) t)\par       (draw-arc view 150 100 40 40 0 (* 0.5 pi) nil)\par \par       ;; draw some lines and points\par       (draw-line view 5 150 100 150)\par       (draw-lines view '(220 150 260 170 240 120 220 170) \:fill-p t)\par       (draw-points view '(1 160 4 160 9 160 16 160 25 160 36 160 49 160 64 160 81 160 100 160))\par \par       ;; draw some text in different fonts\par       (xlib\:with-gcontext (gcontext \:font "6x10")\par \tab (draw-glyphs view 5 200 "This is a text in font 6x10"))\par       (draw-glyphs view 5 230 "This is a text in a variable font")\par       )))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; main program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (register-application "output" 'graphic-output-application "output")\par '(make-graphic-output-application)\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 8. Bitmap-Editor\par \pard\plain \s7\qc\ri1\sb200\sa200\keepn \f34 {{\pict\macpict\picw426\pich428 35350000000001ac01aa1101a00082a0008e01000a0000000002d002409800360000000000c001b00000000000c001aa0000000000c001aa000102cb000cfe000080d40004020000010007002aceaa01ab000cfe000080d4000402000003000d0315555595d4550456555557000cfe000080d4000402000003000d032bffffbfd4ff04feffffeb00070002ce000103000f0316000080d6000608000200009700170302555595f4550054f3000001f35506595556555583000f032a000080d600060800020000ab001b0002f0aa01fcccfe000903f06cc000001f198c30f0aa03a0028300210316000080f30001c60cfe0009030060c000003199cc78f3000608000200089700220302555595f4550f54c6debb8f3603036de79b606019cc49f35506595556455d830021032a000080f3000ec6ccccd9bb0306ecccdf606019acccf300060800020008ab001d0002f0aa0efcccccc1b303f66cccdc006799acccf2aa00a3feaa018300210316000880f3000ec6cccccfb303066cccd80061999cfcf30006080102000897002203024ffd95f4550f54c6ccccd9b303066cccd80061999d87f35506595756455d830021032a000080f3000ec6cdccd9bb0306ecdcd86031998d86f300060800020008ab00190002f0aa0efcc6cccef603f36c6798601e998d86eeaa018300130316000080ef000030e900060800020ff897001b0302555595f4550054fd000030f8000001f355065955565555830013032a000080ef000030e900060800020000ab000f0302ffffbfd6ff06fbfffeffff830007007fceff01bf00070001ce5501010008002bcfaa02ab2b0009010340d0000203030009011780d0000203170009010340d0000203030009012b80d00002032b0009010340d0000203030009011780d0000203170009010340d0000203030009012b80d00002032b0009010340d000020303001d051780000030f0fd000201c183fd000101c0fc00010183e800020317002005034007f83030fe00097f80c183000007e000c0fd00023f8183e8000203030020052b8003180030fe00093180c0030000033000c0fd000218c003e80002032b00251d03400318f0303c0000318ec787e0000318f0dce71dc00018c787edb1f1dcec0002030300251d1780034030306600003419c1830000031998e66333800018c18306d818e6ec0002031700251d034003c03030c300003c18c1830000031b0cc6633180001f818306d818c6ec0002030300251d2b8003403030ff00003418c1830000031bfcc66331800018c18306d9f8c6ec0002032b00251d034003003030c000003198c1830000031b00c66331800018c18306db18c6ec0002030300251d1780030030306700003199c183300003319ce66733800018c18336db38e6ec0002031700251d034007c0fcfc3e00007f8ee7e1e00007e0f9dc3b9d80003f87e1eedddcdcec000203030012012b80ef00010180fa0000c0ec0002032b0012010340ef00010180fa0000c0ec000203030012011780ef00000ffa000101e0ec000203170009010340d0000203030009012b80d00002032b0009010340d0000203030009011780d0000203170009010340d0000203030009012b80d00002032b0009010340d0000203030009011780d000020317000801037fcfff0103000b002be6ff00feea000103000e0003e3000001f000040800000700110017ef00010c1ef900ed55045955555f00130003ef00013c33f900032aaaab2aeeaa01af0011002bef00010c33f900ed55045955555f00130003ef00010c03f900032aaaab2aeeaa01af00160017ef00010c03f9000357ffff7ff1ff04fbffff5f00100003ef00010c06f900002ceb0001af000f002bef00010c0cf900eb5502565f001b0003ef00010c18f900032caaab2afdaa00aff9ff00eafcaa01af00170017ef00010c30f900f955005ff9ff00f5fd5502565f00200003ef00013f3ff900032caaab2afdaa02a8199ffeff03f067ffeafcaa01af0017002be500f9550259cf9ffeff03e73ffff5fd5502565f001b0003e500032caaab2afdaa09a9c90a23864fe724186afcaa01af001b0017e50002554005fc550959c999993227f1e79335fd5502565f001c0003e6ff04fe2c8abb2afdaa09a8199999f267fc67332afcaa01af0019002be6ff00fef9550959c999998267fe277035fd5502565f00220103c0f1000015fe55fa00032c9ffb2afdaa09a9c999993267e72673eafcaa01af001f0117c0f100032aaaaaabfa00f9550959c991993227e724f335fd5502565f00220103c0f100001ffefffa00032caaab2afdaa09a819c999884ff064186afcaa01af001f012bc0f100032fffbffffa00f955005ffeff01fe7ffeff00f5fd5502565f00220103c0f100001ffefffa00032caaab2afdaa00affeff01fe7ffeff00eafcaa01af001f0117c0f100032fffbffffa00f955005ffeff01fe7ffeff00f5fd5502565f00160103c0f100001ffefffa00032dffff7fefff02feaf0012012bc0f100032fffbffffa00ebff02feff00120103c0f100001ffefffa000002eb00010700180117c0f100032fffbffffa000056fe00017806f000015f00170103c0f100001ffefffa00002efe0001cc0ef00001af0011012beae6aa0056fe0001cc1ef000015f00120103d5e75501542efe00010c16f00001af00100017e5000056fe00010c36f000015f00100003e500002efe00011826f00001af0010002be5000056fe00013066f000015f00100003e500002efe0001607ff00001af00100017e5000056fe0001c006f000015f00100003e500002efe0001fc0ff00001af000b002be5000056eb00015f000b0003e500002eeb0001af000b0017e5000056eb00015f001509030001800001e0000006ee00002fecff02fcaf0015092b3f8180000060003d06ee000057ecff02fc5f0019020318c0fe0002600067ed00032f80002afeaaf2000208af001e0c1718c78e71e06000631e1f8780f10002578000fe550056f20002045f001e0c0318c186633060006006118cc0f100062f80003ffffffef2000208af001e0c2b198183c61860003e06031860f100065780005fff7ffef20002045f001e0c031f018187f860000306061fe0f100062f80003ffffffef2000208af001d0b17180183c600600063060c18f000065780005fff7ffef20002045f001e0c03180186633860007306188ce0f100062f80003ffffffef2000208af001e0c2b3e07ee71f1f8005e1f9f87c0f100065780005fff7ffef20002045f00120003e500062f80003ffffffef2000208af00120017e500065780005fff7ffef20002045f00120003e500062f80003ffffffef2000208af000d002be5000157d5ed5502545f000c0003e500002fecaa02a8af000b0017e5000056eb00015f00100003fd55007febff01fe2eeb0001af000c002be6ff01fe56eb00015f0011010340fe000075eb5501542eeb0001af000f0117c0fe00eaff01fe56eb00015f00100503438582fc74ea00002eeb0001af0010052bc6e58284fcea000056eb00015f001005034c25828474ea00002eeb0001af00100517c8358284fcea000056eb00015f001005034805c28474ea00002eeb0001af0011052bc8054284fcea0001567fec00015f001205034805628474ea00022e3180ed0001af00150517c8052284fcea000556318f3873f0f000015f00150503480522fc74ea00052e31999b6630f00001af0014052bc8052284fcea0004563330db66ef00015f001505034805328474ea00052e3e30db63e0f00001af00150517c8751284fcea0005563330cfc030f000015f001505034855128474ea00052e31998cc630f00001af0015052bc8151284fcea00055679cf0cc7e0f000015f0010050348151a8474ea00002eeb0001af00100517cc150a84fcea000056eb00015f0010050344350a8474ea00002eeb0001af0010052bc4250e84fcea000056eb00015f001005034465068474ea00002eeb0001af00100517c3c50684fcea000056eb00015f0010010340fe000074ea00002eeb0001af0016012bc0fe0000fcea000056fe000203c0e0f100015f00150003fd550074ea00002efe00020661b0f10001af00140017fdff00fcea000056fd00016318f100015f00240003fd000034fc000503ffbffbff80fc00073ff8003ffbff802efd00016318f10001af0025002bfd00003cfc000503ffbffbff80fc00073ff8003ffbff8056fe000201c318f100015f00240003fd000034fc000503ffbffbff80fc00073ff8003ffbff802efd00014318f10001af00240017fd00003cfc000503ffbffbff80fc00073ff8003ffbff8056fd00016318f100015f00240003fd000034fc000503ffbffbff80fc00073ff8003ffbff802efd00016318f10001af0025002bfd00003cfc000503ffbffbff80fc00073ff8003ffbff8056fe00020661b0f100015f00250003fd000034fc000503ffbffbff80fc00073ff8003ffbff802efe000203c0e0f10001af001f0017fd00003cfc000503ffbffbff80fc00073ff8003ffbff8056eb00015f001f0003fd000034fc000503ffbffbff80fc00073ff8003ffbff802eeb0001af001f002bfd00003cfc000503ffbffbff80fc00073ff8003ffbff8056eb00015f00200003fd000034fc000503ffbffbff80fc00073ff8003ffbff802fecff02fcaf00100017fd00003cea000057ecff02fc5f002a0003fd000034fd00163ffbff8003ffbffbff8000003ff8003ffbff802f800001fe550050f3000208af002a002bfd00003cfd00163ffbff8003ffbffbff8000003ff8003ffbff8057800002feaa00b0f30002045f002a0003fd000034fd00163ffbff8003ffbffbff8000003ff8003ffbff802f800001feff00f0f3000208af002a0017fd00003cfd001a3ffbff8003ffbffbff8000003ff8003ffbff8057800002fffbfff0f30002045f002a0003fd000034fd00163ffbff8003ffbffbff8000003ff8003ffbff802f800001feff00f0f3000208af002a002bfd00003cfd001a3ffbff8003ffbffbff8000003ff8003ffbff8057800002fffbfff0f30002045f002a0003fd000034fd00163ffbff8003ffbffbff8000003ff8003ffbff802f800001feff00f0f3000208af002a0017fd00003cfd001a3ffbff8003ffbffbff8000003ff8003ffbff8057800002fffbfff0f30002045f002a0003fd000034fd00163ffbff8003ffbffbff8000003ff8003ffbff802f800001feff00f0f3000208af002a002bfd00003cfd001a3ffbff8003ffbffbff8000003ff8003ffbff8057800002fffbfff0f30002045f002a0003fd000034fd00163ffbff8003ffbffbff8000003ff8003ffbff802f800001feff00f0f3000208af00110017fd00003cea000157d5ed5502545f00220003fd000634000003ffbff8fc000c03ff8000003ff8003ffbff802fecaa02a8af0021002bfd00063c000003ffbff8fc000c03ff8000003ff8003ffbff8056eb00015f00210003fd000634000003ffbff8fc000c03ff8000003ff8003ffbff802eeb0001af00210017fd00063c000003ffbff8fc000c03ff8000003ff8003ffbff8056eb00015f00210003fd000634000003ffbff8fc000c03ff8000003ff8003ffbff802eeb0001af0021002bfd00063c000003ffbff8fc000c03ff8000003ff8003ffbff8056eb00015f00210003fd000634000003ffbff8fc000c03ff8000003ff8003ffbff802eeb0001af00210017fd00063c000003ffbff8fc000c03ff8000003ff8003ffbff8056eb00015f00210003fd000634000003ffbff8fc000c03ff8000003ff8003ffbff80feeb0001ff0021002bfd00063c000003ffbff8fc000c03ff8000003ff8003ffbff8002eb00010700240003fd000634000003ffbff8fc000f03ff8000003ff8003ffbff802e00000fee0001af00120017fd00003cea0003560e8003ee00015f00230003fd000534000003ff80fb000f03ffbff8003ff8003ffbff802e1b8003ee0001af0028002bfd00053c000003ff80fb001403ffbff8003ff8003ffbff8056318f030e7db3b87ef300015f00280003fd000534000003ff80fb001403ffbff8003ff8003ffbff802e3019830636d9ccc6f30001af00280017fd00053c000003ff80fb001403ffbff8003ff8003ffbff80563030c30636d98cc0f300015f00280003fd000534000003ff80fb001403ffbff8003ff8003ffbff802e3030c30636d98c7cf30001af0028002bfd00053c000003ff80fb001403ffbff8003ff8003ffbff80563030c30636d98c06f300015f00280003fd000534000003ff80fb001403ffbff8003ff8003ffbff802e1999830676d98cc6f30001af00280017fd00053c000003ff80fb000c03ffbff8003ff8003ffbff8056fe0f04c3bedfdefcf300015f00200003fd000534000003ff80fb000c03ffbff8003ff8003ffbff802eeb0001af0020002bfd00053c000003ff80fb000c03ffbff8003ff8003ffbff8056eb00015f00200003fd000534000003ff80fb000c03ffbff8003ff8003ffbff802eeb0001af000f0017fd00003cea000056eb00015f001b0003fd000534000003ff80f600073ff8003ffbffbe2eeb0001af001b002bfd00053c000003ff80f600073ff8003ffbffbe56eb00015f001b0003fd000534000003ff80f600073ff8003ffbffbe2eeb0001af0098003600c00000018001b000c00000018001aa00c00000018001aa00011b0017fd00053c000003ff80f600073ff8003ffbffbe54eb00015f001e0003fd000534000003ff80f6000a3ff8003ffbffbe2aaaab2aeeaa01af001d002bfd00053c000003ff80f600063ff8003ffbffbeed55045955555f001e0003fd000534000003ff80f6000a3ff8003ffbffbe2aaaab2aeeaa01af001d0017fd00053c000003ff80f600063ff8003ffbffbeed55045955555f00210003fd000534000003ff80f6000a3ff8003ffbffbe7fffff7ff1ff00fbfeff000019002bfd00053c000003ff80f600063ff8003ffbffbee9ff00002a0003fd000534000003ff80f600073ff8003ffbffbff8fc000503ff8003ff80fc00073ff80000010103000d0017fd00003cd50003030217002a0003fd000534000003ff80f600073ff8003ff8003ff8fc000503ff8003ff80fc00073ff80000010103002a002bfd00053c000003ff80f600073ff8003ff8003ff8fc000503ff8003ff80fc00073ff8000003022b002a0003fd000534000003ff80f600073ff8003ff8003ff8fc000503ff8003ff80fc00073ff80000010103002a0017fd00053c000003ff80f600073ff8003ff8003ff8fc000503ff8003ff80fc00073ff80000030217002a0003fd000534000003ff80f600073ff8003ff8003ff8fc000503ff8003ff80fc00073ff80000010103002a002bfd00053c000003ff80f600073ff8003ff8003ff8fc000503ff8003ff80fc00073ff8000003022b002a0003fd000534000003ff80f600073ff8003ff8003ff8fc000503ff8003ff80fc00073ff80000010103002a0017fd00053c000003ff80f600073ff8003ff8003ff8fc000503ff8003ff80fc00073ff80000030217002a0003fd000534000003ff80f600073ff8003ff8003ff8fc000503ff8003ff80fc00073ff80000010103002a002bfd00053c000003ff80f600073ff8003ff8003ff8fc000503ff8003ff80fc00073ff8000003022b002a0003fd000534000003ff80f600073ff8003ff8003ff8fc000503ff8003ff80fc00073ff80000010103000d0017fd00003cd50003030217002c0003fd000534000003ff80f600093ff8003ff8003ffbff80fe000503ff8003ff80fc00073ff80000010103002c002bfd00053c000003ff80f600093ff8003ff8003ffbff80fe000503ff8003ff80fc00073ff8000003022b002c0003fd000534000003ff80f600093ff8003ff8003ffbff80fe000503ff8003ff80fc00073ff80000010103002c0017fd00053c000003ff80f600093ff8003ff8003ffbff80fe000503ff8003ff80fc00073ff80000030217002c0003fd000534000003ff80f600093ff8003ff8003ffbff80fe000503ff8003ff80fc00073ff80000010103002c002bfd00053c000003ff80f600093ff8003ff8003ffbff80fe000503ff8003ff80fc00073ff8000003022b002c0003fd000534000003ff80f600093ff8003ff8003ffbff80fe000503ff8003ff80fc00073ff80000010103002c0017fd00053c000003ff80f600093ff8003ff8003ffbff80fe000503ff8003ff80fc00073ff80000030217002c0003fd000534000003ff80f600093ff8003ff8003ffbff80fe000503ff8003ff80fc00073ff80000010103002c002bfd00053c000003ff80f600093ff8003ff8003ffbff80fe000503ff8003ff80fc00073ff8000003022b002c0003fd000534000003ff80f600093ff8003ff8003ffbff80fe000503ff8003ff80fc00073ff80000010103000d0017fd00003cd50003030217002c0003fd000534000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000010103002c002bfd00053c000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff8000003022b002c0003fd000534000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000010103002c0017fd00053c000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000030217002c0003fd000534000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000010103002c002bfd00053c000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff8000003022b002c0003fd000534000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000010103002c0017fd00053c000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000030217002c0003fd000534000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000010103002c002bfd00053c000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff8000003022b002c0003fd000534000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000010103000d0017fd00003cd50003030217002e0003fd000534000003ff80f600093ff8003ff8000003ff80fe001203ff8003ffbffbffbffbffbff80000010103002e002bfd00053c000003ff80f600093ff8003ff8000003ff80fe001203ff8003ffbffbffbffbffbff8000003022b002e0003fd000534000003ff80f600093ff8003ff8000003ff80fe001203ff8003ffbffbffbffbffbff80000010103002e0017fd00053c000003ff80f600093ff8003ff8000003ff80fe001203ff8003ffbffbffbffbffbff80000030217002e0003fd000534000003ff80f600093ff8003ff8000003ff80fe001203ff8003ffbffbffbffbffbff80000010103002e002bfd00053c000003ff80f600093ff8003ff8000003ff80fe001203ff8003ffbffbffbffbffbff8000003022b002e0003fd000534000003ff80f600093ff8003ff8000003ff80fe001203ff8003ffbffbffbffbffbff80000010103002e0017fd00053c000003ff80f600093ff8003ff8000003ff80fe001203ff8003ffbffbffbffbffbff80000030217002e0003fd000534000003ff80f600093ff8003ff8000003ff80fe001203ff8003ffbffbffbffbffbff80000010103002e002bfd00053c000003ff80f600093ff8003ff8000003ff80fe001203ff8003ffbffbffbffbffbff8000003022b002e0003fd000534000003ff80f600093ff8003ff8000003ff80fe001203ff8003ffbffbffbffbffbff80000010103000d0017fd00003cd50003030217002c0003fd000534000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000010103002c002bfd00053c000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff8000003022b002c0003fd000534000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000010103002c0017fd00053c000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000030217002c0003fd000534000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000010103002c002bfd00053c000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff8000003022b002c0003fd000534000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000010103002c0017fd00053c000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000030217002c0003fd000534000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000010103002c002bfd00053c000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff8000003022b002c0003fd000534000003ff80f600093ff8003ff8000003ff80fe000503ff8003ff80fc00073ff80000010103000d0017fd00003cd50003030217002c0003fd000534000003ff80f600123ff8003ff8000003ffbff8000003ff8003ff80fc00073ff80000010103002c002bfd00053c000003ff80f600123ff8003ff8000003ffbff8000003ff8003ff80fc00073ff8000003022b002c0003fd000534000003ff80f600123ff8003ff8000003ffbff8000003ff8003ff80fc00073ff80000010103002c0017fd00053c000003ff80f600123ff8003ff8000003ffbff8000003ff8003ff80fc00073ff80000030217002c0003fd000534000003ff80f600123ff8003ff8000003ffbff8000003ff8003ff80fc00073ff80000010103002c002bfd00053c000003ff80f600123ff8003ff8000003ffbff8000003ff8003ff80fc00073ff8000003022b002c0003fd000534000003ff80f600123ff8003ff8000003ffbff8000003ff8003ff80fc00073ff80000010103002c0017fd00053c000003ff80f600123ff8003ff8000003ffbff8000003ff8003ff80fc00073ff80000030217002c0003fd000534000003ff80f600123ff8003ff8000003ffbff8000003ff8003ff80fc00073ff80000010103002c002bfd00053c000003ff80f600123ff8003ff8000003ffbff8000003ff8003ff80fc00073ff8000003022b002c0003fd000534000003ff80f600123ff8003ff8000003ffbff8000003ff8003ff80fc00073ff80000010103000d0017fd00003cd5000303021700310003fd000534000003ff80fc000a3ffbffbff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff800000101030031002bfd00053c000003ff80fc000a3ffbffbff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000003022b00310003fd000534000003ff80fc000a3ffbffbff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000001010300310017fd00053c000003ff80fc000a3ffbffbff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000003021700310003fd000534000003ff80fc000a3ffbffbff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff800000101030031002bfd00053c000003ff80fc000a3ffbffbff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000003022b00310003fd000534000003ff80fc000a3ffbffbff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000001010300310017fd00053c000003ff80fc000a3ffbffbff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000003021700310003fd000534000003ff80fc000a3ffbffbff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff800000101030031002bfd00053c000003ff80fc000a3ffbffbff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000003022b00310003fd000534000003ff80fc000a3ffbffbff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff80000010103000d0017fd00003cd5000303021700310003fd000534000003ff80fc000a3ff8003ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff800000101030031002bfd00053c000003ff80fc000a3ff8003ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000003022b00310003fd000534000003ff80fc000a3ff8003ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000001010300310017fd00053c000003ff80fc000a3ff8003ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000003021700310003fd000534000003ff80fc000a3ff8003ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff800000101030031002bfd00053c000003ff80fc000a3ff8003ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000003022b00310003fd000534000003ff80fc000a3ff8003ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000001010300310017fd00053c000003ff80fc000a3ff8003ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000003021700310003fd000534000003ff80fc000a3ff8003ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff800000101030031002bfd00053c000003ff80fc000a3ff8003ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000003022b00310003fd000534000003ff80fc000a3ff8003ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff80000010103000d0017fd00003cd50003030217002e0003fd000534000003ff80f900073ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff80000010103002e002bfd00053c000003ff80f900073ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000003022b002e0003fd000534000003ff80f900073ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff80000010103002e0017fd00053c000003ff80f900073ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff80000030217002e0003fd000534000003ff80f900073ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff80000010103002e002bfd00053c000003ff80f900073ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000003022b002e0003fd000534000003ff80f900073ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff80000010103002e0017fd00053c000003ff80f900073ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff80000030217002e0003fd000534000003ff80f900073ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff80000010103002e002bfd00053c000003ff80f900073ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff8000003022b002e0003fd000534000003ff80f900073ff8003ff8003ff8fd00093ff8000003ff8003ff80fc00073ff80000010103000d0017fd00003cd50003030217002e0003fd000534000003ff80f900073ff8003ff8003ff8fd00093ffbff8003ff8003ff80fc00073ff80000010103002e002bfd00053c000003ff80f900073ff8003ff8003ff8fd00093ffbff8003ff8003ff80fc00073ff8000003022b002e0003fd000534000003ff80f900073ff8003ff8003ff8fd00093ffbff8003ff8003ff80fc00073ff80000010103002e0017fd00053c000003ff80f900073ff8003ff8003ff8fd00093ffbff8003ff8003ff80fc00073ff80000030217002e0003fd000534000003ff80f900073ff8003ff8003ff8fd00093ffbff8003ff8003ff80fc00073ff80000010103002e002bfd00053c000003ff80f900073ff8003ff8003ff8fd00093ffbff8003ff8003ff80fc00073ff8000003022b002e0003fd000534000003ff80f900073ff8003ff8003ff8fd00093ffbff8003ff8003ff80fc00073ff80000010103002e0017fd00053c000003ff80f900073ff8003ff8003ff8fd00093ffbff8003ff8003ff80fc00073ff80000030217002e0003fd000534000003ff80f900073ff8003ff8003ff8fd00093ffbff8003ff8003ff80fc00073ff80000010103002e002bfd00053c000003ff80f900073ff8003ff8003ff8fd00093ffbff8003ff8003ff80fc00073ff8000003022b002e0003fd000534000003ff80f900073ff8003ff8003ff8fd00093ffbff8003ff8003ff80fc00073ff80000010103000d0017fd00003cd50003030217002e0003fd000634000003ffbff8fa00073ff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000010103002e002bfd00063c000003ffbff8fa00073ff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff8000003022b002e0003fd000634000003ffbff8fa00073ff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000010103002e0017fd00063c000003ffbff8fa00073ff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000030217002e0003fd000634000003ffbff8fa00073ff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000010103002e002bfd00063c000003ffbff8fa00073ff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff8000003022b002e0003fd000634000003ffbff8fa00073ff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000010103002e0017fd00063c000003ffbff8fa00073ff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000030217002e0003fd000634000003ffbff8fa00073ff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000010103002e002bfd00063c000003ffbff8fa00073ff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff8000003022b002e0003fd000634000003ffbff8fa00073ff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000010103000d0017fd00003cd50003030217002f0003fd000034fd00013ff8fc000903ffbff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000010103002f002bfd00003cfd00013ff8fc000903ffbff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff8000003022b002f0003fd000034fd00013ff8fc000903ffbff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000010103002f0017fd00003cfd00013ff8fc000903ffbff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000030217002f0003fd000034fd00013ff8fc000903ffbff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000010103002f002bfd00003cfd00013ff8fc000903ffbff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff8000003022b002f0003fd000034fd00013ff8fc000903ffbff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000010103002f0017fd00003cfd00013ff8fc000903ffbff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000030217002f0003fd000034fd00013ff8fc000903ffbff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000010103002f002bfd00003cfd00013ff8fc000903ffbff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff8000003022b002f0003fd000034fd00013ff8fc000903ffbff8003ff8003ff8fc000803ff8003ff8003ff80fc00073ff80000010103000d0017fd00003cd50003030217002f0003fd000034fd00013ff8fc000903ff8000003ff8003ff8fc000803ffbffbff8003ff80fc00073ff80000010103002f002bfd00003cfd00013ff8fc000903ff8000003ff8003ff8fc000803ffbffbff8003ff80fc00073ff8000003022b002f0003fd000034fd00013ff8fc000903ff8000003ff8003ff8fc000803ffbffbff8003ff80fc00073ff80000010103002f0017fd00003cfd00013ff8fc000903ff8000003ff8003ff8fc000803ffbffbff8003ff80fc00073ff80000030217002f0003fd000034fd00013ff8fc000903ff8000003ff8003ff8fc000803ffbffbff8003ff80fc00073ff80000010103002f002bfd00003cfd00013ff8fc000903ff8000003ff8003ff8fc000803ffbffbff8003ff80fc00073ff8000003022b002f0003fd000034fd00013ff8fc000903ff8000003ff8003ff8fc000803ffbffbff8003ff80fc00073ff80000010103002f0017fd00003cfd00013ff8fc000903ff8000003ff8003ff8fc000803ffbffbff8003ff80fc00073ff80000030217002f0003fd000034fd00013ff8fc000903ff8000003ff8003ff8fc000803ffbffbff8003ff80fc00073ff80000010103002f002bfd00003cfd00013ff8fc000903ff8000003ff8003ff8fc000803ffbffbff8003ff80fc00073ff8000003022b002f0003fd000034fd00013ff8fc000903ff8000003ff8003ff8fc000803ffbffbff8003ff80fc00073ff80000010103000d0017fd00003cd50003030217002e0003fd000034fd00013ff8fd000a3ffbff8000003ff8003ff8fa00063ffbff8003ff80fc00073ff80000010103002e002bfd00003cfd00013ff8fd000a3ffbff8000003ff8003ff8fa00063ffbff8003ff80fc00073ff8000003022b002e0003fd000034fd00013ff8fd000a3ffbff8000003ff8003ff8fa00063ffbff8003ff80fc00073ff80000010103002e0017fd00003cfd00013ff8fd000a3ffbff8000003ff8003ff8fa00063ffbff8003ff80fc00073ff80000030217002e0003fd000034fd00013ff8fd000a3ffbff8000003ff8003ff8fa00063ffbff8003ff80fc00073ff80000010103002e002bfd00003cfd00013ff8fd000a3ffbff8000003ff8003ff8fa00063ffbff8003ff80fc00073ff8000003022b002e0003fd000034fd00013ff8fd000a3ffbff8000003ff8003ff8fa00063ffbff8003ff80fc00073ff80000010103002e0017fd00003cfd00013ff8fd000a3ffbff8000003ff8003ff8fa00063ffbff8003ff80fc00073ff80000030217002e0003fd000034fd00013ff8fd000a3ffbff8000003ff8003ff8fa00063ffbff8003ff80fc00073ff80000010103002e002bfd00003cfd00013ff8fd000a3ffbff8000003ff8003ff8fa00063ffbff8003ff80fc00073ff8000003022b002e0003fd000034fd00013ff8fd000a3ffbff8000003ff8003ff8fa00063ffbff8003ff80fc00073ff80000010103000d0017fd00003cd50003030217002d0003fd000034fc000603ffbffbffbff8fd00043ff8003ff8fa00063ffbff8003ff80fc00073ff80000010103002d002bfd00003cfc000603ffbffbffbff8fd00043ff8003ff8fa00063ffbff8003ff80fc00073ff8000003022b002d0003fd000034fc000603ffbffbffbff8fd00043ff8003ff8fa00063ffbff8003ff80fc00073ff80000010103002d0017fd00003cfc000603ffbffbffbff8fd00043ff8003ff8fa00063ffbff8003ff80fc00073ff80000030217002d0003fd000034fc000603ffbffbffbff8fd00043ff8003ff8fa00063ffbff8003ff80fc00073ff80000010103002d002bfd00003cfc000603ffbffbffbff8fd00043ff8003ff8fa00063ffbff8003ff80fc00073ff8000003022b002d0003fd000034fc000603ffbffbffbff8fd00043ff8003ff8fa00063ffbff8003ff80fc00073ff80000010103002d0017fd00003cfc000603ffbffbffbff8fd00043ff8003ff8fa00063ffbff8003ff80fc00073ff80000030217002d0003fd000034fc000603ffbffbffbff8fd00043ff8003ff8fa00063ffbff8003ff80fc00073ff80000010103002d002bfd00003cfc000603ffbffbffbff8fd00043ff8003ff8fa00063ffbff8003ff80fc00073ff8000003022b002d0003fd000034fc000603ffbffbffbff8fd00043ff8003ff8fa00063ffbff8003ff80fc00073ff80000010103000d0017fd00003cd50003030217000d0003fd000034d50003010103000d002bfd00003cd5000303022b000d0003fd000034d50003010103009800360180000001ac01b00180000001ac01aa0180000001ac01aa00010d0017fd00003cd50003030217000d0003fd000034d50003010103000d002bfd00003cd5000303022b000d0003fd000034d50003010103000d0017fd00003cd50003030217000d0003fd000034d50003010103000d002bfd00003cd5000303022b000d0003fd000034d50003010103000d0017fd00003cd50003030217000d0003fd000034d50003010103000d002bfd00003cd5000303022b000d0003fd000034d50003010103000d0017fd00003cd50003030217000d0003fd000034d50003010103000d002bfd00003cd5000303022b000d0003fd000034d50003010103000d007ffd00003cd5000303023f000c0001fd000034d500fe0100000d002bfd00003cd5000303022b000d0003fd000034d50003010103000d0017fd00003cd50003030217000c0003fd000035d455020103000c002bfd00003fd4ff02022b000c0003fd000030d400020103000c0017fd000030d400020217000c0003fd000030d400020103000c002bfd000030d40002022b000c0003fd000030d400020103000c0017fd000030d400020217000c0003fd000030d400020103000c002bfd000030d40002022b000c0003fd000030d400020103000b0017fd00003ad3aa0117000b0003fd000035d35501030007002bce00012b00070002ce000103000d0315555595d4550456555557000cfe000080d40004020000030007002aceaa01ab000cfe000080d4000402000003000d033fffffbfd4ff00fefeff000006007fcdff000002cb0002cb00a0008fa00083ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 8.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 Bitmaps can be edited by holding down and moving one of the three mouse buttons. Using the left mouse button, the user can set pixels. The middle button is used to clear pixels and the right button is used to toggle pixels. On a one-button mouse, the shift and control-shift keys are used instead of the middle and right button. Full undo/redo is possible for edit operations.\par There are two views showing the bitmap. In the small view the bitmap is shown in original size and in the big view each pixel is shown as a large square. The size of these squares can be modified with the scale right below the main menu. The mouse can be pressed in any of the views and changes are immediately reflected in both views. \par The number of rows and columns of the bitmap can be modified using two scales in a modeless dialog box. To display the dialog box the menu entry {\f22 Set} {\f22 Size} is selected. The size of a bitmap can be temporarily modified without losing the contents of the bitmap. The menu entry {\f22 Adapt} {\f22 Shell} {\f22 Size} resizes the shell, so that the full bitmap is shown and no scrolling is necessary.\par \pard \s2\qj\ri1\sb40\sa100 Using the menu entries {\f22 Clear All} and {\f22 Set All} all pixels can be cleared or set.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 8.2 Implementation\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 The class {\f22 bitmap-document} contains the internal representation of a bitmap. The bitmap is stored as a list of the coordinates of the black pixels. There are methods to set, clear, and toggle single pixels which change the internal representation and also reflect the changes in the two views. \par When a bitmap is written to a file, only the the coordinates which lie within the current size of the bitmap are written. The external representation is a list of pairs. When a document is read from a file, the new size of the bitmap is indicated in the scale widgets and the views are resized. \par \pard \s2\qj\ri1\sb40\sa100 The method {\f22 change-params} is called when any of the three scales is operated. It resizes (and thus redraws) the two views.\par \pard \s2\qj\ri1\sb40\sa100 The dialog box is created when it is used for the first time. Later, we just call {\f22 pop-up} for the existing box. The method {\f22 adapt-shell-size} corresponds to the main menu entry. It resizes the main shell, so that the full bitmap is shown. It might not work precisely if different fonts are used.\par \pard \s2\qj\ri1\sb40\sa100 The class {\f22 bitmap-view} is used for both views of the application. The mini view does not have a gap between the individual pixels. In method {\f22 button-press} a command object is created, depending on which button is pressed. GINA passes a virtual button code to {\f22 button-press}. Therefore, the application does not have to care about one, two, and three button mice.\par \pard \s2\qj\ri1\sb40\sa100 There are methods to set or clear individual pixels. The method {\f22 draw} just sets all black pixels in a loop.\par \pard \s2\qj\ri1\sb40\sa100 The three mouse commands for pixel editing are quite similar. They are created when one of the mouse buttons goes down in any of the views. There is no feedback drawn, instead pixels are directly modified in method {\f22 track-mouse}, which is called each time the mouse moves. In this method x and y of the mouse position are translated into coordinates for the bitmap. Next, it is checked if a new square is under the mouse, or if the mouse has been moved inside a square representing a pixel. Only if at least one pixel is changed in a command, the slot {\f22 call-doit} is set, so that it is really submitted. The method {\f22 doit} remains empty because everything is already done in {\f22 track-mouse}. In {\f22 undoit} and {\f22 redoit} the pixels collected by {\f22 track-mouse} are changed again.\par \pard \s2\qj\ri1\sb40\sa100 Finally, there is the class {\f22 clear-all-command}. Note that this class is used for both the {\f22 Set} {\f22 All} and {\f22 Clear} {\f22 All} menu entries. Therefore, the {\f22 name} slot has instance allocation, i.e. it may have a different value in two instances. To make the command undoable, the current bitmap is stored in each command object and can later be redisplayed. \par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 8.3 Limitations and Extensions\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 For a more efficient implementation an array should be used to hold the bitmap. Furthermore, it should be possible to write out a bitmap in the C language format used for Motif icons, buttons, etc.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 8.4 Source Code\par \pard\plain \s10 \f22\fs12 ;;;-*-Mode\:LISP;Syntax\: Common-Lisp;Package\: bitedit;Base\:10-*-\par \par (in-package \:GINA)\par (defginapackage \:bitedit)\par (in-package \:bitedit)\par (setq *sccs-id* "@(#)bitmap-editor.lisp\tab 1.5  1/17/92")\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;; class bitmap-editor\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass bitmap-editor (application)\par   (;; overrides\par    (name                 \:initform "Bitmap Editor"  \:allocation \:class)\par    (document-type        \:initform 'bitmap-document \:allocation \:class)\par    (signature            \:initform "bitedit"        \:allocation \:class)\par    (file-type            \:initform "bitmap"         \:allocation \:class))\par   (\:documentation "a simple bitmap editor application"))\par \par (defun make-bitmap-editor ()\par   "start the bitmap-application"\par   (make-application \:class 'bitmap-editor))\par \par '(make-bitmap-editor)\par \tab \tab     \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;; class bitmap-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass bitmap-document (document)\par   ((bitmap     \:accessor bitmap     \:initform nil)\par    (no-rows    \:accessor no-rows    \:initform 32)\par    (no-columns \:accessor no-columns \:initform 32)\par    \par    (mini-view     \:accessor mini-view)\par    (factor-scale  \:accessor factor-scale)\par    (params-box    \:accessor params-box    \:initform nil)\par    (rows-scale    \:accessor rows-scale    \:initform nil)\par    (columns-scale \:accessor columns-scale \:initform nil)\par    \par    (shell-width  \:initform 370)\par    (shell-height \:initform 420)))\par \par ;; forward declaration \par (defclass bitmap-view (view)\par   ((factor  \:accessor factor  \:initarg \:factor\par \tab     \:documentation "size of a single pixel on the screen")\par    (gap     \:accessor gap     \:initarg \:gap\par \tab     \:documentation "white space between pixels")))\par \par (defmethod create-windows ((doc bitmap-document)\par \tab \tab \tab    &aux form scroller frame mini-frame)\par   "create the windows belonging to this document"\par   (with-slots (main-shell main-view mini-view factor-scale no-columns no-rows) doc\par     (setq main-shell (make-document-shell doc))\par     (setq form       (make-form main-shell))\par     (setq scroller   (make-scroller form))\par     (setq frame      (make-frame scroller \:shadow-type \:etched-out))\par     (setq main-view (make-bitmap-view frame doc\par \tab \tab \tab \tab       \:factor 10\par \tab \tab \tab \tab       \:gap 1\par \tab \tab \tab \tab       \:columns no-columns\par \tab \tab \tab \tab       \:rows no-rows))\par     (setq mini-frame (make-frame form \:shadow-type \:etched-out))\par     (setq mini-view (make-bitmap-view mini-frame doc\par \tab \tab \tab \tab       \:factor 1\par \tab \tab \tab \tab       \:gap 0\par \tab \tab \tab \tab       \:columns no-columns\par \tab \tab \tab \tab       \:rows no-rows))\par        \par     (setq factor-scale\par \tab   (make-scale form\par \tab \tab       \:orientation \:horizontal\par \tab \tab       \:title-string "Pixel Size"\par \tab \tab       \:value (factor (main-view doc))\par \tab \tab       \:minimum 2\par \tab \tab       \:maximum 30\par \tab \tab       \:value-changed-callback\par \tab \tab       (make-callback #'change-params doc \:factor)))\par \par     (define-form-constraint factor-scale\par \tab \tab \tab     \:top-attachment \:form\par \tab \tab \tab     \:left-attachment \:form\par \tab \tab \tab     \:right-attachment \:form)\par     (define-form-constraint mini-frame\par \tab \tab \tab     \:top-attachment \:widget \:top-widget factor-scale\par \tab \tab \tab     \:left-attachment \:form)\par     (define-form-constraint scroller\par \tab \tab \tab     \:left-attachment \:widget \:left-widget mini-frame\par \tab \tab \tab     \:top-attachment \:widget \:top-widget factor-scale\par \tab \tab \tab     \:right-attachment \:form\par \tab \tab \tab     \:bottom-attachment \:form)\par     \par     ;; add some menu commands\par     (add-menu-command (main-menu main-shell)\par \tab \tab       "Edit" "Clear All" (make-callback #'make-clear-all-command doc))\par     (add-menu-command (main-menu main-shell)\par \tab \tab       "Edit" "Set All"\par \tab \tab       (make-callback #'make-clear-all-command doc \:color \:black))\par     (add-menu-command (main-menu main-shell)\par \tab \tab       "Bitmap" "Set Size ..."\par \tab \tab       (make-callback #'display-parms-box doc))\par     (add-menu-command (main-menu main-shell)\par \tab \tab       "Bitmap" "Adapt Shell Size"\par \tab \tab       (make-callback #'adapt-shell-size doc))\par     ))\par \par (defmethod pixel-on ((doc bitmap-document) x y)\par   "look up pixel value in data structure"\par   (when (member (list x y) (bitmap doc) \:test #'equal)\par     t))\par \par (defmethod set-pixel ((doc bitmap-document) x y &key (redisplay t)\par \tab \tab       &allow-other-keys\par \tab \tab       &aux coordinates)\par   "set a single pixel in the data structure and display in the view"\par   (with-slots (main-view mini-view bitmap) doc\par     (setq coordinates (list x y))\par     (setq bitmap (remove coordinates bitmap \:test #'equal))\par     (push coordinates bitmap)\par \par     (when redisplay\par       (set-pixel main-view x y)\par       (set-pixel mini-view x y))))\par \par (defmethod clear-pixel ((doc bitmap-document) x y &key (redisplay t)\par \tab \tab \tab &allow-other-keys\par \tab \tab \tab &aux coordinates)\par   "clear a single pixel in the data structure and display in the view"\par   (with-slots (main-view mini-view bitmap) doc\par     (setq coordinates (list x y))\par     (setq bitmap (remove coordinates bitmap \:test #'equal))\par     (when redisplay\par       (clear-pixel main-view x y)\par       (clear-pixel mini-view x y))))\par \tab  \par (defmethod toggle-pixel ((doc bitmap-document) x y &key (redisplay t)\par \tab \tab \tab  &aux coordinates)\par   "toggle a single pixel in the data structure and display in the view"\par   (setq coordinates (list x y))\par   (if (member coordinates (bitmap doc) \:test #'equal)\par       (clear-pixel doc x y \:redisplay redisplay)\par       (set-pixel doc x y \:redisplay redisplay)))\par \par (defmethod write-to-stream ((doc bitmap-document) stream)\par   "write the document to the specified stream"\par   (format stream "~d ~d ~d~%"\par \tab   (no-rows doc) (no-columns doc) (factor (main-view doc)))\par   (format stream "(")\par   (loop for pair in (bitmap doc)\par \tab when (and (<= (first  pair) (no-columns doc))\par \tab \tab   (<= (second pair) (no-rows doc)))\par \tab   do (prin1 pair stream))\par   (format stream ")~%"))\par \par (defmethod read-from-stream ((doc bitmap-document) stream) \par   "read the document from the specified stream"\par   (with-slots (no-rows no-columns main-view mini-view\par \tab \tab        factor-scale rows-scale columns-scale bitmap) doc\par     (setq no-rows (read stream))\par     (setq no-columns (read stream))\par     (setf (factor main-view) (read stream))\par     (setq bitmap (read stream))\par     \par     (when rows-scale\par       (setf (value rows-scale) no-rows))\par     (when columns-scale\par       (setf (value columns-scale) no-columns))\par     (setf (value factor-scale) (factor main-view))\par     (resize main-view\par \tab     (* (factor main-view) no-columns)\par \tab     (* (factor main-view) no-rows))\par     (resize (mini-view doc) no-columns no-rows)\par     ))\par \par (defmethod change-params ((doc bitmap-document)\par \tab \tab \tab   &key (no-rows (no-rows doc))\par \tab \tab \tab        (no-columns (no-columns doc))\par \tab \tab \tab        (factor (factor (main-view doc))))\par   "adapt to new layout params"\par   (setf (no-rows doc) no-rows)\par   (setf (no-columns doc) no-columns)\par   (when (not (= factor (factor (main-view doc))))\par     (setf (factor (main-view doc)) factor)\par     ;; even the parts of the view that remain visible have to be redrawn\par     (force-redraw (main-view doc))\par     (force-redraw (mini-view doc)))\par \par   ;; resize => expose-events for new areas\par   (resize (main-view doc) (* factor no-columns) (* factor no-rows))\par   (resize (mini-view doc) no-columns no-rows)\par     (resize (main-shell doc) (+ (width (main-shell doc)) 1)\par                              (height (main-shell doc)))\par     (resize (main-shell doc) (- (width (main-shell doc)) 1)\par                              (height (main-shell doc)))\par   (setf (modified doc) t))\par \par (defmethod display-parms-box ((doc bitmap-document))\par   "bring up modeless dialog to set parms"\par   (when (not (params-box doc))\par     (setf (params-box doc)\par \tab   (make-modeless-dialog-box "Bitmap Size" \:document doc\par \tab \tab \tab \tab     \:resize t\par \tab \tab \tab \tab     \:motif-resources '(\:width 250)))\par     (setf (rows-scale doc)\par \tab   (make-scale (params-box doc)\par \tab \tab       \:orientation \:horizontal \par \tab \tab       \:title-string "Rows"\par \tab \tab       \:value (no-rows doc)\par \tab \tab       \:minimum 1\par \tab \tab       \:maximum 200\par \tab \tab       \:value-changed-callback\par \tab \tab       (make-callback #'change-params doc \:no-rows)))\par     (setf (columns-scale doc)\par \tab   (make-scale (params-box doc)\par \tab \tab       \:orientation \:horizontal \par \tab \tab       \:title-string "Columns"\par \tab \tab       \:value (no-columns doc)\par \tab \tab       \:minimum 1\par \tab \tab       \:maximum 200\par \tab \tab       \:value-changed-callback\par \tab \tab       (make-callback #'change-params doc \:no-columns)))\par     (define-form-constraint (rows-scale doc)\par \tab \tab \tab     \:top-attachment \:form\par \tab \tab \tab     \:left-attachment \:form\par \tab \tab \tab     \:right-attachment \:form)\par     (define-form-constraint (columns-scale doc)\par \tab \tab \tab     \:top-attachment \:widget \:top-widget (rows-scale doc)\par \tab \tab \tab     \:left-attachment \:form\par \tab \tab \tab     \:right-attachment \:form))\par   (pop-up (params-box doc)))\par \par (defmethod adapt-shell-size ((doc bitmap-document))\par   "resize shell so that complete bitmap is shown"\par   (with-slots (no-columns no-rows main-shell main-view) doc\par     (resize main-shell\par \tab     (max 270 (+ 20 no-columns (* no-columns (factor main-view))))\par \tab     (+ 100 (* no-rows (factor main-view))))))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;; class bitmap-view\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par '(defclass bitmap-view (view)\par   ((factor  \:accessor factor  \:initarg \:factor\par \tab     \:documentation "size of a single pixel on the screen")\par    (gap     \:accessor gap     \:initarg \:gap\par \tab     \:documentation "white space between pixels")))\par \par (defun make-bitmap-view (parent doc &key (factor 1) (rows 10) (columns 10) (gap 0))\par   (make-view parent\par \tab      \:width  (* factor columns)\par \tab      \:height (* factor rows)\par \tab      \:document doc\par \tab      \:backing-store t\par \tab      \:class 'bitmap-view\par \tab      \:initargs (list \:factor factor \:gap gap)))\par \par (defmethod button-press ((view bitmap-view) code repetition x y)\par   "react to button-press event in the window"\par   (declare (ignore repetition))\par   (case code ;; which button      \par     (\:select (make-set-pixel-command    (document view) view x y))\par     (\:extend (make-clear-pixel-command  (document view) view x y))\par     (\:menu (make-toggle-pixel-command (document view) view x y)))\par   )\par \par (defmethod set-pixel ((view bitmap-view) x y &key &allow-other-keys)\par   "set a single pixel"\par   (with-slots (factor gap) view\par     (draw-rectangle view (* (1- x) factor) (* (1- y) factor)\par \tab \tab     (- factor gap) (- factor gap) t)))\par \par (defmethod clear-pixel ((view bitmap-view) x y &key &allow-other-keys)\par   "clear a single pixel"\par   (with-slots (factor) view \par     (clear-area view (* (1- x) factor) (* (1- y) factor)\par \tab \tab factor factor)))\par \par (defmethod draw ((view bitmap-view) count x y width height)\par   "draw bits into view"\par   (declare (ignore x y width height))\par   (when (zerop count)\par     (loop for (x y) in (bitmap (document view))\par \tab   do (set-pixel view x y))))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;; mouse-commands\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par ;; class set-pixel-command ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass set-pixel-command (mouse-down-command)\par   (;; overrides\par    (name       \:initform "Set Pixel" \:allocation \:class)\par    (call-doit  \:initform nil)\par    ;; new slots\par    (last-coordinates \:accessor last-coordinates \:initform nil)\par    (coordinate-list  \:accessor coordinate-list  \:initform nil)))\par \par (defun make-set-pixel-command (document view x y)\par   "create command object storing all touched x/y coordinates"\par   (make-mouse-down-command document view x y\par \tab \tab \tab    \:class 'set-pixel-command\par \tab \tab \tab    \:cursor \:hand))\par \par (defmethod draw-feedback ((cmd set-pixel-command) x y &key clear)\par   "no feedback"\par   (declare (ignore x y clear)))\par \par (defmethod track-mouse ((cmd set-pixel-command) x y\par \tab \tab \tab &key (started nil) (finished nil)\par \tab \tab \tab &aux pixel-x pixel-y coordinates)\par   "process each touched pixel"\par   (declare (ignore started finished))\par   (with-slots (last-coordinates coordinate-list document call-doit view) cmd\par     (setq pixel-x (ceiling (/ x (factor view))))\par     (setq pixel-y (ceiling (/ y (factor view))))\par     (setq coordinates (list pixel-x pixel-y))\par     (when (and (not (equal coordinates last-coordinates))\par \tab        (not (pixel-on document pixel-x pixel-y)))\par       (setq call-doit t)\par       (setq last-coordinates coordinates)\par       (push coordinates coordinate-list)\par       (set-pixel document pixel-x pixel-y))\par     ))\par \par (defmethod undoit ((cmd set-pixel-command))\par   "clear all pixels again"\par   (with-slots (coordinate-list document) cmd\par     (loop for coordinates in coordinate-list\par \tab   do (clear-pixel document (first coordinates) (second coordinates)))\par     ))\par \par \par \par \par \par (defmethod redoit ((cmd set-pixel-command))\par   "set all pixels again"\par   (with-slots (coordinate-list document) cmd\par     (loop for coordinates in coordinate-list\par \tab   do (set-pixel document (first coordinates) (second coordinates)))\par     ))\par \par ;; class clear-pixel-command ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass clear-pixel-command (mouse-down-command)\par   (;; overrides\par    (name       \:initform "Clear Pixel" \:allocation \:class)\par    (call-doit  \:initform nil)\par    ;; new slots\par    (last-coordinates \:accessor last-coordinates \:initform nil)\par    (coordinate-list  \:accessor coordinate-list  \:initform nil)))\par \par (defun make-clear-pixel-command (document view x y)\par   "create command object storing all touched x/y coordinates"\par   (make-mouse-down-command document view x y\par \tab \tab \tab    \:class 'clear-pixel-command\par \tab \tab \tab    \:cursor \:hand))\par \par (defmethod draw-feedback ((cmd clear-pixel-command) x y &key clear)\par   "no feedback"\par   (declare (ignore x y clear)))\par \par (defmethod track-mouse ((cmd clear-pixel-command) x y\par \tab \tab \tab &key (started nil) (finished nil)\par \tab \tab \tab &aux pixel-x pixel-y coordinates)\par   "process each touched pixel"\par   (declare (ignore started finished))\par   (with-slots (last-coordinates coordinate-list document call-doit view) cmd\par     (setq pixel-x (ceiling (/ x (factor view))))\par     (setq pixel-y (ceiling (/ y (factor view))))\par     (setq coordinates (list pixel-x pixel-y))\par     (when (and (not (equal coordinates last-coordinates))\par \tab        (pixel-on document pixel-x pixel-y))\par       (setq call-doit t)\par       (setq last-coordinates coordinates)\par       (push coordinates coordinate-list)\par       (clear-pixel document pixel-x pixel-y))\par     ))\par \par (defmethod undoit ((cmd clear-pixel-command))\par   "set all pixels again"\par   (with-slots (coordinate-list document) cmd\par     (loop for coordinates in coordinate-list\par \tab   do (set-pixel document (first coordinates) (second coordinates)))\par     ))\par \par (defmethod redoit ((cmd clear-pixel-command))\par   "add new pixel to bitmap"\par   "clear all pixels again"\par   (with-slots (coordinate-list document) cmd\par     (loop for coordinates in coordinate-list\par \tab   do (clear-pixel document (first coordinates) (second coordinates)))\par     ))\par \par ;; class toggle-pixel-command ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass toggle-pixel-command (mouse-down-command)\par   (;; overrides\par    (name        \:initform "Toggle Pixel" \:allocation \:class)\par    ;; new slots\par    (last-coordinates \:accessor last-coordinates \:initform nil)\par    (coordinate-list  \:accessor coordinate-list  \:initform nil)))\par \par (defun make-toggle-pixel-command (document view x y)\par   "create command object storing the x/y coordinates of the mouse-click"\par   (make-mouse-down-command document view x y\par \tab \tab \tab    \:class 'toggle-pixel-command\par \tab \tab \tab    \:cursor \:hand))\par \par (defmethod draw-feedback ((cmd toggle-pixel-command) x y &key clear)\par   "no feedback"\par   (declare (ignore x y clear)))\par \par (defmethod track-mouse ((cmd toggle-pixel-command) x y\par \tab \tab \tab &key (started nil) (finished nil)\par \tab \tab \tab &aux pixel-x pixel-y coordinates)\par   "process each touched pixel"\par   (declare (ignore started finished))\par   (with-slots (last-coordinates coordinate-list document call-doit view) cmd\par     (setq pixel-x (ceiling (/ x (factor view))))\par     (setq pixel-y (ceiling (/ y (factor view))))\par     (setq coordinates (list pixel-x pixel-y))\par     (when (not (equal coordinates last-coordinates))\par       (setq last-coordinates coordinates)\par       (push coordinates coordinate-list)\par       (toggle-pixel document pixel-x pixel-y))\par     ))\par \par (defmethod undoit ((cmd toggle-pixel-command))\par   "toggle all pixels again"\par   (with-slots (coordinate-list document) cmd\par     (loop for coordinates in coordinate-list\par \tab   do (toggle-pixel document (first coordinates) (second coordinates)))\par     ))\par \par (defmethod redoit ((cmd toggle-pixel-command))\par   "toggle all pixels again"\par   (undoit cmd))\par \page ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class clear-all-command\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass clear-all-command (command)\par   (;; instance-parameters\par    (name \:initarg \:name) ;; turn class slot into an instance slot\par    (color  \:accessor color  \:initarg \:color)\par    (bitmap \:accessor bitmap \:initarg \:bitmap))\par   (\:documentation "a command to delete all pixels"))\par \par (defun make-clear-all-command (document &key (color \:white))\par   "create a new command object with appropriate parameters"\par   (make-command document\par \tab \tab \:class 'clear-all-command\par \tab \tab \:initargs `(\:bitmap ,(bitmap document)\par \tab \tab \tab     \:color ,color\par \tab \tab \tab     \:name ,(if (eq color \:white) "Clear All" "Set All"))))\par \par (defmethod doit ((cmd clear-all-command))\par   "construct coordinate list and redraw"\par   (with-slots (bitmap main-view mini-view no-rows no-columns) (document cmd) \par     (setq bitmap\par \tab   (if (eq (color cmd) \:white)\par \tab       nil\par \tab       ;; else set all to black\par \tab       (loop for x from 0 to no-columns\par \tab \tab     append\par \tab \tab       (loop for y from 0 to no-rows\par \tab \tab \tab     collect (list x y)))))\par     (force-redraw main-view)\par     (force-redraw mini-view)))\par \par (defmethod undoit ((cmd clear-all-command))\par   "reinstall old coordinate list and redraw"\par   (with-slots (bitmap main-view mini-view) (document cmd)\par     (setq bitmap (bitmap cmd))\par     (force-redraw main-view)\par     (force-redraw mini-view)))\par \par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;; main program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (register-application "bitedit" 'bitmap-editor "bitmap")\par '(make-bitmap-editor) \par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 9. Lisp-Widgets\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 9.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 This demo shows how new types of widgets can be implemented in Lisp. This is much easier than implementing new widgets in the C language. The only drawback is that the performance is worse. In our example we show how a new type of scrollbar is implemented. The slider jumps to the place where the mouse is clicked and can be dragged. While dragging, the current value is shown in the slider. When the shell is resized, the scrollbar is also resized.\par \pard\plain \s7\qc\ri1\sb200\sa200\keepn \f34 \tab {{\pict\macpict\picw157\pich268 0d2a00000000010c009d110101000a00000000010c009d98001400000000010c009f00000002010c009f00000000010c009d00000bfe000010f5000310000002060015ef5500560c030aaaaab2f5aa03b2aaaaae060015ef5500560c030aaaaab2f5aa03b2aaaaae060015ef5500560c030aaaaab2f5aa03b2aaaaae060015ef5500560c030abffff7f5ff03f7fffeae08011560f1000101560c030aaaaab2f5aa03b2aaaaae0e0315655557f7ff00e5fe5501595615050aaaaab3ff3ffeff01e7e3feff05aaaab2aaaaae1504156555543ffeff0b847ff3fffcffe5555500595615040aaaaab27ffeff0bcefff3fffcffaaaab22aaaae1513156400567c3c047fca878312181865055555d95615130aaaabb27f38d33fcae73264ccf1aaaab22aaaae1513156455567f3c333fcae732640cf8651d5555d95615130aaaffb27f3f133fc0e73264fcfe2abab22aaaae150e156555566f39933fe1e73264ccd365fe5501d95615130aaaaab00c0c307fe58181061e382aaab22aaaae140615655557fffff3fdff08e7ffffe555557fd95614060aaaaab3fffff3fdff08e7ffffaaaab2aaaaae140615655557ffffe1fdff030fffffe5fe550159560e030aaffff7f7ff05effff7fffaae07003ff0ff01fbfe0801001af1aa01a00208011575f15501515608010ab8f1000132ae08011574f10001315608010ab8f1000132ae08011574f10001315608010ab8f1000132ae08011574f10001315608010ab8f1000132ae08011574f10001315608010ab8f1000132ae15041574007c03fe00017c10fe00017804fe0001315615040ab8004041fe000640110800002404fe000132ae15041574004001fe000640100800002404fe0001315615130ab80040c10e000040f31e000024e791380032ae1513157400784111000079110800002514514400315615130ab80040411f0000411108000025f451440032ae1513157400404110000041110800002504514400315615130ab800404111000041110900002514533c0032ae151315740040e38e00007cf386000078e78d040031560a010ab8f30003440032ae0a011574f300033800315608010ab8f1000132ae08011574f10001315608010ab8f1000132ae08011574f10001315608010ab8f1000132ae08011574f10001315608010ab8f1000132ae08011577f1ff01f15608010abff1ff01f2ae0b04157ffffff0f4000101560b040abfffffe0f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abfffffe0f4000102ae0b04157ff79fd0f4000101560b040abfe77fe0f4000102ae0b04157fd6ffd0f4000101560b040abfb69fe0f4000102ae0b04157f826fd0f4000101560b040abff6efe0f4000102ae0b04157ff71fd0f4000101560b040abfffffe0f4000102ae0b04157fffffd0f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b043ffc000020f4000103fe0a04001c000010f30000020b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157c000010f4000101560b040abc000020f4000102ae0b04157d555550f4000101560b040abaaaaaa0f4000102ae08011570f10001015608010aa0f1000102ae060015ef5500560c030aaaaab2f5aa03b2aaaaae060015ef5500560c030aaaaab2f5aa03b2aaaaae060015ef5500560c030aaaaab2f5aa03b2aaaaae060015ef5500560c031ffffff7f5ff03f7fffffe06003fefff00feff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 9.2 Implementation\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 The class {\f22 selfmade-scrollbar} is a subclass of the GINA class {\f22 view}. It consists of a {\f22 view} with a {\f22 frame} around it. Therefore, the slot {\f22 group-widget-id} of the superclass widget is set to the {\f22 frame} object, so that move and resize operations as well as form constraints apply to the frame, which is the parent of the view. The {\f22 draw} method has to be prepared to display the scrollbar in any size. If the user resizes the scrollbar, {\f22 draw} is called by GINA and the slots {\f22 width} and {\f22 height} hold the current size of the view. When the application program modifies the {\f22 current-value} of the scrollbar the view is also redrawn. This is done by an after demon for {\f22 (setf current-value)}.\par \pard \s2\qj\ri1\sb40\sa100 If the mouse button is pressed in the scrollbar, an object of class {\f22 scroll-command} is instantiated which controls the interaction. In {\f22 track-mouse} the {\f22 current-value} is computed from the mouse position and the scrollbar is redrawn. In addition the {\f22 value-changed-callback} is executed. The method {\f22 execute} can handle callback objects, lambda-expressions and compiled functions. For undo and redo the {\f22 current-value} before a scroll operation is stored in the command object.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 9.4 Source Code\par \pard\plain \s10 \f22\fs12 ;;;-*-Mode\:LISP;Syntax\: Common-Lisp;Package\:lisp-widgets;Base\:10-*-\par \par (in-package \:GINA)\par (defginapackage \:lisp-widgets)\par (in-package \:lisp-widgets)\par (setq *sccs-id* "@(#)lisp-widgets.lisp\tab 1.4  1/15/92")\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class lisp-widget-demo\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass lisp-widget-demo (application)\par   (;; overrides\par    (name          \:initform "Lisp Widgets"          \:allocation \:class)\par    (document-type \:initform 'lisp-widget-document   \:allocation \:class)\par    (signature     \:initform "lisp-widgets"          \:allocation \:class)\par    (file-type     \:initform nil                     \:allocation \:class))\par   (\:documentation "demo how new widgets can be implemented in Lisp"))\par \par (defun make-lisp-widget-demo ()\par   "start the lisp-widget-demo"\par   (make-application \:class 'lisp-widget-demo))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class lisp-widget-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass lisp-widget-document (document)\par   ()\par   (\:documentation "application dependent document type"))\par \par (defmethod create-windows ((doc lisp-widget-document) &aux form scrollbar)\par   "create the windows belonging to this document"\par   (with-slots (main-shell main-view) doc\par     ;; create and install the view in a tool-window\par     (setq main-shell (make-document-shell doc))\par     (setq form (make-form main-shell \:motif-resources '(\:height 200)))\par     (setq scrollbar (make-selfmade-scrollbar form\par \tab \tab \tab \tab \tab      \:document doc\par \tab \tab \tab \tab \tab      \:value-changed-callback\par \tab \tab \tab \tab \tab      '(lambda (new-val) nil)))\par     (define-form-constraint scrollbar\par \tab \tab \tab     \:top-attachment  \:form \par \tab \tab \tab     \:left-attachment \:form\par \tab \tab \tab     \:bottom-attachment \:form)\par     (setq main-view scrollbar)\par \par     ;; remove unnecessary menu entries\par     (remove-menu-entry (main-menu main-shell) "File" "Open..")\par     (remove-menu-entry (main-menu main-shell) "File" "Save")\par     (remove-menu-entry (main-menu main-shell) "File" "Save as..")\par     (remove-menu-entry (main-menu main-shell) "File" "Revert")\par     ))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class selfmade-scrollbar\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass selfmade-scrollbar (view)\par   (;; instance-parameters\par    (max-value     \:accessor max-value     \:initarg \:max-value\par \tab           \:documentation "current value is between 0 and max-value")\par    (value-changed-callback\par      \:accessor value-changed-callback\par      \:initarg \:value-changed-callback\par      \:documentation "Function called with new value when user has scrolled")\par    \par    ;; instance-variables\par    (current-value \:accessor current-value \:initform 0)))\par \par (defun make-selfmade-scrollbar (parent &key (width 20)\par \tab \tab \tab \tab             (height 200)\par \tab \tab \tab \tab \tab     (max-value 100)\par \tab \tab \tab \tab \tab     (value-changed-callback nil)\par \tab \tab \tab \tab \tab     (document nil)\par \tab \tab \tab \tab        &aux frame new-sb)\par   "make a new selfmade-scrollbar widget"\par   (setq frame (make-frame parent))\par   (setq new-sb\par \tab (make-view frame \:width width \:height height\par \tab \tab    \:document document\par \tab \tab    \:resize-policy \:any\par \tab \tab    \:initargs (list \:max-value max-value\par \tab \tab \tab \tab    \:value-changed-callback value-changed-callback)\par \tab \tab    \:class 'selfmade-scrollbar))\par   (setf (group-widget-id new-sb) (widget-id frame))\par   new-sb)\par \par (defmethod (setf current-value) \:after (new-value (sb selfmade-scrollbar))\par   "when the text is changed a redisplay is necessary"\par   (declare (ignore new-value))\par   (force-redraw sb))\par \par (defmethod resized \:after ((view selfmade-scrollbar) ignore)\par    "the whole scrollbar must be redrawn when resized"\par    (declare (ignore ignore))\par    (force-redraw view))\par \par (defmethod draw ((view selfmade-scrollbar) count x y width height &aux current-y)\par   "draw window contents"\par   (declare (ignore x y width height))\par   (with-slots (gcontext width height current-value max-value) view\par     (when (zerop count) ;; Ignore all but the last exposure event\par       (setq current-y (round (* (- height 10) (/ (float current-value) max-value))))\par       (draw-rectangle view 0 current-y width 10 t)   ;; filled\par       (xlib\:with-gcontext (gcontext \:function boole-xor \:font "6x10")\par \tab (draw-glyphs view 2 (+ 8 current-y) (format nil "~d" current-value)))\par \par       )))\par \par (defmethod button-press ((sb selfmade-scrollbar) code repetition x y)\par   "react to button-press event in the window"\par   (declare (ignore code repetition))\par   (make-scroll-command sb x y))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class scroll-command\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass scroll-command (mouse-down-command)\par   (;; overrides\par    (name          \:initform "Scrolling" \:allocation \:class)\par    (undoable      \:initform t           \:allocation \:class)\par    (causes-change \:initform nil         \:allocation \:class)\par \par    ;; instance-parameters\par    (old-value \:accessor old-value \:initarg \:old-value)\par    ;; instance-variables\par    (new-value \:accessor new-value))\par   (\:documentation "a mouse-down-command for scrolling"))\par \par (defun make-scroll-command (sb mouse-x mouse-y &key (class 'scroll-command))\par   (make-mouse-down-command (document sb) sb mouse-x mouse-y\par \tab \tab \tab    \:class class\par \tab \tab \tab    \:initargs `(\:old-value ,(current-value sb))))\par \par (defmethod draw-feedback ((cmd scroll-command) x y &key clear)\par   "no feedback"\par   (declare (ignore clear x y)))\par \par (defmethod doit ((cmd scroll-command))\par   "nothing to do"\par   )\par \par (defmethod track-mouse ((cmd scroll-command) x y &key (started nil) (finished nil))\par   "move the slider"\par   (declare (ignore x started))\par   (with-slots ((scrollbar view) new-value) cmd\par     (with-slots (current-value max-value height value-changed-callback) scrollbar\par       (setq current-value (round (* max-value (/ y (float height)))))\par       (force-redraw scrollbar)\par       (execute value-changed-callback (list current-value))\par       (when finished\par \tab (setq new-value current-value)))))\par \par (defmethod undoit ((cmd scroll-command))\par   "move the elevator and call callback"\par   (with-slots ((scrollbar view) old-value) cmd\par     (with-slots (current-value value-changed-callback) scrollbar\par       (setq current-value old-value)\par       (force-redraw scrollbar)\par       (execute value-changed-callback (list current-value)))))\par \par (defmethod redoit ((cmd scroll-command))\par   "move the elevator and call callback"\par   (with-slots ((scrollbar view) new-value) cmd\par     (with-slots (current-value value-changed-callback) scrollbar\par       (setq current-value new-value)\par       (force-redraw scrollbar)\par       (execute value-changed-callback (list current-value)))))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; main program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (register-application "lisp-widgets" 'lisp-widget-demo nil)\par '(make-lisp-widget-demo)\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 10. Tetris\par \pard\plain \s7\qc\ri1\sb200\sa200\keepn \f34 {{\pict\macpict\picw443\pich544 42dc00000000022001bb1101a00082a0008e01000a0000000002d002409800380000000000b801c00000000000b801bb0000000000b801bb000102c9000cfe000080d2000001fe0000800a002acfaa04ab2aaaab80090315555595ce5500800a002acfaa04ab2aaaab80090315555595ce5500800c032bffffbfd1ff037fffeb80070016cc000115800c002ad1aa06acaaab2aaacb80110316555595f155007ff6ff00fdeb55008012002aeeaaf5ff00faf1aa06acaaab2aaacb801c0316555595f1550c007f9fcffff9cff9999ffe7f3dee5503500155801c002aeeaa0cf3ff9ffffff9cff9f99ffe7c3af1aa06acaaab22aecb80190316555595f1550c73c3090c39f9c9309098727f3deb5500801e022aa002f0aa0cf399980999f9c8999993247f3af1aa06aca82b22aecb801e0316455d95f1550c739998c8fff9c9999993267f3df0550151d5fe5500801c002aeeaa0cf38199ce3ff9c9999990267f3af1aa06acaaab22aecb801e03164ffd95f1550c739f99cf1ff9c9999993e67f3df0550153d5fe5500801c002aeeaa0cf39991c999fc99991913247f3af1aa06acaaab22aecb80190316555595f1550c73c3c9cc39fc199c9c98727f3deb55008012002aeeaaf5ff00faf1aa06acaaab27fecb80110316555595f155007ff6ff00fdeb55008012002aeeaaf5ff00faf1aa06acaaab2aaacb800f0316ffffbfd4ff06fdffff7fffd58007007fccff01df800a0001e1ff00e0ec0000800b002be1ff00e0ed00010b800b0017e1ff0040ed000115800c012beae2aa0020ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b80150117f0e300010340f9000001faff00fefe0001158015012be0e300010220f9000001faff00fcfe00010b80160117f0e300010340f900010180fb000002fe0001158016012be0e300010220f900010180fb000004fe00010b80160117f0e300010340f900010180fb000002fe0001158016012be0e300010220f900010180fb000004fe00010b80160117f0e300010340f900010180fb000002fe0001158018012be0e300010220f900010180fd00023c1e04fe00010b801c0117f0e300010340fe00007afd00010180fd0002663302fe000115801c012be0e300010220fe0000cefd00010180fd0002663304fe00010b801d0117f0e300010340fe0006c63d1e1dc78180fd0002660302fe000115801d012be0e300010220fe0006c067330e0cc180fd0002660304fe00010b801d0117f0e300010340fe00067cc3618c186180fd00023e0602fe000115801d012be0e300010220fe000606c0618c1fe180fd0002060c04fe00010b801d0117f0e300010340fe0006c6c0618c180180fd0002061802fe000115801d012be0e300010220fe0006e663330c0ce180fd00020c3004fe00010b801d0117f0e300010340fe0006bc3e1e1f87c180fd0002783f02fe0001158016012be0e300010220f900010180fb000004fe00010b80160117f0e300010340f900010180fb000002fe0001158016012be0e300010220f900010180fb000004fe00010b80160117f0e300010340f900010180fb000002fe0001158016012be0e300010220f900010180fb000004fe00010b80160117f0e300010340f900010180fb000002fe0001158016012be0e300010220f900010180fb000004fe00010b80130117f0e300010340f9000001f9aafe0001158015012be0e300010220f9000001fa550054fe00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b80150117f0e300010340f9000001faff00fefe0001158015012be0e300010220f9000001faff00fcfe00010b80160117f0e300010340f900010180fb000002fe0001158016012be0e300010220f900010180fb000004fe00010b80160117f0e300010340f900010180fb000002fe0001158016012be0e300010220f900010180fb000004fe00010b80160117f0e300010340f900010180fb000002fe000115801b012be0e300010220fd00000cfe00010180fc00011e04fe00010b801c0117f0e300060340000001f00cfe00010180fc00013302fe000115801b012be0e300010220fe0000c0fd00010180fc00013304fe00010b801c0117f0e300010340fe0006c03c770f07e180fc00010302fe000115801c012be0e300010220fe0006c00c39998c6180fc00010304fe00010b801c0117f0e300010340fe0006c00c31b0cc0180fc00010602fe000115801c012be0e300010220fe0006c60c31bfc7c180fc00010c04fe00010b801c0117f0e300010340fe0006c60c31b0006180fc00011802fe000115801c012be0e300010220fe0006c60c3199cc6180fc00013004fe00010b801c0117f0e3000b0340000001fe3f7bcf8fc180fc00013f02fe0001158016012be0e300010220f900010180fb000004fe00010b80160117f0e300010340f900010180fb000002fe0001158016012be0e300010220f900010180fb000004fe00010b80160117f0e300010340f900010180fb000002fe0001158016012be0e300010220f900010180fb000004fe00010b80160117f0e300010340f900010180fb000002fe0001158016012be0e300010220f900010180fb000004fe00010b80130117f0e300010340f9000001f9aafe0001158015012be0e300010220f9000001fa550054fe00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b80150117f0ef00003ffcff00f0fc00010340ed0001158015012be0ef00003ffcff00f0fc00010220ed00010b80150117f0ef00003ffcff00f0fc00010340ed000115801b012be0ef00003ffcff00f0fc00040220000015f355044000000b801b0117f0ef00003ffcff00f0fc0004034000002af3aa04c0000015801b012be0ef00003ffcff00f0fc00040220000010f30004c000000b801b0117f0ef00003ffcff00f0fc00040340000020f30004c0000015801b012be0ef00003ffcff00f0fc00040220000010f30004c000000b801b0117f0ef00003ffcff00f0fc00040340000020f30004c00000158020012be0ef00003ffcff00f0fc00040220000010fc0001c180fa0004c000000b80220117f0ef00003ffcff00f0fc000b034000002000000f0000c180fa0004c00000158022012be0ef00003ffcff00f0fc000b022000001000001980000180fa0004c000000b80220117f0ef00003ffcff00f0fc000b0340000020000030dce3c3f0fa0004c00000158022012be0ef00003ffcff00f0fc000b0220000010000030cc60c180fa0004c000000b80220117f0ef00003ffcff00f0fc000b0340000020000030cc60c180fa0004c00000158022012be0ef00003ffcff00f0fc000b0220000010000030cc60c180fa0004c000000b80220117f0ef00003ffcff00f0fc000b0340000020000030cc60c180fa0004c00000158022012be0ef00003ffcff00f0fc000b02200000100000198ce0c198fa0004c000000b80220117f0ef00003ffcff00f0fc000b034000002000000f0773f0f0fa0004c0000015801f012be0ef00003ffcff00f0fc0008022000001000000f40f70004c000000b801f0117f0ef00003ffcff00f0fc0008034000002000001b80f70004c0000015801b012be0ef00003ffcff00f0fc00040220000010f30004c000000b801b0117f0ef00003ffcff00f0fc00040340000020f30004c0000015801b012be0ef00003ffcff00f0fc00040220000010f30004c000000b801b0117f0ef00003ffcff00f0fc00040340000020f30004c00000158013012be0e30004022000001ff3ff04c000000b80130117f0e30004034000003ff3ff04c0000015800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed0001158013012be0e300040220000015f355044000000b80130117f0e30004034000002af3aa04c00000158013012be0e300040220000010f30004c000000b80130117f0e300040340000020f30004c00000158013012be0e300040220000010f30004c000000b80130117f0e300040340000020f30004c00000158013012be0e300040220000010f30004c000000b801b0117f0e300080340000020000039e0fe0000f4fb0004c0000015801b012be0e3000c0220000010000018c00000019cfb0004c000000b801e0117f0e3000f034000002000001cc79c38030cf9b61efe0004c0000015801e012be0e3000f022000001000001ccccdb003000cdb33fe0004c000000b801e0117f0e30017034000002000001ad86db003000cdb61800000c0000015801e012be0e30017022000001000001adfedb0033efcdb7f800000c000000b801e0117f0e3000f0340000020000019d807e0030d8cdb60fe0004c0000015801e012be0e300170220000010000019cce660018d9cdb33800000c000000b801e0117f0e3000f034000002000003cc7c66000fcefdb9ffe0004c00000158013012be0e300040220000010f30004c000000b80130117f0e300040340000020f30004c00000158098003800b80000017001c000b80000017001bb00b80000017001bb000113012be0e300040220000010f30004c000000b80130117f0e300040340000020f30004c00000158013012be0e300040220000010f30004c000000b80130117f0e300040340000020f30004c00000158013012be0e30004022000001ff3ff04c000000b80130117f0e30004034000003ff3ff04c0000015800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b800d0117f0e300010340ed000115800d012be0e300010220ed00010b80120117f0e300060340000007ffc0f2000115801a012be0fc000003f8ff0080f300060220000007ffc0f200010b80210117f0fc000a0200000300000180000080f3000703400000060080fef30001158021012be0fc000a0200000300000180000080f300070220000006fe4063f300010b80260117f0fc000a0200000300000180000080f3000c0340000006fe80633e39c7e3c0f80001158026012be0fc000a0200000300000180000080f3000c0220000006fe40630318cc6660f800010b80260117f0fc000a0200000300000180000080f3000c0340000006fe80660318cc0c30f80001158026012be0fc000a0200000300000180000080f3000c0220000006fe407c3f18c7cff0f800010b80250117f0fc000a0200000300000180000080f3000b0340000006fe80606318c06cf70001158026012be0fc000a0200000300000180000080f3000c0220000006fe40606719cc6670f800010b80260117f0fc000a0200000300000180000080f3000c03400000060080f83b8eefc3e0f80001158020012be0fc000a0200000300000180000080f3000602200000075540f200010b80200117f0fc000a0200000300000180000080f300060340000006aa80f2000115801b012be0fc000a0200000300000180000080f300010220ed00010b801b0117f0fc000a0200000300000180000080f300010340ed000115801b012be0fc000a0200000300000180000080f300010220ed00010b801b0117f0fc000a0200000300000180000080f300010340ed000115801b012be0fc000a0200000300000180000080f300010220ed00010b801b0117f0fc000a0200000300000180000080f300010340ed000115801b012be0fc000a0200000300000180000080f300010220ed00010b801b0117f0fc000a0200000300000180000080f300010340ed000115801b012be0fc000a0200000300000180000080f300010220ed00010b801b0117f0fc000a0200000300000180000080f300010340ed000115801b012be0fc000a0200000300000180000080f300010220ed00010b801b0117f0fc000a0200000300000180000080f300010340ed0001158015012be0fc000003f8ff0080f300010220ed00010b80150117f0fc000003f8ff0080f300010340ed000115801b012be0fc000a0200000300000180000080f300010220ed00010b801b0117f0fc000a0200000300000180000080f300010340ed000115801b012be0fc000a0200000300000180000080f300010220ed00010b801b0117f0fc000a0200000300000180000080f300010340ed000115801b012be0fc000a0200000300000180000080f300010220ed00010b801b0117f0fc000a0200000300000180000080f300010340ed000115801b012be0fc000a0200000300000180000080f300010220ed00010b801f0117f0fc000a0200000300000180000080f300010340fa00000ff50001158023012be0fc000a0200000300000180000080f300050220000001f0fe000003f500010b80230117f0fc000a0200000300000180000080f300010340fe0000c0fe000003f50001158023012be0fc000a0200000300000180000080f300010220fe0004c03c7bcf03f500010b80230117f0fc000a0200000300000180000080f300010340fe0004c066319983f50001158023012be0fc000a0200000300000180000080f300010220fe0004c0c331b0c3f500010b80230117f0fc000a0200000300000180000080f300010340fe0004c6ff1b3fc3f50001158023012be0fc000a0200000300000180000080f300010220fe0004c6c01b3003f500010b80230117f0fc000a0200000300000180000080f300010340fe0004c6670e19c3f50001158024012be0fc000a0200000300000180000080f3000a0220000001fe3e0e0f8fc0f600010b801b0117f0fc000a0200000300000180000080f300010340ed000115801b012be0fc000a0200000300000180000080f300010220ed00010b801b0117f0fc000a0200000300000180000080f300010340ed000115801b012be0fc000a0200000300000180000080f300010220ed00010b801b0117f0fc000a0200000300000180000080f300010340ed000115801b012be0fc000a0200000300000180000080f300010220ed00010b80150117f0fc000003f8ff0080f300010340ed000115801a012be0fc000003fbffef00040220000007f4ff00fefe00010b801e0117f0fc000602000003000001ef00040340000005f4550054fe000115801e012be0fc000602000003000001ef00040220000006f4000006fe00010b801e0117f0fc000602000003000001ef00040340000004f4000004fe000115801e012be0fc000602000003000001ef00040220000006f4000006fe00010b801e0117f0fc000602000003000001ef00040340000004f4000004fe000115801e012be0fc000602000003000001ef00040220000006f4000006fe00010b80200117f0fc000602000003000001ef000603400000040010f6000004fe0001158020012be0fc000602000003000001ef000602200000060028f6000006fe00010b80240117f0fc000602000003000001ef000603400000040044fe000007fa000004fe0001158025012be0fc000602000003000001ef000602200000060082fe00010d80fb000006fe00010b80250117f0fc000602000003000001ef000603400000040101fe000118c0fb000004fe0001158025012be0fc000602000003000001ef000b0220000006020080000018c0fb000006fe00010b80250117f0fc000602000003000001ef000b0340000004040040000018c0fb000004fe0001158025012be0fc000602000003000001ef000b0220000006080060000018c0fb000006fe00010b80250117f0fc000602000003000001ef000b03400000040600c0000018c0fb000004fe0001158025012be0fc000602000003000001ef000b0220000006030180000018c0fb000006fe00010b80250117f0fc000602000003000001ef000603400000040183fe00010d80fb000004fe0001158024012be0fc000602000003000001ef0006022000000600c6fe000007fa000006fe00010b80200117f0fc000602000003000001ef00060340000004006cf6000004fe0001158020012be0fc000602000003000001ef000602200000060038f6000006fe00010b80200117f0fc000602000003000001ef000603400000040010f6000004fe000115801e012be0fc000602000003000001ef00040220000006f4000006fe00010b801e0117f0fc000602000003000001ef00040340000004f4000004fe000115801a012be0fc000003fbffef00040220000006f4000006fe00010b801a0117f0fc000003fbffef00040340000004f4000004fe000115801e012be0fc000602000003000001ef00040220000006f4000006fe00010b801e0117f0fc000602000003000001ef00040340000004f4000004fe0001158020012be0fc000602000003000001ef000602200000060010f6000006fe00010b80200117f0fc000602000003000001ef000603400000040028f6000004fe0001158024012be0fc000602000003000001ef000602200000060044fe000003fa000006fe00010b80240117f0fc000602000003000001ef000603400000040082fe00000ffa000004fe0001158024012be0fc000602000003000001ef000602200000060101fe000003fa000006fe00010b80240117f0fc000602000003000001ef000a0340000004020080000003fa000004fe0001158024012be0fc000602000003000001ef000a0220000006040040000003fa000006fe00010b80240117f0fc000602000003000001ef000a0340000004080060000003fa000004fe0001158024012be0fc000602000003000001ef000a02200000060600c0000003fa000006fe00010b80240117f0fc000602000003000001ef000a0340000004030180000003fa000004fe0001158024012be0fc000602000003000001ef000602200000060183fe000003fa000006fe00010b80250117f0fc000602000003000001ef0006034000000400c6fe00010fc0fb000004fe0001158020012be0fc000602000003000001ef00060220000006006cf6000006fe00010b80200117f0fc000602000003000001ef000603400000040038f6000004fe0001158020012be0fc000602000003000001ef000602200000060010f6000006fe00010b801e0117f0fc000602000003000001ef00040340000004f4000004fe000115801e012be0fc000602000003000001ef00040220000006f4000006fe00010b801e0117f0fc000602000003000001ef00040340000004f4000004fe000115801e012be0fc000602000003000001ef00040220000006f4000006fe00010b801e0117f0fc000602000003000001ef00040340000004f4000004fe000115801e012be0fc000602000003000001ef00040220000006f4000006fe00010b801c0117f0fc000003fbffef000603400000040010f6000004fe0001158023012be0fc000003fbfffb00003ff9ff09f8000002200000060028f6000006fe00010b80300117f0fc000602000003000001fb001220000030000018000008000003400000040044fe00000ffa000004fe0001158031012be0fc000602000003000001fb001220000030000018000008000002200000060082fe00011980fb000006fe00010b80310117f0fc000602000003000001fb001220000030000018000008000003400000040101fe00011980fb000004fe0001158031012be0fc000602000003000001fb0017200000300000180000080000022000000602008000000180fb000006fe00010b80310117f0fc000602000003000001fb0017200000300000180000080000034000000404004000000180fb000004fe0001158030012be0fc000602000003000001fb00162000003000001800000800000220000006080060000003fa000006fe00010b80300117f0fc000602000003000001fb001620000030000018000008000003400000040600c0000006fa000004fe0001158030012be0fc000602000003000001fb0016200000300000180000080000022000000603018000000cfa000006fe00010b80300117f0fc000602000003000001fb001220000030000018000008000003400000040183fe000018fa000004fe0001158031012be0fc000602000003000001fb0012200000300000180000080000022000000600c6fe00011f80fb000006fe00010b802c0117f0fc000602000003000001fb00122000003000001800000800000340000004006cf6000004fe000115802c012be0fc000602000003000001fb001220000030000018000008000002200000060038f6000006fe00010b802c0117f0fc000602000003000001fb001220000030000018000008000003400000040010f6000004fe000115802a012be0fc000602000003000001fb00102000003000001800000800000220000006f4000006fe00010b802a0117f0fc000602000003000001fb00102000003000001800000800000340000004f4000004fe000115802a012be0fc000602000003000001fb00102000003000001800000800000220000006f4000006fe00010b802a0117f0fc000602000003000001fb00102000003000001800000800000340000004f4000004fe000115802a012be0fc000602000003000001fb00102000003000001800000800000220000006f4000006fe00010b802a0117f0fc000602000003000001fb00102000003000001800000800000340000004f4000004fe000115802c012be0fc000602000003000001fb001220000030000018000008000002200000060010f6000006fe00010b802c0117f0fc000602000003000001fb001220000030000018000008000003400000040028f6000004fe0001158030012be0fc000602000003000001fb001220000030000018000008000002200000060044fe00000ffa000006fe00010b80310117f0fc000602000003000001fb001220000030000018000008000003400000040082fe00011980fb000004fe0001158028012be0fc000003fbfffb00003ff9ff09f8000002200000060101fe00010180fb000006fe00010b80280417f0000007f5ff038000003ff9ff0ef80000034000000402008000000180fb000004fe00011580350d2be0000004000006000003000001feff198000002000003000001800000800000220000006040040000007fa000006fe00010b80350d17f0000004000006000003000001feff198000002000003000001800000800000340000004080060000001fa000004fe00011580360d2be0000004000006000003000001feff1a80000020000030000018000008000002200000060600c000000180fb000006fe00010b80360d17f0000004000006000003000001feff1a800000200000300000180000080000034000000403018000000180fb000004fe00011580360d2be0000004000006000003000001feff1580000020000030000018000008000002200000060183fe00011980fb000006fe00010b80350d17f0000004000006000003000001feff15800000200000300000180000080000034000000400c6fe00000ffa000004fe00011580310d2be0000004000006000003000001feff158000002000003000001800000800000220000006006cf6000006fe00010b80310d17f0000004000006000003000001feff1580000020000030000018000008000003400000040038f6000004fe00011580310d2be0000004000006000003000001feff1580000020000030000018000008000002200000060010f6000006fe00010b802f0d17f0000004000006000003000001feff138000002000003000001800000800000340000004f4000004fe000115802f0d2be0000004000006000003000001feff138000002000003000001800000800000220000006f4000006fe00010b802f0d17f0000004000006000003000001feff138000002000003000001800000800000340000004f4000004fe000115802f0d2be0000004000006000003000001feff138000002000003000001800000800000220000006f4000006fe00010b802f0d17f0000004000006000003000001feff138000002000003000001800000800000340000004f4000004fe000115802f0d2be0000004000006000003000001feff138000002000003000001800000800000220000006f4000006fe00010b80310d17f0000004000006000003000001feff1580000020000030000018000008000003400000040010f6000004fe00011580310d2be0000004000006000003000001feff1580000020000030000018000008000002200000060028f6000006fe00010b80360d17f0000004000006000003000001feff1580000020000030000018000008000003400000040044fe00010180fb000004fe00011580360d2be0000004000006000003000001feff1580000020000030000018000008000002200000060082fe00010380fb000006fe00010b80360d17f0000004000006000003000001feff1580000020000030000018000008000003400000040101fe00010780fb000004fe00011580360d2be0000004000006000003000001feff1a800000200000300000180000080000022000000602008000000580fb000006fe00010b80360d17f0000004000006000003000001feff1a800000200000300000180000080000034000000404004000000d80fb000004fe00011580360d2be0000004000006000003000001feff1a800000200000300000180000080000022000000608006000000980fb000006fe00010b80280417f0000007f5ff038000003ff9ff0ef8000003400000040600c000001980fb000004fe0001158021042be0000007e9ff0ef80000022000000603018000001fc0fb000006fe00010b80330d17f0000004000006000003000001fbff12e0000030000018000008000003400000040183fe00010180fb000004fe00011580330d2be0000004000006000003000001fbff12e00000300000180000080000022000000600c6fe000103c0fb000006fe00010b802e0d17f0000004000006000003000001fbff12e000003000001800000800000340000004006cf6000004fe000115802e0d2be0000004000006000003000001fbff12e0000030000018000008000002200000060038f6000006fe00010b802e0d17f0000004000006000003000001fbff12e0000030000018000008000003400000040010f6000004fe000115802c0d2be0000004000006000003000001fbff10e000003000001800000800000220000006f4000006fe00010b802c0d17f0000004000006000003000001fbff10e000003000001800000800000340000004f4000004fe000115802c0d2be0000004000006000003000001fbff10e000003000001800000800000220000006f4000006fe00010b802c0d17f0000004000006000003000001fbff10e000003000001800000800000340000004f4000004fe000115802c0d2be0000004000006000003000001fbff10e000003000001800000800000220000006f4000006fe00010b802c0d17f0000004000006000003000001fbff10e000003000001800000800000340000004f4000004fe000115802e0d2be0000004000006000003000001fbff12e0000030000018000008000002200000060010f6000006fe00010b802e0d17f0000004000006000003000001fbff12e0000030000018000008000003400000040028f6000004fe0001158098003801700000022001c001700000022001bb01700000022001bb0001330d2be0000004000006000003000001fbff12e0000030000018000008000002200000060044fe00010fc0fb000006fe00010b80320d17f0000004000006000003000001fbff12e0000030000018000008000003400000040082fe00000cfa000004fe00011580320d2be0000004000006000003000001fbff12e0000030000018000008000002200000060101fe00000cfa000006fe00010b80320d17f0000004000006000003000001fbff16e00000300000180000080000034000000402008000000cfa000004fe00011580330d2be0000004000006000003000001fbff17e00000300000180000080000022000000604004000000f80fb000006fe00010b80330d17f0000004000006000003000001fbff17e000003000001800000800000340000004080060000008c0fb000004fe00011580330d2be0000004000006000003000001fbff13e0000030000018000008000002200000060600c0fe0000c0fb000006fe00010b80330d17f0000004000006000003000001fbff13e000003000001800000800000340000004030180fe0000c0fb000004fe00011580330d2be0000004000006000003000001fbff12e0000030000018000008000002200000060183fe00010cc0fb000006fe00010b80330d17f0000004000006000003000001fbff12e00000300000180000080000034000000400c6fe00010780fb000004fe000115801c042be0000007e9ff09f800000220000006006cf6000006fe00010b801e0117f0f9000001f2ff00f0fc000603400000040038f6000004fe000115801e012be0f9000001f2ff00f0fc000602200000060010f6000006fe00010b801c0117f0f9000001f2ff00f0fc00040340000004f4000004fe000115801c012be0f9000001f2ff00f0fc00040220000006f4000006fe00010b801c0117f0f9000001f2ff00f0fc00040340000004f4000004fe000115801c012be0f9000001f2ff00f0fc00040220000006f4000006fe00010b801c0117f0f9000001f2ff00f0fc00040340000004f4000004fe000115801c012be0f9000001f2ff00f0fc00040220000006f4000006fe00010b801e0117f0f9000001f2ff00f0fc000603400000040010f6000004fe000115801e012be0f9000001f2ff00f0fc000602200000060028f6000006fe00010b80230117f0f9000001f2ff00f0fc000603400000040044fe000103c0fb000004fe0001158022012be0f9000001f2ff00f0fc000602200000060082fe000006fa000006fe00010b80220117f0f9000001f2ff00f0fc000603400000040101fe00000cfa000004fe0001158022012be0f9000001f2ff00f0fc000a022000000602008000000cfa000006fe00010b80230117f0f9000001f2ff00f0fc000b034000000404004000000d80fb000004fe0001158023012be0f9000001f2ff00f0fc000b022000000608006000000ec0fb000006fe00010b80230117f0f9000001f2ff00f0fc000b03400000040600c000000cc0fb000004fe0001158023012be0f9000001f2ff00f0fc000b022000000603018000000cc0fb000006fe00010b80230117f0f9000001f2ff00f0fc000603400000040183fe00010cc0fb000004fe0001158023012be0f9000001f2ff00f0fc0006022000000600c6fe00010780fb000006fe00010b801e0117f0f9000001f2ff00f0fc00060340000004006cf6000004fe000115801e012be0f9000001f2ff00f0fc000602200000060038f6000006fe00010b801e0117f0f9000001f2ff00f0fc000603400000040010f6000004fe000115801c012be0f9000001f2ff00f0fc00040220000006f4000006fe00010b801c0117f0f9000001f2ff00f0fc00040340000004f4000004fe000115801f012beffcff03fc000001f2ff00f0fc00040220000006f4000006fe00010b802a0a17f800000c000004000001fbff09c0000060000030000010fc00040340000004f4000004fe000115802a0a2be800000c000004000001fbff09c0000060000030000010fc00040220000006f4000006fe00010b802a0a17f800000c000004000001fbff09c0000060000030000010fc00040340000004f4000004fe000115802c0a2be800000c000004000001fbff09c0000060000030000010fc000602200000060010f6000006fe00010b802c0a17f800000c000004000001fbff09c0000060000030000010fc000603400000040028f6000004fe00011580310a2be800000c000004000001fbff09c0000060000030000010fc000602200000060044fe00011f80fb000006fe00010b80310a17f800000c000004000001fbff09c0000060000030000010fc000603400000040082fe00011180fb000004fe00011580310a2be800000c000004000001fbff09c0000060000030000010fc000602200000060101fe00010180fb000006fe00010b80300a17f800000c000004000001fbff09c0000060000030000010fc000a0340000004020080000003fa000004fe00011580300a2be800000c000004000001fbff09c0000060000030000010fc000a0220000006040040000003fa000006fe00010b80300a17f800000c000004000001fbff09c0000060000030000010fc000a0340000004080060000003fa000004fe00011580300a2be800000c000004000001fbff09c0000060000030000010fc000a02200000060600c0000003fa000006fe00010b80300a17f800000c000004000001fbff09c0000060000030000010fc000a0340000004030180000006fa000004fe00011580300a2be800000c000004000001fbff09c0000060000030000010fc000602200000060183fe000006fa000006fe00010b80300a17f800000c000004000001fbff09c0000060000030000010fc0006034000000400c6fe000006fa000004fe000115802c0a2be800000c000004000001fbff09c0000060000030000010fc00060220000006006cf6000006fe00010b802c0a17f800000c000004000001fbff09c0000060000030000010fc000603400000040038f6000004fe000115802c0a2be800000c000004000001fbff09c0000060000030000010fc000602200000060010f6000006fe00010b802a0a17f800000c000004000001fbff09c0000060000030000010fc00040340000004f4000004fe000115802a0a2be800000c000004000001fbff09c0000060000030000010fc00040220000006f4000006fe00010b802a0a17f800000c000004000001fbff09c0000060000030000010fc00040340000004f4000004fe000115802a0a2be800000c000004000001fbff09c0000060000030000010fc00040220000006f4000006fe00010b802a0a17f800000c000004000001fbff09c0000060000030000010fc00040340000004f4000004fe000115801f012beffcff03fc000001f2ff00f0fc00040220000006f4000006fe00010b801b0017fbff03fc000001ebff05400000040010f6000004fe000115802c0a2be800000c000004000001fbff09c000006000003000001ffcff06fe200000060038f6000006fe00010b802f0a17f800000c000004000001fbff09c000006000003000001ffbff0540000004006cfe00000ffa000004fe00011580310a2be800000c000004000001fbff09c000006000003000001ffcff06fe2000000600d6fe00011980fb000006fe00010b80300a17f800000c000004000001fbff09c000006000003000001ffbff054000000401bbfe00011980fb000004fe00011580310a2be800000c000004000001fbff09c000006000003000001ffcff0bfe20000006037d8000001980fb000006fe00010b802f0a17f800000c000004000001fbff09c000006000003000001ffbff094000000406fec000000ffa000004fe00011580310a2be800000c000004000001fbff09c000006000003000001ffcff0bfe200000060dff2000001980fb000006fe00010b80300a17f800000c000004000001fbff09c000006000003000001ffbff0a4000000404fe4000001980fb000004fe00011580310a2be800000c000004000001fbff09c000006000003000001ffcff0bfe20000006027c8000001980fb000006fe00010b80300a17f800000c000004000001fbff09c000006000003000001ffbff05400000040139fe00011980fb000004fe00011580300a2be800000c000004000001fbff09c000006000003000001ffcff06fe200000060092fe00000ffa000006fe00010b802b0a17f800000c000004000001fbff09c000006000003000001ffbff05400000040044f6000004fe000115802c0a2be800000c000004000001fbff09c000006000003000001ffcff06fe200000060028f6000006fe00010b802b0a17f800000c000004000001fbff09c000006000003000001ffbff05400000040010f6000004fe000115802a0a2be800000c000004000001fbff09c000006000003000001ffcff04fe20000006f4000006fe00010b80290a17f800000c000004000001fbff09c000006000003000001ffbff0340000004f4000004fe000115802a0a2be800000c000004000001fbff09c000006000003000001ffcff04fe20000006f4000006fe00010b80290a17f800000c000004000001fbff09c000006000003000001ffbff0340000004f4000004fe000115802a0a2be800000c000004000001fbff09c000006000003000001ffcff04fe20000006f4000006fe00010b80290a17f800000c000004000001fbff09c000006000003000001ffbff0340000004f4000004fe000115802c0a2be800000c000004000001fbff09c000006000003000001ffcff06fe200000060010f6000006fe00010b802b0a17f800000c000004000001fbff09c000006000003000001ffbff05400000040028f6000004fe00011580300a2be800000c000004000001fbff09c000006000003000001ffcff06fe200000060044fe00000ffa000006fe00010b80200017fbff03fc000001ebff05400000040082fe00011980fb000004fe0001158025012beffcff03fc000001efff09f8000002200000060101fe00011980fb000006fe00010b80270a17f800000c000004000001efff0ef80000034000000402008000001980fb000004fe00011580270a2be800000c000004000001efff0ef80000022000000604004000001980fb000006fe00010b80270a17f800000c000004000001efff0ef80000034000000408006000000f80fb000004fe00011580270a2be800000c000004000001efff0ef8000002200000060600c000000180fb000006fe00010b80270a17f800000c000004000001efff0ef80000034000000403018000000180fb000004fe00011580260a2be800000c000004000001efff09f8000002200000060183fe000003fa000006fe00010b80260a17f800000c000004000001efff09f80000034000000400c6fe00001efa000004fe00011580220a2be800000c000004000001efff09f800000220000006006cf6000006fe00010b80220a17f800000c000004000001efff09f8000003400000040038f6000004fe00011580220a2be800000c000004000001efff09f8000002200000060010f6000006fe00010b80200a17f800000c000004000001efff07f800000340000004f4000004fe00011580200a2be800000c000004000001efff07f800000220000006f4000006fe00010b80200a17f800000c000004000001efff07f800000340000004f4000004fe00011580200a2be800000c000004000001efff07f800000220000006f4000006fe00010b80200a17f800000c000004000001efff07f800000340000004f4000004fe00011580200a2be800000c000004000001efff07f800000220000006f4000006fe00010b80220a17f800000c000004000001efff09f8000003400000040010f6000004fe00011580220a2be800000c000004000001efff09f8000002200000060028f6000006fe00010b80260a17f800000c000004000001efff0df800000340000004004400000607fa000004fe00011580270a2be800000c000004000001efff0ef800000220000006008200001e0d80fb000006fe00010b80270a17f800000c000004000001efff0ef800000340000004010100000618c0fb000004fe00011580270a2be800000c000004000001efff0ef800000220000006020080000618c0fb000006fe00010b80270a17f800000c000004000001efff0ef800000340000004040040000618c0fb000004fe0001158025012beffcff03fc000001efff0ef800000220000006080060000618c0fb000006fe00010b802c0017feff06f8000003fffffefb00007ff9ff00f0fc000b03400000040600c0000618c0fb000004fe000115802c0a2beffffff8000003fffffefb00007ff9ff00f0fc000b0220000006030180000618c0fb000006fe00010b802c0017feff06f8000003fffffefb00007ff9ff00f0fc000b034000000401830000060d80fb000004fe000115802b0a2beffffff8000003fffffefb00007ff9ff00f0fc000a022000000600c600001f87fa000006fe00010b80270017feff06f8000003fffffefb00007ff9ff00f0fc00060340000004006cf6000004fe00011580270a2beffffff8000003fffffefb00007ff9ff00f0fc000602200000060038f6000006fe00010b80270017feff06f8000003fffffefb00007ff9ff00f0fc000603400000040010f6000004fe00011580250a2beffffff8000003fffffefb00007ff9ff00f0fc00040220000006f4000006fe00010b80250017feff06f8000003fffffefb00007ff9ff00f0fc00040340000004f4000004fe00011580250a2beffffff8000003fffffefb00007ff9ff00f0fc00040220000006f4000006fe00010b80250017feff06f8000003fffffefb00007ff9ff00f0fc00040340000004f4000004fe00011580250a2beffffff8000003fffffefb00007ff9ff00f0fc00040220000006f4000006fe00010b80250017feff06f8000003fffffefb00007ff9ff00f0fc00040340000004f4000004fe00011580250a2beffffff8000003fffffefb00007ff9ff00f0fc00040220000007f4ff00fefe00010b80250017feff06f8000003fffffefb00007ff9ff00f0fc00040340000005f4550054fe000115801e0a2beffffff8000003fffffefb00007ff9ff00f0fc00010220ed00010b801e0017feff06f8000003fffffefb00007ff9ff00f0fc00010340ed000115801e0a2beffffff8000003fffffefb00007ff9ff00f0fc00010220ed00010b801e0017feff06f8000003fffffefb00007ff9ff00f0fc00010340ed000115801e0a2beffffff8000003fffffefb00007ff9ff00f0fc00010220ed00010b801e0017feff06f8000003fffffefb00007ff9ff00f0fc00010340ed000115801e0a2beffffff8000003fffffefb00007ff9ff00f0fc00010220ed00010b801e0017feff06f8000003fffffefb00007ff9ff00f0fc00010340ed000115801e0a2beffffff8000003fffffefb00007ff9ff00f0fc00010220ed00010b801e0017feff06f8000003fffffefb00007ff9ff00f0fc00010340ed0001158016012beff9ff00fefe00f2ff04f800000220ed00010b80230a17f800000c000007fffffefe0006800000c000007ff9ff04f800000340ed00011580230a2be800000c000007fffffefe0006800000c000007ff9ff04f800000220ed00010b80230a17f800000c000007fffffefe0006800000c000007ff9ff04f800000340ed00011580230a2be800000c000007fffffefe0006800000c000007ff9ff04f800000220ed00010b80230a17f800000c000007fffffefe0006800000c000007ff9ff04f800000340ed00011580230a2be800000c000007fffffefe0006800000c000007ff9ff04f800000220ed00010b80230a17f800000c000007fffffefe0006800000c000007ff9ff04f800000340ed00011580230a2be800000c000007fffffefe0006800000c000007ff9ff04f800000220ed00010b80230a17f800000c000007fffffefe0006800000c000007ff9ff04f800000340ed00011580230a2be800000c000007fffffefe0006800000c000007ff9ff04f800000220ed00010b80230a17f800000c000007fffffefe0006800000c000007ff9ff04f800000340ed00011580230a2be800000c000007fffffefe0006800000c000007ff9ff04f800000220ed00010b80230a7ff800000c000007fffffefe0006800000c000007ff9ff04f800000340ed00011f80220a01e800000c000007fffffefe0006800000c000007ff9ff04f800000220ec000080230a17f800000c000007fffffefe0006800000c000007ff9ff04f800000340ed00011580230a2be800000c000007fffffefe0006800000c000007ff9ff04f800000220ed00010b80230a17f800000c000007fffffefe0006800000c000007ff9ff04f800000340ed00011580230a2be800000c000007fffffefe0006800000c000007ff9ff04f800000220ed00010b80230a17f800000c000007fffffefe0006800000c000007ff9ff04f800000340ed00011580230a2be800000c000007fffffefe0006800000c000007ff9ff04f800000220ed00010b80230a17f800000c000007fffffefe0006800000c000007ff9ff04f800000340ed00011580230a2be800000c000007fffffefe0006800000c000007ff9ff04f800000220ed00010b80230a17f800000c000007fffffefe0006800000c000007ff9ff04f800000340ed0001158016012beff9ff00fefe00f2ff04f800000220ed00010b800b0017e1ff0040ed000115800c012beae2aa0020ed00010b800c0117c0e2000040ed000115800c012bc0e2000020ed00010b800c0117d5e2550040ed000115800b002be1aa00a0ed00010b80070017cc0001158007002acc00010b80090315555595ce5500800a002acfaa04ab2aaaab80090315555595ce5500800a002acfaa04ab2aaaab800c033fffffbfd1ff037fffff8006007fcbff008002c900a0008fa00083ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 10.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 This is a simple version of the well known arcade game. You press the {\f22 New} {\f22 Game} button to start. Rectangles of different size and color begin to fall down. Their speed depends on the level selected using the radio button group on the left. You can move the rectangles to the left and right using the "j" and "l" keys. Pessing "k" rotates the rectangle. Your task is to place the rectangles in such a way that no gaps remain. Each completed line immediately disappears. The space bar can be used to drop a rectangle to the ground. Please notice that you have to move the mouse cursor into the view where the rectangles are shown, because otherwise your key presses go unnoticed. You can interrupt a game at any time using the {\f22 Pause} button or by pressing "p".\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 10.2 Implementation\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 The basic idea is that each Tertris piece is a {\f22 view-object}. When a game is started, the slot {\f22 idle-timeout} of the application is set depending on the game level, so that the method {\f22 idle-timeout }is called several times per second. At each timeout, the falling piece is moved and some checks are performed, whether the ground is reached and so on. The method {\f22 key-press }of the Tetris view is called only when the mouse is inside the view.\par \pard \s2\qj\ri1\sb40\sa100 \par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 11. Pacmen \par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 11.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 This demo is much less than a real Pacman game. It only demonstrates the use of multiple processes within a single application. You can create a pacman by the menu entry NEW PACMAN. It will run down the window line by line at a random speed and disappear when the bottom is reached. On SUNs, the death of a pacmen is indicated by a "drip" sound. Because each pacman runs in his own process the user interface remains fully operable. The pacmen continue to run even during modal dialogs.\par \pard \s2\qj\ri1\sb40\sa100 You can start multiple pacmen (as many as your Lisp can stand). Try to kill a pacman by clicking the mouse at him. A pacman overtaking a slower one will eat it up. A pacman can also be started with a progress bar indicating how many lines are already done. The progress bar can also be used to kill the pacman. You can explicitly kill all pacmen. This is implicitly done by GINA when a document is closed.\par \pard\plain \f20 {{\pict\macpict\picw431\pich443\picscaled 289300000000024f023e1101a00082a0008e01000a0000000002d0024098004800000000008e024000000000008e023e00000000008e023e00010cfe000010c2000001fe000010060015bb5500700c033ffffff7c1ff037ffffff00d032aaaaab2c2aa04ab2aaaaab00c033ffffff7c1ff037ffffff0060015bb5500700c033ffffff7c1ff037ffffff00d032aaaaab2c2aa04ab2aaaaab00c033ffffff7c1ff037ffffff008011540bd000115700f033fdffff7c4ff06fdffff7fffdff015032acaaab2e9aaf400000aeaaa06acaaab2aaacab017033fdffff7eaff00fef400001feaff06fdffff7fffdff0190015e7550154fcfc0007018c019998006315e75503500155701f033fdffff7eaff01fec6fc0007018c018198006f1feaff06fdffff77ffdff020032acaaab2e9aa0dc6f1e5dc79b1818db3dbd9e3630aeaaa06acaaab22aecab021033fdc00f7eaff0efec79b3666cdd9818dd9999b36e31feaff06fdf87f77ffdff01d0015e7550e54fc1b0666cd98018d99999b366315e9550151d5fe55007021033fddfff7eaff0efec0fb0666fd98018d99999bf6631feaff06fdfbff77ffdff020032ac9ffb2e9aa0dc19b0666c198018d99999b06630aeaaa06acabab22aecab021033fdffff7eaff0efec19b3666cd9980d999b9bb36e31feaff06fdffff77ffdff0180015e7550e54c0ede666799980f998d8d9e36315e455007017033fdffff7eaff00fef400001feaff06fdffff77ffdff015032acaaab2e9aaf400000aeaaa06acaaab2aaacab017033fdffff7eaff00fef400001feaff06fdffff7fffdff00f03155ffff7c4ff06fdffff7fffd57007007fbcff01dff00801002abdaa01801008013ff5bd55019ff009011568be000201957009013ff0be0002019ff009012ae8be0002018ab009013ff0be0002019ff009011568be000201957009013ff0be0002019ff009012ae8be0002018ab009013ff0be0002019ff01c051568000061e0fe0002038306fe00010380fd00001ed200020195701d103ff00ff060600000ff018306000fc00180fe00017f06d20002019ff01d102ae8063000600000630180060006600180fe00013186d20002018ab020183ff00631e0607800631d8f0fc00631e1b9ce3b8031860f8e38d50002019ff02018156806806060cc006833830600063331ccc66700318600c630d5000201957020183ff007806061860078318306000636198cc66300330600c630d50002019ff020182ae806806061fe0068318306000637f98cc663003e060fc360d50002018ab020183ff006006061800063318306000636018cc66300300618c360d50002019ff02018156806006060ce006333830660066339ccce6700300619c1c0d5000201957020183ff00f81f9f87c00ff1dcfc3c00fc1f3b8773b007c1f8ee1c0d50002019ff012012ae8f1000003fd00010180d50002018ab012013ff0f1000003fd00010180d50002019ff012011568f100001efd000107c0d5000201957009013ff0be0002019ff009012ae8be0002018ab009013ff0be0002019ff009011568be000201957009013ff0be0002019ff009012ae8be0002018ab009013ff0be0002019ff009011568be000201957008013ff7bdff019ff008012aefbdff018ab007003fbcff019ff00801157fbdff01157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be00020115700c013ff8cd000040f200019ff00e012af8ce00011ffff30002010ab00e013ff8ce00027fffc0f300019ff010011578cf000301fffff0f400020115700f013ff8cf000307fffff8f300019ff010012af8cf00030ffffffef40002010ab00e013ff8cf00001ffefff300019ff011011578cf00003ffeff0080f5000201157010013ff8cf00007ffeff0080f400019ff011012af8cf00007ffeff00c0f50002010ab00e013ff8cf00fdff00e0f400019ff00f011578cf00fdff00e0f5000201157010013ff8d0000001fdff00f0f400019ff011012af8d0000001fdff00c0f50002010ab00e013ff8d0000003fdfff300019ff011011578d0000403fffdfff8f4000201157010013ff8d0000403fff9ffe0f300019ff011012af8d0000403fff5ff80f40002010ab00f013ff8d0000303ffedfcf200019ff010011578d0000303ffddf0f300020115700f013ff8d0000307ffbd80f200019ff010012af8d0000303ff80f0f30002010ab00f013ff8d0000303fffdfcf200019ff011011578d0000403fffdff80f4000201157010013ff8d0000403fffdffe0f300019ff011012af8d0000003feff00f8f40002010ab00e013ff8d0000003fdfff300019ff011011578d0000001fdff00c0f5000201157010013ff8d0000001fdff00f0f400019ff00f012af8cf00fdff00e0f50002010ab00e013ff8cf00fdff00e0f400019ff011011578cf00007ffeff00c0f5000201157010013ff8cf00007ffeff0080f400019ff011012af8cf00003ffeff0080f50002010ab00e013ff8cf00001ffefff300019ff010011578cf00030ffffffef400020115700f013ff8cf000307fffff8f300019ff010012af8cf000301fffff0f40002010ab00e013ff8ce00027fffc0f300019ff00e011578ce00011ffff30002011570980048008e0000011c0240008e0000011c023e008e0000011c023e000108013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be00020115700c013ff8f0000040cf00019ff00e012af8f100011fffd00002010ab00e013ff8f100027fffc0d000019ff010011578f2000301fffff0d100020115700f013ff8f2000307fffff8d000019ff010012af8f200030ffffffed10002010ab00e013ff8f200001ffeffd000019ff011011578f200003ffeff0080d2000201157010013ff8f200007ffeff0080d100019ff011012af8f200007ffeff00c0d20002010ab00e013ff8f200fdff00e0d100019ff00f011578f200fdff00e0d2000201157010013ff8f3000001fdff00f0d100019ff011012af8f200007ffeff00f0d20002010ab010013ff8f200001ffeff00f8d100019ff011011578f200040380fffff8d200020115700f013ff8f10003fefffff8d100019ff010012af8f100033dfffff8d20002010ab00f013ff8f1000303fffff8d100019ff010011578f100030ffffff8d200020115700f013ff8f10003017ffff8d100019ff00f012af8f00002fffff8d20002010ab00f013ff8f1000306fffff8d100019ff010011578f100037efffff8d200020115700f013ff8f10003c1fffff8d100019ff011012af8f2000003feff00f8d20002010ab010013ff8f200001ffeff00f8d100019ff011011578f200007ffeff00f0d2000201157010013ff8f3000001fdff00f0d100019ff00f012af8f200fdff00e0d20002010ab00e013ff8f200fdff00e0d100019ff011011578f200007ffeff00c0d2000201157010013ff8f200007ffeff0080d100019ff011012af8f200003ffeff0080d20002010ab00e013ff8f200001ffeffd000019ff010011578f200030ffffffed100020115700f013ff8f2000307fffff8d000019ff010012af8f2000301fffff0d10002010ab00e013ff8f100027fffc0d000019ff00e011578f100011fffd000020115700c013ff8da000004e500019ff00f012af8db000201fff0e70002010ab00e013ff8db000207fffce600019ff00f011578db00021fffffe700020115700f013ff8db00037fffff80e700019ff00f012af8db00feff00e0e80002010ab010013ff8dc000001feff00f0e700019ff011011578dc000003feff00f8e8000201157010013ff8dc000007feff00f8e700019ff011012af8dc000007feff00fce80002010ab010013ff8dc00000ffeff00fee700019ff011011578dc00000ffeff00fee800020115700e013ff8dc00001ffdffe700019ff00f012af8dc00001ffdffe80002010ab010013ff8dc00003ffdff0080e800019ff012011578dc00053fff7fffff80e9000201157011013ff8dc00053ffe7fffff80e800019ff012012af8dc00053ffd7fffff80e90002010ab011013ff8dc00053fff7fffff80e800019ff012011578dc00053fff7fffff80e9000201157011013ff8dc00057fff7fffff80e800019ff012012af8dc00053fff7fffff80e90002010ab0980048011c000001aa0240011c000001aa023e011c000001aa023e000111013ff8dc00053fff7fffff80e800019ff012011578dc00053fff7fffff80e9000201157011013ff8dc00053ffc1fffff80e800019ff011012af8dc00003ffdff0080e90002010ab010013ff8dc00003ffdff0080e800019ff00f011578dc00001ffdffe800020115700e013ff8dc00001ffdffe700019ff011012af8dc00000ffeff00fee80002010ab010013ff8dc00000ffeff00fee700019ff011011578dc000007feff00fce8000201157010013ff8dc000007feff00f8e700019ff011012af8dc000003feff00f8e80002010ab010013ff8dc000001feff00f0e700019ff00f011578db00feff00e0e800020115700f013ff8db00037fffff80e700019ff00f012af8db00021fffffe70002010ab00e013ff8db000207fffce600019ff00f011578db000201fff0e7000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff014012af8f6000010e0000320000002ef0002010ab013013ff8f900032aaaaab2ddaa00aeee00019ff014011578f9000015dd550365555556ef000201157013013ff8f900032aaaaab2ddaa00aeee00019ff014012af8f9000015dd550365555556ef0002010ab013013ff8f900032aaaaab2ddaa00aeee00019ff014011578f9000015dd550365555556ef000201157013013ff8f900032aaaaab2ddaa00aeee00019ff017012af8f90003157ffff7e0ff03effffd56ef0002010ab012013ff8f900012ac0dc000102aeee00019ff012011578f9000015db55015956ef000201157019013ff8f900032acaaab2f3aafa00002af3aa00aeee00019ff018012af8f9000015f1550054fa00f355015956ef0002010ab01c013ff8f900032acaaab2f3aa00fcfc0001032af3aa00aeee00019ff01b011578f9000015f1550154c6fc000007f355015956ef00020115701e013ff8f900032acaaab2f3aa07c6f1e5dc79b00b2af3aa00aeee00019ff01f012af8f90002155400f3550754c79b3666cdd80bf355015956ef0002010ab01e013ff8f900032ac8abb2f3aa07fc1b06660d98132af3aa00aeee00019ff01d011578f9000015f1550754c0fb06667d9823f355015956ef00020115701d013ff8f900032ac9ffb2f3aa06c19b0666cd983ff2aa00aeee00019ff01d012af8f9000015f1550754c19b3666cd9803f355015956ef0002010ab01e013ff8f900032acaaab2f3aa07c0ede6667798032af3aa00aeee00019ff018011578f9000015f1550054fa00f355015956ef000201157019013ff8f900032acaaab2f3aafa00002af3aa00aeee00019ff018012af8f9000015f1550054fa00f355015956ef0002010ab014013ff8f900032adffff7deff01faaeee00019ff012011578f900007fdbff01fbfeef000201157011013ff8f800002adcaa01a002ee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff018011578f90006157000003ffff8e100011156ef000201157017013ff8f900062ae000002aaaa8e1000112aeee00019ff018012af8f9000615700000115530e100011156ef0002010ab017013ff8f900062ae0000019aa20e1000112aeee00019ff018011578f9000615700000115530e100011156ef000201157027013ff8f900062ae0000019aa20fa000003fd00043000003c03fd000030f7000112aeee00019ff02c012af8f9000a1570000010d430000003f8fe000003fd00043000000c03fd0000f0f700011156ef0002010ab023013ff8f9000a2ae0000018aa200000018cf600000cfc000030f7000112aeee00019ff02e011578f9001c157000001054300000018dceee770f1dc3b800f1dc000c0f1dc3c00030f700011156ef00020115702d013ff8f9001c2ae000001828200000018cc67339830e66700030e6000c030e66600030f7000112aeee00019ff02e012af8f9001c1570000010303000000198c66331830c66300030c6000c030c6c300030f700011156ef0002010ab02d013ff8f9001c2ae00000186820000001f0c66331830c66300030c6000c030c6ff00030f7000112aeee00019ff02e011578f9001c1570000010d43000000198c66331830c66300030c6000c030c6c000030f700011156ef000201157031013ff8f900202ae0000019aa200000018cce6331830c66700030c6000c030c6670003000180c06fb000112aeee00019ff032012af8f9002015700000115530000003ce77f7fbcfdef3b000fdef003f0fdef3e000fc00180c06fb00011156ef0002010ab01b013ff8f900062ae0000019aa20f7000030ec000112aeee00019ff01c011578f9000615700000115530f7000030ec00011156ef00020115701c013ff8f900062ae0000019aa20f8000101e0ec000112aeee00019ff018012af8f9000615700000115530e100011156ef0002010ab017013ff8f900062ae000003ffff8e1000112aeee00019ff018011578f9000615700000355550e100011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157017013ff8f900012ae0fb00013038e4000112aeee00019ff018012af8f900011570fb0001f06ce400011156ef0002010ab017013ff8f900012ae0fb000130c6e4000112aeee00019ff018011578f900011570fb000130c6e400011156ef000201157017013ff8f900012ae0fb000130c6e4000112aeee00019ff018012af8f900011570fb000130c6e400011156ef0002010ab017013ff8f900012ae0fb000130c6e4000112aeee00019ff018011578f900011570fb000130c6e400011156ef000201157017013ff8f900012ae0fb0001306ce4000112aeee00019ff018012af8f900011570fb0001fc38e400011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff017012af8f9000315700001e0ff0300001156ef0002010ab016013ff8f900032ae00001e0ff03000012aeee00019ff01e011578f9000315700001fefffe550057e8ff04fe00001156ef000201157098004801aa00000238024001aa00000238023e01aa00000238023e00011d013ff8f900032ae00001fefffeaa00afe8ff04fd000012aeee00019ff01f012af8f9000315700001feff034003000fe8ff04fe00001156ef0002010ab01e013ff8f900032ae00001feff038002000fe8ff04fd000012aeee00019ff01f011578f9000315700001feff034003000fe8ff04fe00001156ef00020115701e013ff8f900032ae00001feff038002000fe8ff04fd000012aeee00019ff01f012af8f9000315700001feff034003000fe8ff04fe00001156ef0002010ab01e013ff8f900032ae00001feff038002000fe8ff04fd000012aeee00019ff01f011578f9000315700001feff034003000fe8ff04fe00001156ef00020115701c013ff8f900032ae00001feff01bffee6ff04fd000012aeee00019ff01c012af8f9000315700001feff007fe5ff04fe00001156ef0002010ab017013ff8f900042ae00001d5e15503000012aeee00019ff017011578f9000315700001e0aa0300001156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff017011578f900011570f8000040e600011156ef000201157019013ff8f900042ae000002afb000020e6000112aeee00019ff01a012af8f900041570000011fb000040e600011156ef0002010ab01c013ff8f9000b2ae00000208a0aa280a2a8a8e6000112aeee00019ff01d011578f9000b157000001111050451114440e600011156ef00020115701c013ff8f9000b2ae000002220820822088820e6000112aeee00019ff01d012af8f9000b157000001415440405510440e600011156ef0002010ab01c013ff8f9000b2ae000002020020802008820e6000112aeee00019ff01d011578f9000b157000001011440411110444e600011156ef00020115701c013ff8f9000b2ae00000280a8a82a0a28a28e6000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff019011578f9000315700000f9aa00a8e700011156ef000201157018013ff8f900032ae00001f9550054e7000112aeee00019ff01a012af8f900041570000080fa00000ce700011156ef0002010ab018013ff8f900032ae00001f900000ce7000112aeee00019ff01a011578f900041570000080fa00000ce700011156ef00020115701d013ff8f900062ae00001000007fe000230000ce7000112aeee00019ff01e012af8f90006157000008007c3fe000230000ce700011156ef0002010ab01d013ff8f900062ae000010001c3fe000230000ce7000112aeee00019ff01e011578f9000c1570000080036370f0ee7e000ce700011156ef00020115701d013ff8f9000c2ae0000100036399987030000ce7000112aeee00019ff01e012af8f9000c157000008003631b0c6030000ce700011156ef0002010ab01d013ff8f9000c2ae000010006331b0c6030000ce7000112aeee00019ff01e011578f9000c157000008007f31b0c6030000ce700011156ef00020115701d013ff8f9000c2ae0000100063399986033000ce7000112aeee00019ff01e012af8f9000c15700000800f7f70f0fc1e000ce700011156ef0002010ab018013ff8f900032ae00001f900000ce7000112aeee00019ff01a011578f900041570000080fa00000ce700011156ef000201157018013ff8f900032ae00001f900000ce7000112aeee00019ff01a012af8f900041570000080fa00000ce700011156ef0002010ab018013ff8f900032ae00001f900000ce7000112aeee00019ff01a011578f900041570000080fa00000ce700011156ef000201157019013ff8f900042ae000017ffaff00fce7000112aeee00019ff019012af8f9000315700000f9ff00fce700011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900017fe0dc000113feee00019ff012012af8f8000030dc00011002ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f900011570dc00011156ef0002010ab012013ff8f900012ae0dc000112aeee00019ff013011578f900011570dc00011156ef000201157012013ff8f900012ae0dc000112aeee00019ff013012af8f90001157fdcff01f156ef0002010ab012013ff8f900012ae0dc000102aeee00019ff013011578f900011540dc00010156ef000201157013013ff8f900032aaaaab2ddaa00aeee00019ff014012af8f9000015dd550365555556ef0002010ab013013ff8f900032aaaaab2ddaa00aeee00019ff014011578f9000015dd550365555556ef000201157013013ff8f900032aaaaab2ddaa00aeee00019ff014012af8f9000015dd550365555556ef0002010ab013013ff8f900032aaaaab2ddaa00aeee00019ff017011578f900033ffffff7e0ff03effffffeef000201157010013ff8f900007fdaff00feee00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009017ff8be0002011ff008010038bd0001801009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab098004802380000024f024002380000024f023e02380000024f023e000108013ff8bd00019ff009011578be000201157008013ff8bd00019ff009012af8be0002010ab008013ff8bd00019ff009011578be000201157008013ff8bd00019ff008012afdbd55010ab008013ffabdaa019ff008011560bd0001157008013fc0bd00011ff00d032aaaaab2c2aa04ab2aaaaab00c033ffffff7c1ff037ffffff0060015bb5500700c033ffffff7c1ff037ffffff00d032aaaaab2c2aa04ab2aaaaab00c033ffffff7c1ff037ffffff0060015bb5500700c033ffffff7c1ff037ffffff006007fbbff00f002b90002b90002b900a0008fa00083ff}}\par \pard \par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 11.2 Implementation\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab Pacmen are view objects together with a background process. This differs from the Tetris demo where a timer is used instead.\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab Each pacmen loops through its possible positions in the window. In each repetition the view-object is moved, other men are eaten, the progress bar is updated if necessary and a sleep is done.\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab Access to the data structures of the document which are shared by all pacmen is synchronized using the macro WITH-DOCUMENT.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 11.3 Source Code\par \pard\plain \s10 \f22\fs12 ;;; -*- Mode\:LISP;Syntax\: Common-Lisp;Package\:pac;Base\:10-*-\par \par (in-package \:GINA)\par (defginapackage \:pac)\par (in-package \:pac)\par (setq *sccs-id* "@(#)pacmen.lisp\tab 1.4  1/20/92")\par \par \par ;; This demo is much less than a real Pacman game. It only demonstrates\par ;; the use of multiple processes within a single application.\par ;; \par ;; - You can create a pacman by the menu entry NEW PACMAN. It will run\par ;;   down the window line by line at a random speed and disappear when\par ;;   the bottom is reached.\par ;; - On SUNs, the death of a pacmen is indicated by a "drip" sound.\par ;; - Because each pacman runs in his own process the user interface remains\par ;;   fully operable. The pacmen continue to run even during modal dialogs.\par ;; - You can start multiple pacmen (as many as your Lisp can stand).\par ;; - Try to kill a pacman by clicking the mouse at him.\par ;; - A pacman overtaking a slower one will eat it up.\par ;; - A pacman can also be started with a progress bar indicating how\par ;;   many lines are already done. The progress bar can also be used to kill\par ;;   the pacman.\par ;; - You can explicitly kill all pacmen. This is implicitly done by GINA\par ;;   when a document is closed.\par ;; \par ;; Implementation\:\par ;; - Pacmen are view objects together with a background process.\par ;;   This differs from the Tetris demo where a timer is used instead.\par ;; - Each pacmen loops through ist possible positions in the window. \par ;;   In each repetition the view-object is moved, other men are eaten,\par ;;   the progress bar is updated if necessary and a sleep is done.\par ;; - Access to the data structures of the document which are shared by all\par ;;   pacmen is synchronized using the macro WITH-DOCUMENT.\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class pacmen-application\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass pacmen-application (application)\par   ((name          \:initform "Pacmen")\par    (signature     \:initform "Pac")\par    (file-type     \:initform "pac")\par    (document-type \:initform 'pacmen-document \:allocation \:class)))\par \par (defun make-pacmen-application ()\par   (make-application \:class 'pacmen-application))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class pacmen-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass pacmen-document (document)\par   ((nr-of-pacmen \:accessor nr-of-pacmen \:initform 0)\par    (shell-width  \:initform 550)\par    (shell-height \:initform 550)))\par \par (defmethod create-windows((doc pacmen-document) &aux scroller)\par   (with-slots (main-shell main-view) doc\par     (setq main-shell (make-document-shell doc))\par     (setq scroller   (make-scroller main-shell))\par     (setq main-view  (make-view scroller\par \tab \tab \tab \tab \:document doc \par \tab \tab \tab \tab \:width 500 \:height 500))\par \par     (add-menu-command (main-menu main-shell)\par \tab \tab       "Play" "New Pacman" \par \tab \tab       (make-callback 'create-pacman doc)\par                       \:accelerator "P")\par     (add-menu-command (main-menu main-shell)\par \tab \tab       "Play" "New Pacman with Progress Bar" \par \tab \tab       (make-callback 'create-pacman doc \:progress-bar t))\par     (add-menu-command (main-menu main-shell)\par                       "Play" "Kill All Pacmen"\par                       (make-callback 'kill-all-background-processes doc))\par   ))\par \par (defmethod create-pacman ((doc pacmen-document) &key (progress-bar nil))\par   (when (not progress-bar)\par     (in-background-process (doc)\par       (run-pacman doc)))\par \par   (when progress-bar\par     (with-progress-bar\par         (doc \:kill-on-abort t \:centered nil \:modal nil\par          \:title (format nil "Pacman ~d" (1+ (nr-of-pacmen doc)))\par \tab  \:message "Running ...             ")\par       (run-pacman doc \:indicate-progess t))))\par \par (defmethod run-pacman ((doc pacmen-document) \par \tab \tab        &key (indicate-progess nil)\par \tab \tab        &aux pacman percent)\par   "code executed by each background process"\par    (setq pacman (make-pacman 40 (mod (incf (nr-of-pacmen doc)) 100)))\par    (with-document (doc)\par       (install pacman (main-view doc) 30 30))\par    (unwind-protect\par        (loop for y from 1 to 10 do\par \tab  (loop for x from 1 to 20 do\par \tab    (when indicate-progess\par \tab      ;; update progress bar\par              (setq percent (+ (* 10 (1- y)) (round (1- x) 2)))\par \tab      (if (= x 1)\par \tab \tab  (indicate-progress percent \par \tab \tab   \:new-message (format nil "Running in line ~d ..." y))\par \tab          (indicate-progress percent)))\par \par \tab    (setf (mouth-open pacman) (not (mouth-open pacman)))\par \tab    (setf (right pacman) (oddp y))\par \tab    (move pacman (if (right pacman) (* 20 x) (- 400 (* 20 x))) (* 40 y))\par \tab    (xlib\:display-force-output *display*)\par \par \tab    ;; eat other men if at same position\par \tab    (loop for p in (view-objects (main-view doc))\par \tab     when (and (not (eq p pacman))\par \tab \tab       (= (x-pos pacman) (x-pos p))\par \tab \tab       (= (y-pos pacman) (y-pos p)))\par \tab     do (kill-pacman p))\par \tab    \par \tab    (sleep (speed pacman))\par \tab    ))\par      ;; cleanup\par      (with-document (doc)\par \tab (deinstall pacman)\par         (xlib\:display-force-output *display*))\par      #-genera\par      (shell-command \par       "/usr/demo/SOUND/play -v100 /usr/demo/SOUND/sounds/drip.au &")))\par   \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class pacman\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass pacman (view-object)\par  ((mouth-open \:accessor mouth-open \:initform t)\par   (number     \:accessor number     \:initarg \:number)\par   (right      \:accessor right      \:initform t)\par   (speed      \:accessor speed      \:initform (+ 0.1 (* (random 3) 0.1)))\par   (process    \:accessor process    \:initarg \:process)))\par \par (defun make-pacman (size number)\par   (make-view-object size size \:class 'pacman \par \tab \tab     \:initargs (list \:process (xtk\:\:current-process)\par \tab \tab \tab \tab     \:number (format nil "~d" number))))\par \par (defmethod kill-pacman ((p pacman))\par   "kill pacmen, but wait until he is out of critical sections"\par   (kill-background-process (document (parent-view p)) (process p)))\par \par (defmethod draw ((p pacman) count x y width height)\par   (declare (ignore x y height))\par   (when (zerop count)\par     (if (not (mouth-open p))\par \tab (draw-arc p 0 0 width width 0 (* 2 pi) t)\par       (if (right p)\par \tab   (draw-arc p 0 0 width width 0.4 (- (* 2 pi) 0.8) t)\par \tab   (draw-arc p 0 0 width width (- 0.4 pi) (- (* 2 pi) 0.8) t)))\par     (xlib\:with-gcontext ((gcontext (parent-view p)) \:function boole-xor)\par       (draw-glyphs p 10 25 (number p)))))\par \par (defmethod button-press ((p pacman) code repetition x y)\par   "react to button-press event in the window"\par   (declare (ignore code repetition x y))\par   (kill-pacman p))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; main-program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (register-application "pac" 'pacmen-application "pac")\par '(make-pacmen-application)\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 12. Spreadsheet \par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 12.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 This demo shows how a typical Spreadsheet can be implemented with GINA. Arbitrary Lisp expressions containing cell references can be used as formulas. New functions can be programmed by example.\par \pard\plain \f20 {{\pict\macpict\picw402\pich350 1fb0ffffffff015d01911101a0008201000affffffff015d019198003200000000015c019000000000015c019000000000015c0190000102cf0002cf00060015d15500540c032aaaaaaed7aa03eaaaaaac060015d155005c0c032aaaaaaed7aa03eaaaaaac060015d155005c0c032aaaaaaed7aa03eaaaaaac060015d155005c0c032aaaaaaed7aa03eaaaaaac060015d155005c08012abfd3ff01faac060015d155005c0f032abaaaaedaaa06abaaaaeaaabaac0e0015f355005ff1ff00f5f155005c17032abaaaaef6aa00bff1ff00eaf7aa06abaaaaeaaabaac1b0015f35501583ffeff0ccff3ffffcffe73fe6667ff9cf5f155005c24032abaaaaef6aa01b39ffeff0ccff3ffffcffe73fe7e67ff90eaf7aa06abaaaaeaabbaac1b0015f35511539264870e4c3270e1867e724c24261c9cf5f155005c24032abaaaaef6aa11b8f12032648991264cce7e72266664c91ceaf7aa06abaaaaeaabbaac1f0015f355115e332333e4c8f3264ccffe72666664c99cf5f5550075fe55005c24032abaaaeef6aa11bf13270304ce332040cffe72666664099ceaf7aa06abaaaaeaabbaac220315557fd5f655115393273e64cf1327cfcffe72666664f99cf5f55500f5fe55005c24032abaaaaef6aa11b3912732648993264cca7f26664644c91ceaf7aa06abaaaaeaabbaac1b0015f3551158326787124c3330e1e67f066727261c9cf5f155005c18032abaaaaef6aa01bff3f2ff00eaf7aa06abaaaaebffbaac0f0015f355015ff3f2ff00f5f155005c18032abaaaaef6aa01bff3f2ff00eaf7aa06abaaaaeaaabaac0e031557fffdd9ff057fffdffff55c06003fd1ff00fc0801155ad3aa01b55408012abdd355016aac0801155ad30001755c08012abcd300016aac0801155ad30001755c08012abcd300016aac0801155ad30001755c08012abcd300016aac0801155ad30001755c08012abcd300016aac2005155a00001878fd0002e0c180fe0000e0fc0002018030f6000007f60001755c28102abc03fc181800003fc060c18003f00060fe00040780018030fd00010740fc000003f600016aac2710155a018c0018000018c060018001980060fe00030cc00180fc00010dc0fc000003f60001755c2d262abc018c78181e0018c763c3f0018c786e738ee0186ee3f0f078ee1f8018c79b6db1f1dc3b1f80f800016aac2d26155a01a0181833001a0ce0c180018ccc733199c01867318030cc733180180ccdb6d818e6673180f80001755c2c252abc01e0181861801e0c60c180018d86633198c018663180318663300018186db6d818c66330f700016aac2c25155a01a018187f801a0c60c180018dfe633198c0186631803186631f0018186db6d9f8c6631ff70001755c2d262abc01801818600018cc60c180018d80633198c018663180318663018018186db6db18c6630180f800016aac2d26155a01801818338018cce0c1980198ce733399c00cc7319830cc6331800ccccdb6db38c6673180f80001755c2c252abc03e07e7e1f003fc773f0f003f07cee1dcec00786e0f0fc78f7bf0007879dbeddddef3bbff700016aac0e01155af00002c00006e70001755c0e012abcf00002c00006e700016aac0f01155af100030780000fe70001755c08012abcd300016aac0801155ad30001755c08012abcd300016aac0801155ad30001755c08012abcd300016aac0801155ad30001755c08012abcd300016aac0801155ad30001755c08012abdd3ff01eaac0801155bd3ff01f55c08012ab8d300010aac08011558d30001155c08012ab8d300010aac08011558d30001155c10012ab8e400000ffaff0080f900010aac11011558fd000007eaff01f808f10001155c11012ab8fd000007eaff01f008f100010aac11011558fd000006ea00010808f10001155c17012ab8fd000006ea00011008fb55015000fa5502540aac17011558fd000006ea00010808fbaa01a800faaa02ac155c19012ab8fd000006ea0002100840fc0002180040fb00020c0aac19011558fd000006ea0002080880fc0002180080fb00020c155c19012ab8fd000006ea0002100840fc0002180040fb00020c0aac28011558fd000306000030fe00051e000003c180f6000a0808800000c00000180080fc00033c0c155c2a122ab800000300060000600000fe33001fc660c0f6000b10084ff000c00000180041d0fd00030c0c0aac2a12155800fe07000600006020006333000c6060c0f6000b0808863000c0000018008370fd00030c0c155c2a0f2ab800630f00060000c020006303000cfe60f600131008463771f8787718004633e3b87a3c0c0c0aac2b12155800630b000607f0c020006303000c61c060f600130808868398c0cc381800860031ccce660c0c155c2b122ab800631b00060000c1fc007e06000fc04060f600131008478318c1863018004600318d86c30c0c0aac2a0f1558007e1300060000c02000630c000cfe60f600130808868318c1fe3018008603f18d80ff0c0c155c2a0f2ab8006333000607f0c020006318000cfe60f600131008463318c1803018004606318d80c00c0c0aac2b12155800633f80060000c020006330000c666060f600130808863318ccce3018008336718cc6670c0c155c2b122ab800630300060000600000fe3f001fc3c0c0f6001310084ff7bc787c7e180041e3bbde7c3e3f0c0aac2109155800fe078006000060f90000c0f60002080880fc0002180080fb00020c155c21012ab8fd000306000030fa00010180f60002100840fc0002180040fb00020c0aac19011558fd000006ea0002080880fc0002180080fb00020c155c19012ab8fd000006ea0002100840fc0002180040fb00020c0aac19011558fd000006ea0002080880fc0002180080fb00020c155c19012ab8fd000006ea0002100840fc0002180040fb00020c0aac19011558fd000006ea00020808bffcff02f800bffbff02fc155c19012ab8fd000006ea000210087ffcff02f8007ffbff02fc0aac11011558fd000006ea00010808f10001155c11012ab8fd000007ea55015008f100010aac11011558fd000006eaaa01a808f10001155c0c012ab8e4000008f100010aac08011558d30001155c08012ab8d300010aac08011558d30001155c08012ab8d300010aac0801155fd3ff01f55c08012abdd355014aac08011558d30001155c08012ab8d300010aac08011558d30001155c08012ab8d300010aac08011558d30001155c0f012ab8fe000001daff04c000000aac0f011558fe000001daff04c00000155c10012ab8fe00010180db00048000000aac10011558fe00010180db0004400000155c10012ab8fe00010180db00048000000aac10011558fe00010180db0004400000155c10012ab8fe00010180db00048000000aac10011558fe00010180db0004400000155c10012ab8fe00010180db00048000000aac23011558fe0002018003fb00013f80fc00010f80fc0000fcf80000fefb0004400000155c23012ab8fe0002018003fb000131c0fc00013dc0fc0000c7f80000c0fb00048000000aac24011558fe000301800780fc000130c0fc00013040fc0000c3f80000c0fb0004400000155c24012ab8fe000301800480fc000130c0fc000060fb0001c180f90000c0fb00048000000aac24011558fe000301800cc0fc00013180fc000060fb0001c180f90000c0fb0004400000155c23012ab8fe000301800cc0fc00003ffb000060fb0001c180f90000fefb00048000000aac24011558fe000301801860fc00013180fc000060fb0001c180f90000c0fb0004400000155c24012ab8fe000301801fe0fc000130c0fc000060fb0001c180f90000c0fb00048000000aac24011558fe000301801860fc000130c0fc00013040fc0000c3f80000c0fb0004400000155c24012ab8fe000301803030fc000131c0fc00013dc0fc0000c7f80000c0fb00048000000aac24011558fe000301803030fc00013f80fc00010f80fc0000fcf80000fefb0004400000155c10012ab8fe00010180db00048000000aac10011558fe00010180db0004400000155c10012ab8fe00010180db00048000000aac10011558fe00010180db0004400000155c0f012ab8fe000001daaa048000000aac0f011558fe000001da5504400000155c08012ab8d300010aac08011558d30001155c08012ab8d300010aac08011558d30001155c09012ab8d500feaa00ac09011558d500fe55005c0f012ab9feff0081daff04c0bfffaaac0f011559feff0001daff04c07fff555c21092ab980000081d5555557f8550057fe55005df855005df855065d5580bfbe2aac100615598000010180db0004407f3e555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080bf3e2aac100615598000010180db0004407e3e555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080be3e2aac100615598000010180db0004407c1e555c21092ab983000081c0000002f8000002fe000008f8000008f80006080080bc1e2aac100615598f00010180db000440780e555c21092ab983000081c0000002f8000002fe000008f8000008f80006080080b80e2aac100615598300010180db00044073fe555c21092ab983000081c0000002f8000002fe000008f8000008f80006080080b7fe2aac100615598300010180db0004407ffe555c21092ab983000081c0000002f8000002fe000008f8000008f80006080080b0002aac100615598300010180db0004407002555c21092ab983000081c0000002f8000002fe000008f8000008f80006080080b0062aac100615598300010180db0004407006555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080b0062aac100615598000010180db0004407006555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080b0062aac1006155980000101d5db5504407006555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080b0062aac100615598000010180db0004407006555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080b0062aac100615598000010180db0004407006555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080b0062aac150615598f80010180fe00017c0ee00004407006555c230b2ab99cc00081c0000002ce1efa000002fe000008f8000008f80006080080b0062aac1506155998c0010180fe0001c636e00004407006555c230b2ab981c00081c00000020666fa000002fe000008f8000008f80006080080b0062aac150615598180010180fe00013cc6e00004407006555c230b2ab987000081c000000206c6fa000002fe000008f8000008f80006080080b0062aac150615598e00010180fe000106ffe00004407006555c230b2ab99c000081c0000002c606fa000002fe000008f8000008f80006080080b0062aac150615599800010180fe0001ce06e00004407006555c230b2ab99fc00081c00000027c06fa000002fe000008f8000008f80006080080b0062aac100615598000010180db00044073fe555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080b7fe2aac100615598000010180db0004407ffe555c21092ab980000081d5555557f8550057fe55005df855005df855065d5580bffe2aac100615598000010180db0004407ffe555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080bffe2aac100615598000010180db0004407ffe555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080bffe2aac100615598000010180db0004407ffe555c230b2ab98f800081c00000027c7efa000002fe000008f8000008f80006080080bffe2aac1506155999c0010180fe0001e660e00004407ffe555c230b2ab998c00081c0000002c6c0fa000002fe000008f8000008f80006080080bffe2aac1506155980c0010180fe00010ef8e00004407ffe555c230b2ab987800081c00000020c1cfa000002fe000008f8000008f80006080080bffe2aac1506155980c0010180fe00013806e00004407ffe555c230b2ab980c00081c00000027006fa000002fe000008f8000008f80006080080bffe2aac1506155998c0010180fe0001e0c6e00004407ffe555c230b2ab999c00081c0000002c0ecfa000002fe000008f8000008f80006080080bffe2aac150615598f80010180fe0001fe78e00004407ffe555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080bffe2aac100615598000010180db0004407ffe555c1f092ab980000081c0000003f7c3fe000008f8000008f80006080080bffe2aac1509155980000101d5555557f7ffe85504407ffe555c1f092ab980000081c0000007f7fffe000008f8000008f80006080080bffe2aac170915598000010180000003f800000fe80004407ffe555c21092ab980000081c0000003f800000ffe000008f8000008f80006080080bffe2aac170915598000010180000003f800000ce80004407ffe555c21092ab980000081c0000003f800000efe000008f8000008f80006080080bffe2aac190b155981c00101800000077e7cfa00000ce80004407ffe555c230b2ab983c00081c000000760eefa00000efe000008f8000008f80006080080bffe2aac190b155986c0010180000007c0c6fa00000fe80004407ffe555c230b2ab98cc00081c0000007f8c6fa00000ffe000008f8000008f80006080080bffe2aac190b155998c00101800000031ce6fa00000fe80004407ffe555c230b2ab998c00081c0000003067efa00000ffe000008f8000008f80006080080bffe2aac190b15599fe00101800000030606fa00000ce80004407ffe555c230b2ab980c00081c0000003c6c6fa00000efe000008f8000008f80006080080bffe2aac190b155980c0010180000007eccefa00000ce80004407ffe555c230b2ab980c00081c0000007787cfa00000efe000008f8000008f80006080080bffe2aac170915598000010180000007f800000fe80004407ffe555c1f092ab980000081c0000007f7fffe000008f8000008f80006080080bffe2aac150915598000010180000003f7ffe80004407ffe555c21092ab980000081d5555557f8550057fe55005df855005df855065d5580bffe2aac100615598000010180db0004407ffe555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080bffe2aac130915598000010180000007de0004407ffe555c21092ab980000081c0000007f8000002fe000008f8000008f80006080080bffe2aac170915598000010180000007f8000007e80004407ffe555c21092ab98fc00081c0000007f8000007fe000008f8000008f80006080080bffe2aac140615598c00010180f5000007e80004407ffe555c21092ab998000081c0000002f8000007fe000008f8000008f80006080080bffe2aac100615599f00010180db0004407ffe555c21092ab983800081c0000002f8000002fe000008f8000008f80006080080bffe2aac1309155980c0010180000007de0004407ffe555c21092ab980c00081c0000007f8000002fe000008f8000008f80006080080bffe2aac1709155998c0010180000007f8000007e80004407ffe555c21092ab99d800081c0000007f8000007fe000008f8000008f80006080080bffe2aac140615598f00010180f5000007e80004407ffe555c21092ab980000081c0000002f8000007fe000008f8000008f80006080080bffe2aac100615598000010180db0004407ffe555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080bffe2aac1309155980000101d5555557de5504407ffe555c21092ab980000081c0000007f8000002fe000008f8000008f80006080080bffe2aac170915598000010180000007f8000007e80004407ffe555c21092ab980000081c0000007f8000007fe000008f8000008f80006080080bffe2aac140615598000010180f5000007e80004407ffe555c21092ab980000081c0000002f8000007fe000008f8000008f80006080080bffe2aac100615598780010180db0004407ffe555c21092ab98ec00081c0000002f8000002fe000008f8000008f80006080080bffe2aac130915598cc0010180000007de0004407ffe555c21092ab998000081c0000007f8000002fe000008f8000008f80006080080bffe2aac170915599b80010180000007f8000007e80004407ffe555c21092ab99ec00081c0000007f8000007fe000008f8000008f80006080080bffe2aac1406155998c0010180f5000007e80004407ffe555c21092ab998c00081c0000002f8000007fe000008f8000008f80006080080bffe2aac100615598dc0010180db0004407ffe555c21092ab987800081c0000002f8000002fe000008f8000008f80006080080bffe2aac130915598000010180000007de0004407ffe555c21092ab980000081c0000007f8000002fe000008f8000008f80006080080bffe2aac170915598000010180000007f81e001fe80004407ffe555c1f092ab980000081d5555557f75ffe55005df855005df855065d5580bffe2aac170915598000010180000006f81e001fe80004407ffe555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080bffe2aac100615598000010180db0004407ffe555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080bffe2aac100615598000010180db0004407ffe555c21092ab99fc00081c0000002f8000002fe000008f8000008f80006080080bffe2aac1006155980c0010180db0004407ffe555c21092ab981800081c0000002f8000002fe000008f8000008f80006080080bffe2aac100615598180010180db0004407ffe555c21092ab983000081c0000002f8000002fe000008f8000008f80006080080bffe2aac100615598300010180db0004407ffe555c21092ab986000081c0000002f8000002fe000008f8000008f80006080080bffe2aac100615598600010180db0004407ffe555c21092ab98c000081c0000002f8000002fe000008f8000008f80006080080bffe2aac100615598c00010180db0004407ffe555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080bffe2aac100615598000010180db0004407ffe555c21092ab980000081c0000003f8ff00fefe000008f8000008f80006080080bffe2aac1509155980000101d5555557f7ffe85504407ffe555c21092ab980000081c0000006f8000006fe000008f8000008f80006080080bffe2aac170915598000010180000006f8000006e80004407ffe555c21092ab980000081c0000006f8000006fe000008f8000008f80006080080bffe2aac170915598000010180000006f8000006e80004407ffe555c21092ab980000081c0000006f8000006fe000008f8000008f80006080080bffe2aac170915598f80010180000006f8000006e80004407ffe555c21092ab99dc00081c0000006f8000006fe000008f8000008f80006080080bffe2aac1709155998c0010180000006f8000006e80004407ffe555c21092ab998c00081c0000006f8000006fe000008f8000008f80006080080bffe2aac170915598f80010180000006f8000006e80004407ffe555c21092ab99dc00081c0000006f8000006fe000008f8000008f80006080080bffe2aac1709155998c0010180000006f8000006e80004407ffe555c21092ab998c00081c0000006f8000006fe000008f8000008f80006080080bffe2aac1709155998c0010180000006f8000006e80004407ffe555c21092ab98f800081c0000006f8000006fe000008f8000008f80006080080bffe2aac170915598000010180000006f8000006e80004407ffe555c21092ab980000081c0000006f8000006fe000008f8000008f80006080080bffe2aac170915598000010180000007f8ff00fee80004407ffe555c1f092ab980000081d5555557f7fffe55005df855005df855065d5580bffe2aac100615598000010180db0004407ffe555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080bffe2aac100615598000010180db0004407000555c21092ab980000081c0000002f8000002fe000008f8000008f80006080080b0062aac100615598000010180db000440780e555c21092ab98f800081c0000002f8000002fe000008f8000008f80006080080b80e2aac100615599dc0010180db0004407c1e555c21092ab998c00081c0000002f8000002fe000008f8000008f80006080080bc1e2aac1006155998c0010180db0004407e3e555c21092ab99cc00081c0000002f8000002fe000008f8000008f80006080080be3e2aac100615598fc0010180db0004407f7e555c21092ab980c00081c0000002f8000002fe000008f8000008f80006080080bf7e2aac1006155998c0010180db0004407ffe555c0f012ab9feaa0081daaa0480b0002aac0f011559fe550001da5504406000555c09012ab8d500feaa00ac09011558d500fe55005c08012ab8d300010aac08011558d30001155c08012ab8d300010aac08011558d30001155c08012ab8d300010aac08011ff8d3000117fc0f012aa8fe000001daff04c000000aac0f011558fe000001daff04800000155c17012ab8fe000201ffc8fc00003fe4ff01f9fffe00010aac17011558fe000201ff18fc00007fe4ff01f87ffe0001155c15012ab8fe000201fc38fc00e3ff01f81ffe00010aac15011558fe000201f038fc00e3ff01f807fe0001155c15012ab8fe000201c038fc00e3ff01f801fe00010aac15011558fe0002018038fc00e3ff01f807fe0001155c15012ab8fe000201fc38fc00e3ff01f81ffe00010aac15011558fe000201ff38fc00e3ff01f87ffe0001155c15012ab8fe000201fff8fc00e3ff01f9fffe00010aac13011558fe000201fff9deff01fbfffe0001155c13012ab8fe000201fffbdeff01fbfffe00010aac0d011558fe00010180d80001155c0c012ab8fe000001d700010aac08011558d30001155c08012ab8d300010aac0701155dd255005c07012abad2aa00ac060015d155005c0c032aaaaaaed7aa03eaaaaaac060015d155005c0c032aaaaaaed7aa03eaaaaaac060015d155005c0c032aaaaaaed7aa03eaaaaaac060015d155005c06002fd1ff00fc06001fd1ff00fc02cf00a00083ff}}\par \pard \par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 12.2 User Interface\par \pard\plain \s4\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab Strings can be entered into cells via the input field at top\line (ENTER-button or RETURN-Key).\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab Input editing can be cancelled using the CANCEL-button.\par \'a5\tab Columns can be resized by dragging the vertical lines with the mouse.\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab If the user subsequently resizes two columns to the same width, the program suggests to resize all columns. The question need not be answered.\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab The global font of a sheet can be changed.\par \'a5\tab Grid lines can be shown or hidden.\par \'a5\tab Cells can be selected using the mouse.\par \pard \s4\fi-283\li283\ri1\sb40\sa40 \'a5\tab A cell name can be inserted into the input edited by any special click.\line This is important for formula specification.\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab Borders can be drawn around selected cells.\par \'a5\tab All selected cells can be cleared.\par \'a5\tab The selected cells can be copied to the clipboard.\par \'a5\tab The clipboard can be pasted into selected cells.\par \'a5\tab Pasting is repeated if target area is at least twice as large as clipboard.\par \'a5\tab Unlimited undo/redo is possible for all editing operations.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 12.3 Computation\:\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab The Lisp evaluator is used for formula evaluation.\par \'a5\tab Cell contents entered are regarded as numbers, lists or strings.\par \'a5\tab Formulas start with an equal sign (=).\par \'a5\tab A formula is any Lisp expresssion containing cell references like A1.\par \'a5\tab Examples\: =(* A1 (+ A2 A3)) or =(list A1 A2 A3 A4)\par \'a5\tab Syntax errors in formulas lead to a beep.\par \'a5\tab SHOW ERROR MESSAGE displays the last error diagnostic.\par \'a5\tab On errors during formula evaluation <error> is displayed in the cell.\par \'a5\tab Normally the values of formulas are shown.\par \'a5\tab With SHOW FORMULAS, formulas can be displayed in the sheet instead.\par \'a5\tab Formulas are evaluated after every modification of a cell.\par \'a5\tab Formulas can be replicated by COPY/PASTE.\par \'a5\tab While pasting, cell references in formulas are automatically transformed.\par \'a5\tab References into the copied selection are regarded as relative.\par \'a5\tab All other references are regarded as absolute.\par \pard \s4\fi-283\li283\ri1\sb40\sa40 \'a5\tab New functions can be defined "by example"\:\line Entering (define foo (A1 A2 A3) A4) into any cell defines a new function foo with three parameters. The formulas connecting A1,A2 and A3 to A4 are used as the body of the function (which is printed on standard-output).\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 12.4 Implementation\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab There is a complex draw method for the main-view with many parameters which draw the gridlines and the cell contents in diffrent fonts, with and without borders etc.\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab Column and row headers are also views in a scroller but without scrollbars. The views are scrolled synchronously with the main view.\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab Feedback during selection of cells is not implemented by overriding the method {\f22 draw-feedback}. Instead {\f22 track-mouse} is overridden. The internal data structure is immediatly entered and a part of the main-view is redrawn. This is because the selection is permanently displayed and is not only a temporary feedback.\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab The Lisp reader is used to parse constants and formulas entered into cells. In formulas, cell references (like e.g. A1) are internally replaced by an accessor expression for that cell.\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab The Lisp evaluator is used to compute the result of formulas\par \'a5\tab Cell references replaced by accessor expressions.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 12.5 Limitations and Extensions\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab Currently a formula also recomputes all formulas it depends on. This leads to  superfluos recalculations in some cases.\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 \par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 13. Hyper-GINA\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 13.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 This demo combines concepts from the GINA Interface Builder and from Hyper\-card. Simple Interfaces can be build and immediately be run. Widgets can be placed into a drawing area. Lisp code is directly attached to the callbacks of widgets and interpreted. Several Hyper-GINA documents are included in the distribution.\par \pard\plain \f20 {{\pict\macpict\picw289\pich233 2f66ffffffff00e801201101a0008201000affffffff00e801209800480000000001ce02400000000001ce023e0000000000e7011f000102b90006002abbaa00a008fe55005dbe5500500a002abfaa00abfeaa00b008fe55005dbe5500700a002abfaa00abfeaa00b008fe55005dbe5500700a002abfaa00abfeaa00b008fe55005dbe5500700a002abfaa00abfeaa00b00a01557fbfff037ffff57006002abbaa00b009035575555dbe55007014002ae9aa00aff0ff00faecaa06aeaaabaaaaeab011035575555dec550057f0ff00fde655007021002ae9aa01ace7fdff0cf07339e7ff813fffff83fffffaecaa06aeaaabaaaaeab01e035575555dec550154e7fdff0ce73319c3ff9c3fffff39fffffde655007022002ae9aa12ace4e49c327fcff319db9f9c30ce7e7f864e4aecaa06aeaaabaaaeeab01f035575555dec551254e4e449907fcff329999f9c264e7e7f32248de655007022002ae9aa12ac064cc991ffcc332999ff813e64fe613264caecaa06aeaaabaaaeeab02303557555ddec551254e64cc813c1cf333181ff9f3064fe793264cdea5500d5fe55007024022aaaffebaa12ace71cc9f3ffcf33313cff9f2671fe793264caecaa06aeababaaaeeab01f035575555dec551254e71c4993ffe733393c9f9f2671ff3932648de655007022002ae9aa12ace79c9c33fff0b3393c9f9f3139ff8586664aecaa06aeaaabaaaeeab01a035575555dec550257ffbcf7ff00fbfdff00cde9550357fd55701b002ae9aa02afff3cf7ff00f3feff01fccaecaa06aeaaabaaaaeab018035575555dec550257fe7cf7ff00e7feff01fe1de65500700a032aaffffbbfff01eab007007fbcff01dff008012ab5bd55012ab00801557abdaa01d57009012ab4be000201aab009015578be000201d57009012ab4be000201aab009015578be000201d57009012ab4be000201aab009015578be000201d57009012ab4be000201aab009015578be000201d57023052ab4000030f0fe000201c183fe000101c0fa00073800000e0c000006dc000201aab02710557807f8303000007f80c1830007e000c0fe000b074000001801f0060c000006dc000201d57027102ab40318003000003180c00300033000c0fe00070dc0000018007006fe000006dc000201aab0282055780318f0303c00318ec787e00318f0dce71dc018cf8771d800d8767c738fcfc0dd000201d570271f2ab40340303066003419c18300031998e66333801800c3833800d8ce0c3198c6dc000201aab0271f557803c03030c3003c18c18300031b0cc66331801800c3031800d8c60c319806dc000201d570271f2ab403403030ff003418c18300031bfcc6633180180fc30318018cc60c318f86dc000201aab0271f557803003030c0003198c18300031b00c66331801818c3031801fcc60c3180c6dc000201d57028202ab40300303067003199c1833003319ce66733800cd9c30338018cce0c3398c660dd000201aab02820557807c0fcfc3e007f8ee7e1e007e0f9dc3b9d80078ee7e1dc03de770c1ddf83c0dd000201d57012012ab4f100010180f900000cd9000201aab012015578f100010180f900000cd9000201d57011012ab4f100000ff8000078d9000201aab009015578be000201d57009012ab4be000201aab009015578be000201d57009012ab4be000201aab009015578be000201d57009012ab4be000201aab009015578be000201d57009012ab4be000201aab00801557bbdff01d57008012ab7bdff01aab008015570bd0001557008012ab0bd00012ab008015570bd0001557008012ab0bd00012ab008015570bd0001557008012ab0bd00012ab008015570bd0001557008012ab0bd00012ab008015570bd0001557008012ab0bd00012ab008015570bd0001557008012ab0bd00012ab008015570bd0001557008012ab0bd00012ab008015570bd0001557008012ab0bd00012ab008015570bd0001557008012ab0bd00012ab008015570bd0001557008012ab0bd00012ab008015570bd000155700f012ab3f6ff0007ccff0400fffe2ab010015572f7aa01ab87ccff0400fffc557011012ab3f700010106cd00050200fef82ab011015572f700010186cd00050100fcf8557012022ab315f855015106cd00050200fcf82ab0120255722af8aa01a986cd00050100f8f8557012022ab315f855015906cd00050200f8f82ab01202557228f800013986cd00050100f078557012022ab310f800013906cd00050200f0782ab01202557228f800013986cd00050100e038557012022ab310f800013906cd00050200e0382ab01202557228f800013986cd00050100cff8557012022ab310f800013906cd00050200dff82ab01202557228f800013986cd00050100fff8557012022ab310f800013906cd00050200c0002ab0130355722802f900013986cd00050100c008557016062ab31005003de0fc00013906cd00050200c0182ab01e06557228088018c0fc00013986e800007febff00f0fe00050100c0185570260d2ab310104018c7e3c3b800003906e800057ce20010000ef1000101f0fe00050200c0182ab0260d557228202018cc6661c000003986e800017d12fe000011f1000101f0fe00050100c0185570260d2ab310401018cc0c318000003906e800057d0796316341f1000101f0fe00050200c0182ab0260d557228801c18c7cff18000003986e800057ce219119486f1000101f0fe00050100c0185570250d2ab310e03818c06c018000003906e80005401210111308f0000010fe00050200c0182ab0250d557228707018cc66718000003986e80005411250111410f0000010fe00050100c0185570250d2ab31038e00f8fc3e3f000003906e8000540e19039139ff0000010fe00050200c0182ab021045572281dc0fa00013986e8000040fe00010440f0000010fe00050100c018557021042ab3100f80fa00013906e8000040fe00010380f0000010fe00050200c0182ab01c0355722807f900013986e8000043ecff01fc10fe00050100c01855701c032ab31002f900013906e8000043ecff01f810fe00050200c0182ab01b02557228f800013986e8000043ec00010410fe00050100c01855701b022ab310f800013906e8000043ec00010810fe00050200c0182ab01b02557228f800013986e8000043ec00010410fe00050100c01855701b022ab310f800013906e8000043ec00010810fe00050200c0182ab01b02557228f800013986e8000043ec00010410fe00050100c01855701b022ab310f800013906e8000043ec00010810fe00050200c0182ab01b02557228f800013986e8000043ec00010410fe00050100c01855701d022ab317f8ff01f906e800024301e8ee00010810fe00050200c0182ab01d0255722ff8ff01f986e80002430338ee00010410fe00050100c018557021022ab31ff8ff01f906e80006430618f1dc3b80f200010810fe00050200c0182ab01f015572f700010186e8000543060198e667f100010410fe00050100c018557020022ab315f855015106e800054306030cc663f100010810fe00050200c0182ab0200255722af8aa01a986e8000543067f0cc663f100010410fe00050100c018557020022ab315f855015906e8000543061b0cc663f100010810fe00050200c0182ab02002557228f800013986e8000543031998c667f100010410fe00050100c018557020022ab310f800013906e800054301f8f1ef3bf100010810fe00050200c0182ab01f02557228f800013986e8000043fd000003f100010410fe00050100c01855701f022ab310f800013906e8000043fd000003f100010810fe00050200c0182ab01f02557228f800013986e8000043fd00001ef100010410fe00050100c01855701b022ab310f800013906e8000043ec00010810fe00050200c0182ab01b02557228f800013986e8000043ec00010410fe00050100c01855701b022ab310f800013906e8000043ec00010810fe00050200c0182ab0210355722802fe000607800000603986e8000043ec00010410fe00050100c0185570210d2ab31005000f4001800000603906e8000043ec00010810fe00050200c0182ab0210d557228088019c001800000603986e8000043ec00010410fe00050100c0185570210d2ab310104018c78181e0f4fc3906e8000043ec00010810fe00050200c0182ab0210d5572282020180cc183319c603986e8000043ec00010410fe00050100c0185570210d2ab31040100f9861861b0c603906e8000043ec00010810fe00050200c0182ab0210d557228801c00dfe187fb00603986e8000043ec00010410fe00050100c0185570210d2ab310e03818d801860300603906e8000043ec00010810fe00050200c0182ab0210d55722870701ccce183398c663986e8000043ec00010410fe00050100c0185570210d2ab31038e01787c7e1f0f83c3906e8000043ec00010810fe00050200c0182ab01d045572281dc0fa00013986e8000043ec55015410fe00050100c01855701d042ab3100f80fa00013906e8000042ecaa01a810fe00050200c0182ab01b0355722807f900013986e8000040eb000010fe00050100c01855701b032ab31002f900013906e8000040eb000010fe00050200c0182ab01d02557228f800013986e8000340000060ee000010fe00050100c01855701d022ab310f800013906e8000340000020ee000010fe00050200c0182ab01e02557228f800013986e8000440089c2227ef000010fe00050100c01855701f022ab310f800013906e80005400882222880f0000010fe00050200c0182ab02002557228f800013986e800057c051e222f80f1000101f0fe00050100c01855701f022ab310f800013906e800047c05222268f0000101f0fe00050200c0182ab01f02557228f800013986e800047c021e71a7f0000101f0fe00050100c01855701b022ab317f8ff01f906e800007cec000101f0fe00050200c0182ab01a0255722ff8ff01f986e800007febff00f0fe00050100c018557012022ab31ff8ff01f906cd00050200c0182ab011015572f700010186cd00050100c018557012022ab315f855015106cd00050200c0182ab0120255722af8aa01a986cd00050100c018557012022ab315f855015906cd00050200c0182ab01202557228f800013986cd00050100c018557012022ab310f800013906cd00050200c0182ab01202557228f800013986cd00050100c018557012022ab310f800013906cd00050200c0182ab01202557228f800013986cd00050100c018557012022ab310f800013906cd00050200c0182ab01202557228f800013986cd00050100c018557012022ab310f800013906cd00050200c0182ab0180d5572280200000600006000003986cd00050100c0185570180d2ab31005000f4600006000003906cd00050200c0182ab01606557228088019c6fc00013986cd00050100c0185570180d2ab310104018cfc771e3b8773906cd00050200c0182ab0180d55722820201806038061ccce3986cd00050100c0185570180d2ab31040100f860300618cc63906cd00050200c0182ab0180d557228801c00c60300618cc63986cd00050100c0185570180d2ab310e03818c60300618cc63906cd00050200c0182ab0180d55722870701cc66300618cce3986cd00050100c0185570200d2ab31038e01783c7e1fbde763906fc000001e3ff00c0f200050200c0182ab024045572281dc0fb0002063986fc000601f78020800010ea000107c0f200050100c018557024042ab3100f80fb0002063906fc000601f24020800030ea000107c0f200050200c0182ab0230355722807fa00023c3986fc000601f25179e39650ea000107c0f200050100c018557022032ab31002f900013906fc000601f39120845910ea000107c0f200050200c0182ab02002557228f800013986fc000601025120845110e9000040f200050100c018557020022ab310f800013906fc000601025324945110e9000040f200050200c0182ab02002557228f800013986fc000601078d1863917ce9000040f200050100c01855701a022ab310f800013906fc000001e3000040f200050200c0182ab01a02557228f800013986fc000001e3000040f200050100c01855701c022ab310f800013906fc00010105e555015040f200050200c0182ab01c02557228f800013986fc0001010ae5aa01b040f200050100c01855701c022ab317f8ff01f906fc00010104e500013040f200050200c0182ab01c0255722ff8ff01f986fc00010108e500013040f200050100c01855701c022ab31ff8ff01f906fc00010104e500013040f200050200c0182ab01b015572f700010186fc00010108e500013040f200050100c01855701c022ab315f855015106fc00010104e500013040f200050200c0182ab01c0255722af8aa01a986fc00010108e500013040f200050100c01855701c022ab315f855015906fc00010104e500013040f200050200c0182ab01c02557228f800013986fc00010108e500013040f200050100c01855701c022ab310f800013906fc00010104e500013040f200050200c0182ab01c02557228f800013986fc00010108e500013040f200050100cff855701c022ab310f800013906fc00010104e500013040f200050200dff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab0210355722802fd0005018000003986fc00010108e500013040f200050100fff85570220d2ab31005003fc000018000003906fc00010104e500013040f200050200fff82ab0220d557228088036c000018000003986fc00010108e500013040f200050100fff85570220d2ab310104036c78e73f000003906fc00010104e500013040f200050200fff82ab0220d5572282020060cc6618000003986fc00010108e500013040f200050100fff85570220d2ab3104010061863c18000003906fc00010104e500013040f200050200fff82ab0220d557228801c061fe1818000003986fc00010108e500013040f200050100fff85570220d2ab310e038061803c18000003906fc00010104e500013040f200050200fff82ab0220d5572287070060ce6619800003986fc00010108e500013040f200050100fff85570220d2ab31038e00f07ce70f000003906fc00010104e500013040f200050200fff82ab01e045572281dc0fa00013986fc00010108e500013040f200050100fff855701e042ab3100f80fa00013906fc00010104e500013040f200050200fff82ab01d0355722807f900013986fc00010108e500013040f200050100fff855701d032ab31002f900013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab317f8ff01f906fc00010104e500013040f200050200fff82ab01c0255722ff8ff01f986fc00010108e500013040f200050100fff855701c022ab31ff8ff01f906fc00010104e500013040f200050200fff82ab01b015572f700010186fc00010108e500013040f200050100fff855701c022ab315f855015106fc00010104e500013040f200050200fff82ab01c0255722af8aa01a986fc00010108e500013040f200050100fff855701c022ab315f855015906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab0210355722802fd000007fe00013986fc00010108e500013040f200050100fff8557026082ab310050039e00003fe00013906fc00010104f50000f4f200013040f200050200fff82ab02708557228088018c00003fe00013986fc00010108f60001019cf200013040f200050100fff855702b0d2ab31010401cdcfb6370f0ee3906fc00010104f60005030c78ee1dc0f600013040f200050200fff82ab02b0d55722820201ccc6db39998703986fc00010108f600050300cc733380f600013040f200050100fff855702b0d2ab31040101acc6db31b0c603906fc00010104f60005030186633180f600013040f200050200fff82ab02b0d557228801c1acc6db31bfc603986fc00010108f60005033f86633180f600013040f200050100fff855702b0d2ab310e03819cc6db31b00603906fc00010104f60005030d86633180f600013040f200050200fff82ab02b0d557228707019ccedb3999c603986fc00010108f60005018ccc633380f600013040f200050100fff855702a0d2ab31038e03cc77dbf70f8fc3906fc00010104f50004fc78f79d80f600013040f200050200fff82ab023045572281dc0fa00013986fc00010108f200010180f600013040f200050100fff8557023042ab3100f80fa00013906fc00010104f200010180f600013040f200050200fff82ab0210355722807f900013986fc00010108f200000ff500013040f200050100fff855701d032ab31002f900013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab317f8ff01f906fc00010104e500013040f200050200fff82ab01c0255722ff8ff01f986fc00010108e500013040f200050100fff855701c022ab31ff8ff01f906fc00010104e500013040f200050200fff82ab01b015572f700010186fc00010108e500013040f200050100fff855701c022ab315f855015106fc00010104e500013040f200050200fff82ab01c0255722af8aa01a986fc00010108e500013040f200050100fff855701c022ab315f855015906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab0220355722802fe000603018000003986fc00010108e500013040f200050100fff85570220d2ab31005003f8003018000003906fc00010104e500013040f200050200fff82ab0220d557228088018c003018000003986fc00010108e500013040f200050100fff85570220d2ab310104018dce7e3f0f1dc3906fc00010104e500013040f200050200fff82ab0220d557228202018cc63018198e63986fc00010108e500013040f200050100fff85570220d2ab31040101f8c6301830cc63906fc00010104e500013040f200050200fff82ab0220d557228801c18cc6301830cc63986fc00010108e500013040f200050100fff85570220d2ab310e03818cc6301830cc63906fc00010104e500013040f200050200fff82ab0220d557228707018cce3319998c63986fc00010108e500013040f200050100fff85570220d2ab31038e03f8771e0f0f1ef3906fc00010104e500013040f200050200fff82ab01e045572281dc0fa00013986fc00010108e500013040f200050100fff855701e042ab3100f80fa00013906fc00010104e500013040f200050200fff82ab01d0355722807f900013986fc00010108e500013040f200050100fff855701d032ab31002f900013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab310f800013906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc00010108e500013040f200050100fff855701c022ab317f8ff01f906fc00010104e500013040f200050200fff82ab01c0255722ff8ff01f986fc00010108e500013040f200050100fff855701c022ab31ff8ff01f906fc00010104e500013040f200050200fff82ab01b015572f700010186fc00010108e500013040f200050100fff855701c022ab315f855015106fc00010104e500013040f200050200fff82ab01c0255722af8aa01a986fc00010108e500013040f200050100fff855701c022ab315f855015906fc00010104e500013040f200050200fff82ab01c02557228f800013986fc0001010be5ff01f040f200050100fff855701c022ab310f800013906fc00010107e5ff01f040f200050200fff82ab01a02557228f800013986fc000001e3000040f200050100fff855701a022ab310f800013906fc000001e3000040f200050200fff82ab01e02557228f800013986fc00040100000180e7000040f200050100fff855701e022ab310f800013906fc000001fe000080e7000040f200050200fff82ab01f02557228f800013986fc000501002270889ce8000040f200050100fff855701f022ab310f800013906fc00050100220888a2e8000040f200050200fff82ab0260d5572280200000180018000003986fc000501f0147888bee9000107c0f200050100fff85570260d2ab31005003e0180018000003906fc000501f0148889a0e9000107c0f200050200fff82ab0260d5572280880180000018000003986fc000501f00879c69ce9000107c0f200050100fff85570220d2ab3101040180783f3f000003906fc000101f0e5000107c0f200050200fff82ab0200d5572282020180186318000003986fc000001e3ff00c0f200050100fff85570180d2ab3104010180186018000003906cd00050200fff82ab0180d557228801c18c183e18000003986cd00050100fff85570180d2ab310e03818c180318000003906cd00050200fff82ab0180d557228707018c186319800003986cd00050100fff85570180d2ab31038e03fc7e7e0f000003906cd00050200fff82ab014045572281dc0fa00013986cd00050100fff8557014042ab3100f80fa00013906cd00050200fff82ab0130355722807f900013986cd00050100fff8557013032ab31002f900013906cd00050200fff82ab01202557228f800013986cd00050100fff8557012022ab310f800013906cd00050200fff82ab01202557228f800013986cd00050100fff8557012022ab310f800013906cd00050200fff82ab01202557228f800013986cd00050100fff8557012022ab310f800013906cd00050200fff82ab01202557228f800013986cd00050100fff8557012022ab317f8ff01f906cd00050200fff82ab0120255722ff8ff01f986cd00050100fff8557012022ab31ff8ff01f906cd00050200fff82ab011015572f700010186cd00050100fff8557012022ab315f855015106cd00050200fff82ab0120255722af8aa01a986cd00050100fff8557012022ab315f855015906cd00050200fff82ab01202557228f800013986cd00050100fff8557012022ab310f800013906cd00050200fff82ab01202557228f800013986cd00050100fff8557012022ab310f800013906cd00050200fff82ab01202557228f800013986cd00050100fff8557012022ab310f800013906cd00050200fff82ab01202557228f800013986cd00050100fff8557012022ab310f800013906cd00050200fff82ab01e0355722802fd000503c000003986f7000007dbff08fe00000100fff85570260d2ab31005000f400000c000003906f7000407ce00101fe2000b8008403e00000200fff82ab02a0d557228088019c00000c000003986f7000407d1001001e7000001fefffe0009403e00000100fff855702b0d2ab310104018c7a7c0c0f0003906f7000407d038d382e7000001feff0c018b18f03e00000200fff82ab02b0d5572282020180ce060c198003986f7000407d0453446e7000001feff0c008c88403e00000100fff855702b0d2ab31040100f986060c30c003906f7000404104517c1e7000001feff0c0ffffffe0200000200fff82ab02b0d557228801c00d807e0c3fc003986f700040411453411e7000001feff0c008888480200000100fff855702b0d2ab310e03818d80c60c300003906f70004040e38d38ee7000001feff0c01c89c300200000200fff82ab0250d55722870701ccc6ce0c19c003986f7000004e3000001fefffd00080200000100fff855701f0d2ab31038e01787c773f0f8003906f7000004db00080200000200fff82ab01c045572281dc0fa00013986f70001043fdcff088200000100fff855701c042ab3100f80fa00013906f70001043fdcff088200000200fff82ab01b0355722807f900013986f70001043fdcff080200000100fff855701c032ab31002f900013906f70001043fddff09fe8200000200fff82ab01b02557228f800013986f70001043fddff09fd0200000100fff855701b022ab310f800013906f70001043fddff09fa8200000200fff82ab01b02557228f800013986f70001043fdd0009150200000100fff855701b022ab310f800013906f70001043fdd00090a8200000200fff82ab01b02557228f800013986f70001043fdd0009150200000100fff855701b022ab310f800013906f70001043fdd00090a8200000200fff82ab01b02557228f800013986f70001043fdd0009150200000100fff855701b022ab317f8ff01f906f70001043fdd00090a8200000200fff82ab0230255722ff8ff01f986f70005043f003000f0f7000018ec0009150200000100fff8557029022ab31ff8ff01f906f70005043f00600030fe000106c0fd0001360cec00090a8200000200fff82ab028015572f700010186f70005043f00600030fe000106c0fd0001360cec0009150200000100fff855702a022ab315f855015106f70010043f00c3b8307c71c006c3b9e3b8773606ec00090a8200000200fff82ab02a0255722af8aa01a986f70010043f00c1cc3006318002467331ccce1206ec0009150200000100fff855702a022ab315f855015906f70010043f00c18c30063180000636198cc60006ec00090a8200000200fff82ab02a02557228f800013986f70010043f00c18c307e1b00000636198cc60006ec0009150200000100fff855702a022ab310f800013906f70010043f00c18c30c61b00000636198cc60006ec00090a8200000200fff82ab02a02557228f800013986f70010043f00c1cc30ce0e00000673318cce0006ec0009150200000100fff855702a022ab310f800013906f70010043f0061b8fc770e000003b1e3de76000cec00090a8200000200fff82ab02a02557228f800013986f70007043f00618000000cfe000530000006000cec0009150200000100fff855702a022ab310f800013906f70007043f00318000000cfe0005300000060018ec00090a8200000200fff82ab02802557228f800013986f7000e043f0003c000003e000001e000003cea0009150200000100fff855701b022ab310f800013906f70001043fdd00090a8200000200fff82ab020075572280200000180fd00013986f70001043fdd0009150200000100fff8557020072ab31005003de180fd00013906f70001043fdd00090a8200000200fff82ab01f06557228088018c0fc00013986f70001043fdd0009150200000100fff85570210d2ab310104018c783ce1c00003906f70001043fdd00090a8200000200fff82ab0210d557228202018c18666d800003986f70001043fdd0009150200000100fff85570210d2ab31040100d818c36d800003906f70001043fdd00090a8200000200fff82ab0210d557228801c0d818ff6d800003986f70001043fdd0009150200000100fff85570210d2ab310e0380d818c03f000003906f70001043fdd00090a8200000200fff82ab0210d5572287070070186733000003986f70001043fdd0009150200000100fff85570210d2ab31038e00707e3e33000003906f70001043fdd00090a8200000200fff82ab01c045572281dc0fa00013986f70001043fdc55080200000100fff855701c042ab3100f80fa00013906f70001043edcaa088200000200fff82ab01b0355722807f900013986f70001043ddc55080200000100fff855701b032ab31002f900013906f70001043adcaa088200000200fff82ab01a02557228f800013986f700010435dc55080200000100fff855701a022ab310f800013906f70001042adcaa088200000200fff82ab01902557228f800013986f7000004db00080200000100fff8557019022ab310f800013906f7000004db00080200000200fff82ab01c02557228f800013986f7000304000006de00080200000100fff855701c022ab310f800013906f7000304000002de00080200000200fff82ab01e02557228f800013986f70005040089c22270e000080200000100fff855701e022ab317f8ff01f906f70005040088222288e000080200000200fff82ab01e0255722ff8ff01f986f7000507c051e222f8e000083e00000100fff855701e022ab31ff8ff01f906f7000507c052222680e000083e00000200fff82ab01d015572f700010186f7000507c021e71a70e000083e00000100c00055701a022ab315f855015106f7000107c0dc00083e00000200c0182ab0190255722af8aa01a986f7000007dbff08fe00000100e038557012022ab315f855015906cd00050200e0382ab01202557228f800013986cd00050100f078557012022ab310f800013906cd00050200f0782ab01202557228f800013986cd00050100f8f8557012022ab310f800013906cd00050200f8f82ab01202557228f800013986cd00050100fdf8557012022ab310f800013906cd00050200fdf82ab01202557228f800013986cd00050100fff8557012032ab31002f900013906ccaa0400c0002ab0160355722807fd000070fe00013985cc5504008000557013082ab3100f8007400030fe000039c800012ab014085572281fc00dc00030fe00013980c900015570130c2ab3103fe018c783b1e0000039c800012ab0140d5572287ff0180cc6733000003980c900015570130c2ab310fff81818663618000039c800012ab0140d557229ffe818186637f800003980c90001557017082ab3105fd018186636fe00013915cc55044000002ab0170d7ff2282fa00cccc673380000398accaa048000005ff0170d2ab3101740078783b9f000003917ccff044000002ab014045572280a80fa0001398fcdff05fe80000055701a032ab31005f900033917ff20ed00000fe5ff06e7fc4000002ab01a0355722802f90003398ffc60ed00001fe5ff06e1fc800000557019022ab310f800033917f0e0ed00003fe5ff06e07c4000002ab01902557228f80003398fc0e0ed00003fe5ff06e01c800000557019022ab310f80003391700e0ed00003fe5ff06e0044000002ab01902557228f80003398e00e0ed00003fe5ff06e01c800000557019022ab310f800033917f0e0ed00003fe5ff06e07c4000002ab01902557228f80003398ffce0ed00003fe5ff06e1fc800000557019022ab310f800033917ffe0ed00003fe5ff06e7fc4000002ab01502557228f80003398fffe7d0ff06effc800000557015022ab317f8ff03f917ffefd0ff06effc4000002ab0110255722ff8ff01f98ecc0004800000557011022ab31ff8ff01f914cc00044000002ab010015572f70001018accaa04800000557011022ab315f855015115cc55044000002ab007015575bc55007006002abbaa00b008fe55005dbe5500700a002abfaa00abfeaa00b008fe55005dbe5500700a002abfaa00abfeaa00b008fe55005dbe5500700a002abfaa00abfeaa00b008fe55005dbe55007009033ffffffbbeff00f006007fbbff00f002b90002b90002b900a00083ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 13.2 Facilities of Hyper-GINA\:\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab A mode can be selected on the left similar as in the graphic editor.\par \'a5\tab In most modes, "elements" can be drawn into the main view.\par \'a5\tab Elements are widgets like in the Interface Builder.\par \'a5\tab Elements can be moved around and resized.\par \'a5\tab Elements can be operated, but initially have no callbacks.\par \'a5\tab Lisp code can be entered into code elements.\par \'a5\tab Pressing the little black button in the upper right corner of the code element executes the code.\par \'a5\tab The border of each element contains the name of the element and one or more outlets (at least "value").\par \'a5\tab Name and outlets can be dragged onto other elements using the mouse. The semantics of such a dragging operation depends on the class of elements involved. This is implemented by multimethods. As feedback, the operation which will take place if the mouse button is released is displayed in the message area.\par \'a5\tab Dragging the name of a code into an element will set the callback of the element.\par \'a5\tab Callbacks have no parameters.\par \'a5\tab Within code, other elements can be referenced by their name. Internally element names are replaced by (value <denoted-element>) before the code is executed. An exception is the view-element\: its name is replaced by (widget <view-element>). Most elements have an accessor VALUE. The type of the VALUE depends on the element-type. For example, (setf number3 "25") will convert the string before storing it in the number-element. If the default-translation of an element-name is not appropriate you can explicitly specify (widget <element>) to access the motif-widget contained in the element (to set its colour for example). For list-elements you can write (items list5) to read and write the item-list. See method parse for details of the translation process.\par \'a5\tab Dragging the name of an element into a code inserts the element name.\par \'a5\tab By dragging the name of a code into a button, the activate-callback is set.\par \'a5\tab For string, text, number, scale and list, the value-changed-callback is set by dragging the name of a code into it.\par \'a5\tab Dragging a button name into a list means that the callback of the button is executed when a list item is double-clicked.\par \'a5\tab Using the value-changed-callback of a number-element the typical spreadsheet effect can be obtained\: editing a value immediately may update a derived value.\par \'a5\tab For views, setting the callback means defining its draw method. The name of the view can be used as the first parameter of methods like draw-rectangle or force-redraw.\par \'a5\tab The callback of a clock element is executed every second.\par \'a5\tab Dragging the value outlet to another element means assigning the value (including necessary conversions).\par \'a5\tab Dragging the items outlet of a list copies the item list.\par \'a5\tab Dragging something onto the items outlet sets the item list.\par \'a5\tab Setting the value of a button means setting its label-string.\par \'a5\tab Code elements are executed when a stack is openend if the init flag at the upper right corner is set.\par \'a5\tab You can have several cards\: see {\f22 new card}, {\f22 next card}, {\f22 previous card}. Within code you can write (goto 2) to select the second card.\par \'a5\tab Try the adjust commands to find out their meaning!! \par \'a5\tab In user mode, elements cannot be moved or selected.\par \pard \s4\fi-283\li283\ri1\sb40\sa40 \'a5\tab The function PLAY (e.g (PLAY "gong" \:volume 30)) plays sounds in /usr/demo/SOUND/sounds/* on SUN workstations.\line *all-sounds* is a list of all available sounds.\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab *all-colors* is a list of colors for Motif widgets.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 13.3 Implementation\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab Elements are implemented as direct-manipulation-objects with a  widget on top of it. There are after daemons which move and resize the widgets when a DMO is moved/resized. \par \'a5\tab Typical mouse-down-commands are used to connect widgets, etc. As a feedback the label string of the message label is updated while dragging.\par \'a5\tab Widgets have a callback which executes the code-element stored in an element.\par \'a5\tab Explicit accessor functions for the value slot perform the necessary type conversions.\par \par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 13.3 Limitations and Extensions\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab Drag-and-drop commands should be used in many cases so that the feedback is not covered by the Motif widgets.\par \'a5\tab Undo is not completely implemented and runs into problems if cards are changed.\par \'a5\tab The only way to find out afterwards which code has been assigned to an element is to perform an "inspect click" on an direct-manipulation-object and inspect the slot {\f22 code}.\par \'a5\tab A code-element should allow several expressions without a {\f22 progn}.\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 14. Lisp Listener \par \pard\plain \f20 {{\pict\macpict\picw427\pich304 124c00000000013001ab1101a00082a0008e01000a0000000002d002409800360000000000bf01b00000000000bf01ab0000000000bf01ab000102cb0002cb00060015cd55000009032aaaaaaed0aa00800a0015d155005dfe5500800a032aaaaaaed1aa01ab800a0015d155005dfe5500800a032aaaaaaed1aa01ab800a0015d155005dfe5500800a032aaaaaaed1aa01ab800a0015d155005dfe5500800b012abfd2ff04fbffffab80060015cd5500800a032abaaaaed1aa01ab80120015f155f0ff00d5f5550675555d555755800e032abaaaaef4aaf0ffefaa01ab80200015f155059e7ffff9e7fcfdff07f9cff9999ffe73d5f5550675555d555755801d032abaaaaef4aa059ffffff9fffcfdff06f9cff9f99ffe43efaa01ab80210015f155119e6193f9e61861938649f9c93090987273d5f5550675555d557755801e032abaaaaef4aa109e4c89f9e4cccc893209f9c89999932473efaa01ab80210015f155119e4799f9e47ccc99323ff9c99999932673d5f5550675555d5577558022032abaaaeef4aa109e7199f9e71cc099027ff9c99999902673f3aa00aefeaa01ab80240315557fd5f455119e7899f9e78ccf993e7ff9c9999993e673d5f55506755d5d557755801e032abaaaaef4aa109e4c89f9e4cc8c993279fc999919132473efaa01ab80210015f15511806193f8061e61998679fc199c9c987273d5f5550675555d5577558014032abaaaaef4aa02ffff9ff3fff1aa03bfeaab80160015f15502ffff9ff3ff00d5f5550675555d5557558012032abaaaaef4aa02ffff9ff3ffefaa01ab800a031557fffdd1ff01558008003fcfff02feff800901155ad0aa02a9558009012abdd0550256ab800901155ad000020d558009012abcd000020eab800901155ad000020d558009012abcd000020eab800901155ad000020d558009012abcd000020eab800901155ad000020d558009012abcd000020eab801705155a00001878fd0002e0c180fe0000e0df00020d558018102abc03fc181800003fc060c18003f00060df00020eab801810155a018c0018000018c060018001980060df00020d55801b132abc018c78181e0018c763c3f0018c786e738ee0e200020eab801b13155a01a0181833001a0ce0c180018ccc733199c0e200020d55801b132abc01e0181861801e0c60c180018d86633198c0e200020eab801b13155a01a018187f801a0c60c180018dfe633198c0e200020d55801b132abc01801818600018cc60c180018d80633198c0e200020eab801b13155a01801818338018cce0c1980198ce733399c0e200020d55801b132abc03e07e7e1f003fc773f0f003f07cee1dcec0e200020eab800d01155af00000c0e200020d55800d012abcf00000c0e200020eab800e01155af100010780e200020d558009012abcd000020eab800901155ad000020d558009012abcd000020eab800901155ad000020d558009012abcd000020eab800901155ad000020d558009012abcd000020eab800901155ad000020d558009012abdd0ff02feab800901155bd0ff02fd55800b012abfd2ff04e1fffeab800b01155fd2ff04c1fffd55800b012abed2000421fffaab800b01155ed2000441fdf555800b012abed2000421fbfaab800b01155ed2000441f5f555800b012abed2000421f9faab800b01155ed2000441f0f555800e042abe000060d5000421e8faab800e04155e0f8060d5000441d075558010022abe06fd0000e0d8000421e07aab801107155e0601e0fddc38d8000441dff5558011072abe0600618ce60ed8000421bffaab801107155e06006180c603d8000441fff5558011072abe063060f8c60ed8000421fffaab801107155e0630600cc638d8000441fff5558011072abe0630618ce6e0d8000421fffaab801006155e0ff1f9f8dcd7000441fff555800f012abefd0000c0d7000421fffaab800f01155efd0000c0d7000441fff5558010012abefe000101e0d7000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab802703155e0060fc000a01c000003030003c000f06fe0008180c001f8001e30180f0000441fff5558026032abe00c0fb0015c0018060f000660019830000c0301c001800030180c0f0000421fffaab802603155e00c0fb0015c00180603000660001830000c0303c001800060180c0f0000441fff55580291f2abe0183e3b9dc3c770ec00300c0300006000181800180602c0018000600c060f0000421fffaab80291f155e018031cce6663999c00200c0300006000701800100606c001f0006c0c060f0000441fff55580291f2abe0180318cc6c33198c00000c030000c000101800000604c0011800760c060f0000421fffaab80291f155e0183f18cc6ff3198c00000c030001800018180000060cc0001800660c060f0000441fff55580291f2abe0186318cc6c03198c00000c030003000018180000060fe0001800660c060f0000421fffaab80291f155e018671cce6673199c00000c0300060001981800000600c0019800660c060f0000441fff5558029132abe00c3b9b8dc3e7bcee0000060fc007e000f03fe0008301e000f0003c180c0f0000421fffaab802206155e00c00180c0fb000060fc000003fe000030fc00020180c0f0000441fff5558022062abe00600180c0fb000030fc000006fe000018fc0002030180f0000421fffaab801006155e000003c1e0d7000441fff555800b012abed2000421fffaab800b01155ed2000441fff555801a102abe0060600078001e0000c001f8001e30e1000421fffaab801a10155e00c1e000cc00330001c00180003018e1000441fff555801a102abe00c06000cc00030003c00180006018e1000421fffaab801a10155e018060000c00030002c0018000600ce1000441fff555801a102abe018060000c000e0006c001f0006c0ce1000421fffaab801a10155e018060001800020004c0011800760ce1000441fff555801a102abe01806000300003000cc0001800660ce1000421fffaab801a10155e01806000600003000fe0001800660ce1000441fff555801a102abe01806000c000330000c0019800660ce1000421fffaab801a10155e00c1f800fc001e0001e000f0003c18e1000441fff5558011032abe00c0f5000018e1000421fffaab801103155e0060f5000030e1000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800e04155e000060d5000441fff555800e042abe0f8060d5000421fffaab801002155e06fd0000e0d8000441fff5558011072abe0601e0fddc38d8000421fffaab801107155e0600618ce60ed8000441fff5558011072abe06006180c603d8000421fffaab801107155e063060f8c60ed8000441fff5558011072abe0630600cc638d8000421fffaab801107155e0630618ce6e0d8000441fff5558010062abe0ff1f9f8dcd7000421fffaab800f01155efd0000c0d7000441fff555800f012abefd0000c0d7000421fffaab801001155efe000101e0d7000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff5558098003600bf0000013001b000bf0000013001ab00bf0000013001ab00010b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441fff555800b012abed2000421fffaab800b01155ed2000441aaa555800b012abed2000421d55aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441a03555800b012abed2000421c03aab800b01155ed2000441bff555800b012abed2000421fffaab800b01155ed2000441d55555800b012abed2000421aabaab800b01155ed2000441d07555800b012abed2000421e07aab800b01155ed2000441f0f555800b012abed2000421e8faab800b01155ed2000441f5f555800b012abed2000421f9faab800b01155ed2000441fff555800b012abed2000421fbfaab800b01155ed2000441fff555800b012abed2aa04a1aaaaab800b01155dd2550041fe55008009012ab8d0000202ab8009011ff8d0000201ff8009012aa8d0000202aa8009011558d000020155800b012abfd2ff04e00002ab800b01155fd2ff04c0000155800e022abfffd5aa06aeffa00002ab800f03155ffd75d655065d7fc0000155800f032abffae8d600061eafa00002ab800f03155fd4f0d600061d17c0000155800f032abfa0e8d600061e0aa00002ab800f03155f40f0d600061d03c0000155800f032abff0e8d600061e0fa00002ab800f03155ffcf0d600061d3fc0000155800f032abfffe8d600061effa00002ab800f03155ffff7d6ff06fdffc0000155800d032abfffefd4ff04a00002ab800b01155fd2550440000155800b012abed2aa04a00002ab800701155dce55008008012abacfaa01ab800a0015d155005dfe5500800a032aaaaaaed1aa01ab800a0015d155005dfe5500800a032aaaaaaed1aa01ab800a0015d155005dfe5500800a032aaaaaaed1aa01ab800a0015d155005dfe5500800a002fd1ff00fbfeff008006001fcdff008002cb00a0008fa00083ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34  14.1 Functionality\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab You can type Lisp expressions into a text widget.\par \pard \s4\fi-283\li283\ri1\sb40\sa40 \'a5\tab Input is entered by pressing the ENTER (not RETURN) key\line (or whatever is necessary to cause an ACTIVATE callback).\par \'a5\tab The line containing the insertion-cursor is sent off.\line If there is a text selection, it is sent off instead. \par \'a5\tab Note that prompts are also regarded as input!\line Normally however, the cursor is at the beginning of a line after each output. Functions like y-or-n-p might cause problems.\par \'a5\tab The class text-widget-stream is designed to be reusable\line i.e. you can attach a stream to any text widget.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 14.2 Implementation\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab The demo shows how a stream subclass can be defined which is connected to a text widget.\par \'a5\tab This demo only runs under Allegro4.0, where streams are CLOS classes.\par \'a5\tab Output to the stream is appended at the end of the text widget.\par \'a5\tab Reading from the stream blocks until some input is in the buffer.\par \'a5\tab The buffer is filled, when the user initiates an ACTIVATE callback (by pressing the ENTER key).\par \'a5\tab A read-print-eval-loop is started in a lightweight process. This process waits for input most of the time.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 14.3 Limitations and Extensions\par \pard\plain \s4\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab Any prompt is regarded as input!!\line (Newline after prompt solves only half of the problem because there are other prompts e.g. from the y-or-n-p function)\par \pard \s4\qj\fi-283\li283\ri1\sb40\sa40 \'a5\tab Output to a stream cannot come from a foreign application, because eventually CLM-Functions are called, which are then sent off over the wrong connection. To allow output from foreign applications, write-char must place output into a buffer which is read by another lightweight process (similar to input).\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 14.4 Source Code\par \pard\plain \s10 \f22\fs12 ;;;-*-Mode\:LISP;Syntax\: Common-Lisp;Package\:listen ;Base\:10-*-\par ;;;\par ;;; Thanks to Dieter Bolz who gave some important hints concerning streams!\par \par (in-package \:GINA)\par (defginapackage \:listen)\par (in-package \:listen)\par (setq *sccs-id* "@(#)lisp-listener.lisp\tab 1.2  1/15/92")\par \par ;; Lisp Listener Demo\:\par ;; - you can enter Lisp expressions into a text widget.\par ;; - input is entered by pressing the ENTER (not RETURN) key\par ;;   (or whatever is necessary to cause an ACTIVATE callback).\par ;; - the line containing the insertion-cursor is sent off.\par ;;   if there is a text selection, it is sent off instead. \par ;; - note that prompts are also regarded as input!\par ;;   normally however, the cursor is at the beginning of a line after\par ;;   each output. Functions like y-or-n-p might cause problems.\par ;; - the class text-widget-stream is designed to be reusable\par ;;   i.e. you can attach a stream to any text widget\par \par ;; Implementation\:\par ;; - this demo shows how a stream subclass can be defined which\par ;;   is connected to a text widget\par ;; - this demo only runs under Allegro4.0, where streams are CLOS classes\par ;; - output to the stream is appended at the end of the text widget\par ;; - reading from the stream blocks until some input is in the buffer\par ;; - the buffer is filled, when the user initiates an ACTIVATE callback\par ;;   (by pressing the ENTER key)\par ;; - a read-print-eval-loop is started in a lightweight process\par ;;   this process waits for input most of the time\par \par ;; Restrictions\: \par ;; - a prompt is regarded as input!!\par ;;   (newline after prompt solves only half of the problem)\par ;; - output to stream cannot come from a foreign application,\par ;;   because eventually CLM-Functions are called, which are then\par ;;   sent off over the wrong connection.\par ;;   To allow output from foreign applications, write-char must\par ;;   place output into a buffer which is read by another lightweight\par ;;   process (similar to input)\par \par ;; open questions\:\par ;; - how to tell text widget to start a new line if more than 80 columns\par ;;   resource \:resize-width does not work\par ;;   something like *print-width* ??\par ;; - delete part of the text in the text widget without rolling in \par ;;   the complete text ??\par ;; - search for newline without rolling in the complete text??\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class lisp-listener\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (defclass lisp-listener (application)\par   (;; overrides\par    (name          \:initform "Lisp Listener"    \:allocation \:class)\par    (document-type \:initform 'listener-document \:allocation \:class)\par    (signature     \:initform "listener"         \:allocation \:class)\par    (file-type     \:initform "listener"         \:allocation \:class))\par   (\:documentation "a simple lisp listener demo application"))\par \par (defun make-lisp-listener ()\par   (make-application \:class 'lisp-listener))\par \page ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class listener-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (defclass listener-document (document)\par   ((stream \:accessor stream)))\par \par (defmethod create-windows ((doc listener-document))\par   "create the windows belonging to this document"\par   (with-slots (main-shell main-view) doc\par     ;; create document-shell containing a scroller and the text\par     (setq main-shell (make-document-shell doc))\par     ;; create the text-view\par     (setq main-view (make-scrolled-text main-shell \:columns 80 \:rows 25))\par \par     ;; create a stream connected to the text-widget\par     (setf (stream doc) (make-text-widget-stream main-view))\par \par     ;; start a read-eval-print-loop\par     (in-background-process (doc \:terminate-on-error nil)\par        (setq tpl\:*prompt* "~%Lisp>~%")\par        (tpl\:start-interactive-top-level \par \tab (stream doc) #'tpl\:top-level-read-eval-print-loop nil))\par \par     ;; document is always modified by Lisp Listener prompt\par     (setf (modified doc) t)\par    ))\par \par (defmethod write-to-stream ((doc listener-document) stream)\par   "write the document to the specified stream"\par   ;; write the current value of the text widget\par   (format stream "~s~%" (value (main-view doc))))\par \par (defmethod read-from-stream ((doc listener-document) stream)\par   "read the document from the specified stream"\par   (setf (value (main-view doc)) (read stream)))\par    \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class text-widget-stream\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass text-widget-stream (stream\:fundamental-character-output-stream\par \tab \tab \tab       stream\:fundamental-character-input-stream)\par   ((text-widget \:accessor text-widget \:initarg \:text-widget)\par    (input-buffer \:accessor input-buffer \:initform "")\par    (input-pos    \:accessor input-pos    \:initform 0)\par    (max-output-length \:accessor max-output-length \:initform 1000)\par    (output-length \:accessor output-length \:initform 0)))\par \par (defun make-text-widget-stream (text-widget \par \tab \tab \tab \tab &key (class 'text-widget-stream)\par \tab \tab \tab \tab      (initargs nil)\par \tab \tab \tab \tab &aux new)\par   (setq new (make-object class initargs \:text-widget text-widget))\par   (setf (activate-callback text-widget) (make-callback 'activated new))\par   new)\par \par (defmethod stream\:stream-write-char ((tws text-widget-stream) character)\par   "append character at the end of the text-widget"\par   (incf (output-length tws))\par   (clear-old-output-when-necessary tws)  \par   (xtk\:append-text (widget-id (text-widget tws)) \par \tab \tab    (string character)\par \tab \tab    \:scroll-window t))\par \par (defmethod stream\:stream-write-string \par               ((tws text-widget-stream) string &optional (start 0) (end nil)\par \tab        &aux output-string)\par   "append string at the end of the text-widget"\par   (setq output-string (subseq string start end))\par   (incf (output-length tws) (length output-string))\par   (clear-old-output-when-necessary tws)\par   (xtk\:append-text (widget-id (text-widget tws))\par \tab \tab    output-string\par \tab \tab    \:scroll-window t))\par \par (defmethod clear-old-output-when-necessary ((tws text-widget-stream))\par   "cut off prefix of the text, when limit exceeded by 100%"\par   (when (and (max-output-length tws)\par              (> (output-length tws) (* 2 (max-output-length tws))))\par     (setf (value (text-widget tws)) \par       (subseq (value (text-widget tws)) (max-output-length tws)))\par     (decf (output-length tws) (max-output-length tws))))\par \par (defmethod activated ((tws text-widget-stream) &rest parms \par \tab \tab       &aux text-selection cursor-position string \par \tab \tab       prev-newline next-newline\par \tab \tab       first-half second-half input-line)\par   "enter text selection or line containing the cursor"\par   (declare (ignore parms))\par   ;; if some text is selected, this is the input\par   (setq text-selection (xtk\:text-get-selection (widget-id (text-widget tws))))\par   (if (not (equal text-selection ""))\par     ;; then\: something selected\par     (setq input-line text-selection)\par     ;; else\: determine line containing the cursor\par     (progn\par       (setq cursor-position \par \tab (first (get-motif-resources (text-widget tws) \:cursor-position)))\par       ;; get complete text from CLM \par       (setq string (value (text-widget tws)))\par       ;; search for next and previous newline\par       (setq first-half (subseq string 0 cursor-position))\par       (setq second-half (subseq string cursor-position))\par       (setq prev-newline (position #\\newline first-half \:from-end t))\par       (when (not prev-newline) (setq prev-newline -1))\par       (setq next-newline (position #\\newline second-half))\par       (when next-newline\par \tab (incf next-newline cursor-position))\par       (setq input-line (subseq string (1+ prev-newline) next-newline))))\par   ;;(print input-line)\par   ;; append input line to stream buffer\par   (mp\:without-scheduling ;; modify buffer in an atomic operation\par    (setf (input-buffer tws)\par      (concatenate 'string (input-buffer tws) input-line (string #\\newline)))))\par \par (defmethod stream\:stream-read-char ((tws text-widget-stream))\par   (xtk\:\:process-wait "input wait" #'listen tws)\par   (prog1\par       (elt (input-buffer tws) (input-pos tws))\par     (incf (input-pos tws))\par     (when (> (input-pos tws) 110)\par       ;; throw away old input from time to time\par       ;; but keep some (?) characters for unread\par       (mp\:without-scheduling\par        (setf (input-buffer tws) (subseq (input-buffer tws) 100))\par        (decf (input-pos tws) 100)))\par     ))\par \par (defmethod stream\:stream-unread-char ((tws text-widget-stream) char)\par   (declare (ignore char))\par   (decf (input-pos tws))\par   nil)\par \par (defmethod stream\:stream-read-char-no-hang ((tws text-widget-stream))\par   (when (stream\:stream-listen tws)\par     (stream\:stream-read-char tws)))\par \par (defmethod stream\:stream-peek-char ((tws text-widget-stream))\par   (xtk\:\:process-wait "input wait" #'listen tws)\par   (elt (input-buffer tws) (input-pos tws)))\par \par (defmethod stream\:stream-listen ((tws text-widget-stream))\par   (> (length (input-buffer tws)) (input-pos tws)))\par \par (defmethod stream\:stream-clear-input ((tws text-widget-stream))\par   (setf (input-pos tws) (length (input-buffer tws)))\par   nil)  \par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; main program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (register-application "listener" 'lisp-listener "listener")\par '(make-lisp-listener)\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 15. Chess Interface\par \pard\plain \f20 {{\pict\macpict\picw406\pich433\picscaled c5be000000000362032c1101a00082a0008e01000a00000000061004809800660000000000640330000000000064032c000000000064032c00010bfe550065a355032aaaaab00a002aa1aa00abfe5500700bfe550065a355032aaaaab00a002aa1aa00abfe5500700bfe550065a355032aaaaab00a002aa1aa00abfe5500700bfe550065a355032aaaaab00c032affffefa3ff037ffff570080155809f00010ab00a002aa3aa00adfc550070150355955565da55f5000015da550654aaab2aaacab012002ad7aa0080f600002adaaa00adfc5500701f0355955565da55010f60fe0007031803333000c615da550654aaab2002cab01a002ad7aa0199e0fe0007031803033000de2adaaa00adfc5500701f0355955565da550c306c78f1e3031b67b7b3c6c615da550654aaab22aecab01d022aa800d9aa0cb076cd9b33031bb333366dc62adaaa01ad50fd5500701f0355915765da550c3066cdc380031b3333366cc615da550654aaab22aecab01c002ad7aa0cb066fc70e0031b333337ecc62adaaa02ad51d5fe5500701f035593ff65da550c3066c03870031b3333360cc615da550654abab22aecab01a002ad7aa0c99e6cd9b3301b33373766dc62adaaa00adfc5500701f0355955565da550c0f6678f1e301f331b1b3c6c615da550654aaab22aecab014002ad7aa0080f600002adaaa06ad555557fd5570150355955565da55f5000015da550654aaab2aaacab012002ad7aa0080f600002adaaa00a5fc5500700f0355bfffefa6ff06fdffff7fffcab0059dff01dff00b0000a355005afdaa0180100c012aeaa4aa00a5fd55019570090155d0a00002018ab009012ae0a00002019570090155d0a00002018ab009012ae0a00002019570090155d0a00002018ab009012ae0a00002019570090155d0a00002018ab009012ae0a000020195701b0555d00000c3c0fe000207060cfe000007fc000070b40002018ab01c0f2ae01fe0c0c00001fe03060c001f8003fd00011d30b400020195701c0f55d00c6000c00000c603000c000cc003fd00013730b40002018ab021192ae00c63c0c0f000c63b1e1f800c63c3739c770063370f07e3f0b80002019570211955d00d00c0c19800d067060c000c6663998cce006039998c6630b80002018ab020182ae00f00c0c30c00f063060c000c6c33198cc6006031b0cc06b70002019570211955d00d00c0c3fc00d063060c000c6ff3198cc6006031bfc7c3e0b80002018ab021192ae00c00c0c30000c663060c000c6c03198cc6006031b0006030b80002019570211955d00c00c0c19c00c667060cc00cc673999cce00333199cc6630b80002018ab021192ae01f03f3f0f801fe3b9f87801f83e770ee76001e7bcf8fc7e0b800020195700d0155d0f1000006b10002018ab00d012ae0f1000006b100020195700d0155d0f100003cb10002018ab009012ae0a00002019570090155d0a00002018ab009012ae0a00002019570090155d0a00002018ab009012ae0a00002019570090155d0a00002018ab009012ae0a00002019570090155d0a00002018ab008012aef9fff019570080155df9fff018ab007002a9eff0195700700559eff018ab008012af09f00011570080155f09f00010ab008012af09f00011570080155f09f00010ab018012af0f5000001f2ff0080fb000007eaff00fedb00011570160155f0f5000001f2fffa000007eaff00fcdb00010ab019012af0f500010180f3000080fb000006ea000002db00011570190155f0f500010180f4000001fa000006ea000004db00010ab019012af0f500010180f3000080fb000006ea000002db00011570190155f0f500010180f4000001fa000006ea000004db00010ab01c042af00007f0f800010180f3000080fb000006ea000002db000115701c0455f000180cf800010180f4000001fa000006ea000004db00010ab036042af0002002f80002018030fa000d01f8003f0000800000c000300006ea0005023ffc0003c0fa0003c0000060fa0000c0f3000115704a1055f000400100071c0000e38000000180f0fa000f0118003000010001e8c0003000060e78fd000171c0f20005043ffc0fe0c0fe00003efe0006c0000060000e80fd0000c0f300010ab0460a2af0008000800318000063fe0002018030f9000e1800300000800338c0003000060c30fd00013180f20005023ff80630c0fe00000efb000360001b80fd0000c0f300011570521055f00100004003bb8e00771e3de7818030fb001901e8307a300001000319f8f87e1e060661e39cee003b8f1ef3c0f5001a043ff40630c1f1c7001b0eef83c770fcfc00318f36cee739f87877f500010ab052102af00100004003b98c00773318ccc18030fb0019033830ce3e0000800300c00c3033060663318c70003b998c6660f5001a023ff80630c018c6001b19c0c0c3998c600030199b673318c0cc38f500011570521055f00200002003598c006b6198d8618030fb0019061831862300010001f0c00c30618603c6198c600035b0cc6c30f5001a043ff40660c018c6001b18c0c0c3198060003030db663318c18630f500010ab052102af0020000200358d8006b618d9fe18030fb001906003180030000800018c0fc307f860186198c600035b0c6cff0f5001a023ff807c0c1f86c003198cfc0c318f860003030db663318c1fe30f500011570511055f0020000200318d80063618d98018030fb001806006180030001000318c18c3060060186198c600031b0c6ccf4001a043ff40600c3186c003f98d8c0c3180c60003030db663318c18030f500010ab055302af002000020031870006333070ce1803030000c060300031860c6330000800398cd9c3333860183319c60003199838670f5001a023ff80600c33838003199d9c0c3198c660019999b673338ccce30f500011570553055f00200002007bc7000f79e0707c180fc30000c06030001f0607c1e00010002f078ee1e1f0607e1e0eefc007bcf0383e0f5001a043ff40f83f1dc38007bcecee3f7bdf83c000f0f3b76e1dc787c7ef500010ab02e082af002000020000060fc00010180f3000080fb000006ea0002023aa8fd000030fe0000c0f8000006f0000115702e0855f002000020000060fc00010180f4000001fa000006ea0002043554fd000030fe0000c0f8000006f000010ab02c082af0010000400001f0fc00010180f3000080fb000006ea000002fb0004f800000780f800000ff0000115701d0555f001000040f900010180f4000001fa000006ea000004db00010ab01d052af000800080f900010180f3000080fb000006ea000002db000115701c0455f0004001f800010180f4000001fa000006ea000004db00010ab01c042af0002002f800010180f3000080fb000006ea000002db000115701c0455f000180cf800010180f4000001fa000006ea000004db00010ab01c042af00007f0f800010180f3000080fb000006ea000002db00011570170155f0f5000101d5f355fa000007ea550054db00010ab016012af0f5000001f2aa0080fb000006e9aadb00011570080155f09f00010ab008012af09f00011570080155f09f00010ab008012af09f00011570080155f09f00010ab02e012af0f8000008f700011f80f8000103e0f8000101f8f700007ff800011fc0f8000103e0f800010104f7000115709800660064000000c803300064000000c8032c0064000000c8032c00012c0155f0f8000014f700010840f800010410f7000084f7000020f8000008f700010410f800010104f700010ab02a012af0f8000022f700010840f8000004f6000084f7000020f8000008f7000004f700010104f7000115702a0155f0f8000041f700010840f8000004f6000084f7000020f8000008f7000004f700010104f700010ab02a012af0f8000041f700010f80f8000004f6000084f700003cf800000ff7000004f7000101fcf7000115702b0155f0f8000041f700010840f8000004f6000084f7000020f8000008f700010470f800010104f700010ab02b012af0f800007ff700010840f8000004f6000084f7000020f8000008f700010410f800010104f7000115702b0155f0f8000041f700010840f8000004f6000084f7000020f8000008f700010410f800010104f700010ab02c012af0f8000041f700010840f800010410f7000084f7000020f8000008f700010410f800010104f7000115702d0155f0f8000041f700011f80f8000103e0f8000101f8f700007ff8000008f7000103e0f800010104f700010ab008012af09f00011570080155f09f00010ab008012af09f00011570080155f09f00010ab008012af09f00011570080155f09f00010ab008012af09f00011570100155f0fe00003fa9ff00e0fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570440155f0fe000020fd00017ffffd000005fd550075fc550054fc00013e3efd00f6550040f7000005fd5501fdfdfe550054fd00001cfb00fc5501fffdfd550060fc00010ab04f012af0fe000020fd00014001fd00000afdaa00dafcaa00a8fc00016363fd00fcaa00befcaa0080fd00010380fd00000afeaa02ab8f8efeaa00a8fd000014fb00fdaa02ab0006fdaa00a0fc00011570520155f0fe000b2000001f805ffd00fc000005fd55005dfc550054fc00014949fd00fc550063fc550040fd00010380fd000005fd55012525fe550054fd000016fb00fe55087f557ff557f5555560fc00010ab056012af0fe000b200007f0805ffd0087f0000afeaa01be8afcaa00a8fc00015d5dfd00fcaa00c9fcaa0080fd00010fe0fd00000afeaa02ab7776feaa00a8fe00010722fb000baaaabfc2ab7ff6aa1feaaaa0fc00011570570155f0fe000b20000c06805ffdf0b0180005fe550167affc550054fc000249c9e0fe00fc55005dfc550040fd00010fecfd000005fd55052727d5555554fe000209abc0fc000b5555701b557ff7d6c0755560fc00010ab059012af0fe000b200009fe805ffdf0bfc8000afeaa01b3a7fcaa00a8fc000263e3f0fe00fcaa01c9eafdaa0080fd0001038cfd00000afeaa06ab8f8feaaaaaa8fe00020ce9c0fc000baaaaa7faab7ff7eaff2aaaa0fc000115705b0155f0fe000b20000bfef85ffdf0bfe80005fe550251b7d5fd550054fc000237f7f0fe00fe5503755563f5fd550040fd00011bbffd000005fd5505dfdfd5555554fe0002046de0fc000b55556ffbf57ff7d6ffb55560fc00010ab05b012af0fe000b20000bfefbdffdffbfef000afeaa01b9b7fcaa00a8fc000241ebf0fe00feaa03feaab3fafdaa0080fd00013bbffd00000afeaa06ab07afeaaaaaa8fe0002066de0fc000baaaaaffbef7ff7feffbeaaa0fc000115705d0155f0fe000b20000bfefe1ffc3fbfef8005fe5502583015fd550054fd0003019cddf0fe00fe5508c75553f55fd5555540fd00010387fd000005fe5506567377d5555554fe0001020cfb000b55556ffbf87ff0feffbf5560fc00010ab061012af0fe000b20000bfe80ffff80bfef800afeaa02a9ff87fdaa00a8fd0003033e3ef0fe00feaa1392aab3fab8eaaaaa8000fff8001ff700fff8000afeaa06acf8fbeaaaaaa8fe0003027fe1c0fd000baaaaaffa03fffe02ffbeaaa0fc00011570610155f0fe000b20000bfe3ffffffe3fef8005fe55035dfff015fe550054fd0003067fbee0fe00fe5504bb5573f552fe550b4001c00e001ff703800c0005fe550659fefbd5555554fe0002037ffcfc000355556ff8feff04f8ffbf5560fc00010ab062012af0fe000b20000bffff8000ffffef800afeaa03adfff9eafeaa00a8fd000304ff9ef0fe00feaa1393eaa1eab76aaaaa80031fe3003c7b863fe2000afeaa06b3fe7beaaaaaa8fe0003017ffe78fd000baaaaaffffe0003ffffbeaaa0fc00011570610155f0fe000b20000bffe03ffe03ffef8005fd5502fffc1dfe550054fd00030dffde78fe00fe5513c7f56df5527d555540067ff9c0393b8cfff90005fe550677ff79f5555554fe0003017fff07fd000b55556fff80fff80fffbf5560fc00010ab063012af0fe000b20000bf80ffffff80fef800afeaa03bdfffe7efeaa00a8fd000319ffcf78fe00feaa13efeaadeab8feaaaa800cfffc703bbbb1fffcc00afeaa06e7ff3deaaaaaa8fe0004077fff9f80fe000baaaaafe03fffffe03fbeaaa0fc00011570630155f0fe000b20000803ff7fff7fe00f8005fe5507f1ffff01d5555554fd000313ffc778fe00fe551367f56df559fd55554009ffff183bbbe7fffe6005fe55064fff1df5555554fe00043c7fffc060fe000b5555600ffdfffdff803f5560fc00010ab063012af0fe001620000ffbff7fff7fefff800aaaaaab87fffff7eaaaaaa8fd000337fff77cfe00feaa13a7eaadfaa9feaaaa8013ffffcc3bbbcffe3f200afeaa06dfffddfaaaaaa8fe000461fffffdf8fe000baaaabfeffdfffdffbffeaaa0fc00011570630155f0fe0016200000fbff7fff7fefff80055555573ffffff035555554fd000327e3f33cfe00fe551367d56df559fd55554037f007e6393b9fc08fb005fe550e9f8fccf5555554000001cffffffc08fe000b555557effdfffdffbfff5560fc00010ab063012af0fe0016200000fbff7fff7fefff800aaaaaac783ffffefaaaaaa8fd00036febfbbcfe00feaa25a3eaedfab1feaaaa8027e7f3f31c733f9fe79c0aaaaaabbfafeefaaaaaa80000031e0fffffbefe000baaaaabeffdfffdffbffeaaa0fc00011570630155f0fe0016200000fbff7fff7fefff8005555559f28ffffe05555554fd00034febf9bcfe00fe55136bd56df555f55555402fcff8f9dff77c7ff79e05fe550e3fafe6f55555540000067ca3ffff81fe000b555557effdfffdffbfff5560fc00010ab063012af0fe0016200000fbff7fff7fefff800aaaaab3e6efffffbeaaaaa8fd0003df087dbefe00feaa34abeaccfab5faaaaa806f9ffe7cdff679fff3de0aaaaaab7c21f6faaaaaa800000cf9bbffffef800000aaaaabeffdfffdffbffeaaa0fc00011570640155f0fe00162000000bff7fff7fef8000055555c7f08fffff83d55554fd00039f7f7cbefe002b57f55569f55ef565f55555404fbfff7e5c74fbfffbcf055555567dfdf2fd555554000031fc23ffffe0e00000fe55086ffdfffdffbf555560fc00010ab065012af0fe00162000000bff7fff7fef80000aaaab9dfc3fffffefaaaaa8fe000401bf087ebefe002bae3aaaadeadefaadfaafea805f3fff3f4325f7fff9ef0aaaaaaefc21fafaaaaaa80000677f0ffffffbe00000feaa08affdfffdffbeaaaaa0fc00011570630155f0fe000e2000000bff7fff7fef80000555573bfdff03e0d55554fe0004013febfe3efe00235495556df55efd6df55c7540df7fff9f0783e7fffdef85555554ffaff8fd5555540000cefdff03f8300000fe55086ffdfffdffbf555560fc00010ab065012af0fe00162000000bff7fff7fef80000aaaae77fffffefffbeaaaa8fe0004017febffbefe000eaddaaaacfadefacdfaa92a80df7ffffecf11effffdef8aaaaaadffaffefaaaaaa800019dfeff04bffef80000feaa08affdfffdffbeaaaaa0fc00011570650155f0fe00162000000bfc00001fef800005555ceffffffefff81d5554fe0004017febffbefe0016549f556ef55efd5df55bb5409f7fffe7ffffcff87de7c5fe5509ffaffefd55555400033bfeff04bffe060000fe55086ff000007fbf555560fc00010ab065012af0fe00162000000801feffc00f80000aaab9dffffffcfffdfaaaa8fe0004037febffbefe0023ae1faaaefadefaddfaa93e80be787ff7feff9f787df7caaaaaadffaffefaaaaaa8000677feff043fff7e0000feaa08a007fbff003eaaaaa0fc00011570650155f0fe00162000000bfffeffffef8000055573bffffffdfffc0d5554fe0004027febffbefe0023578f556e7d5efd9df55c7f40bef87ef3fc7f3f387df7c5555559ffaffefd555554000ceffeff047fff030000fe55086ffffbffffbf555560fc00010ab065012af0fe00162000000bfffeffffef80000aaaa77ffffffdffff7eaaa8fe000402ffebffbefe0023abcfaaaf7adefabdfaa9fe80bef87cfbf83f3fb87df7caaaaaabffaffefaaaaaa80009dffeff047fffdf8000feaa08affffbffffbeaaaaa0fc00011570650155f0fe000d2000000bfffeffffef800005556efeff05fdffff0f5554fe000406ffe3ff9efe00235547556f7d9e7dbdf551ff40bef83df9fc7e7fb9fdf7c555555bff8ffe7d555554001bbffeff047fffc3c000fe55086ffffbffffbf555560fc00010ab067122af00003e02000000bfffeffffef80000aaacdfeff05fbffffbfaaa8fe000004feff00defe0019aae3aaaf3ebf7b3dfab2fe809effbdfdfefeffb3fde7caaaaab3feff0e7aaaaaa800337ffffffeffffefc000feaa0aaffffbffffbeaaaaa001f0fe00011570671255f00004102000000bfffeffffef800005559bfeff05fbfbff83d554fe000005feff00defe0019556bd56fbdbf7d7df563fd40deffbbfcfffcffb73defc5555557feff057d5555540026feff05fefeffe0e000fe550a6ffffbffffbf5555600208fe00010ab0671b2af00004102000000bfffeffffef80000aabb7fefffff3f7ffdfaaa8fe000005feff00dffe0019aaa9eaafbebf7f7dfacafe80deff9bfefffdffa67defcaaaaab7feff0e7eaaaaa8006dffbffffcfdfff7e000feaa0aaffffbffffbeaaaaa00208fe00011570671b55f00004102000000bfffeffffef800005572ffe7fffe7e7ffc1d554fe000005feff00dffe0019556cf56fbfbf7d7df5dbfd405ef3dbfefffdffa8f9efc5555557feff0e7d55555400cbff9ffff9f9fff07000fe550a6ffffbffffbf5555600208fe00010ab0671b2af00003e02000000bfffeffffef80000aab7fff7ffe1fcfffefeaa8fe000004feff009ffe002baaaefaaf9ebf7e7dfa9bea805ef8cbfe7ffdff8bfbefcaaaaab3fffffe7eaaaaa800dfffdfff87f3fffbf000feaa0aaffffbffffbeaaaaa001f0fe00011570671b55f00004102000000bfffeffffef800005567fff3ff8bf9e7fe0f554fe000006feff00bffe002b5566756fdfbf7efdf53bf5405efe2bff7ef9ff97fbefc555555bfffffefd555554019fffcffe2fe79ff83800fe550a6ffffbffffbf5555600208fe00010ab0671b2af00004102000000bfffeffffef80000aacffff9fc3bf3effefeaa8fe000002feff00bffe002baab73aafdfbf7efdfb7bea804f7f83ff7c7bff87fbcfcaaaaaabfffffefeaaaaa8013fffe7f0efcfbffbf800feaa0aaffffbffffbeaaaaa00208fe00011570671b55f00004102000000bfffeffffef8000055dffffc61f3cfcffe07554fe000002feff00bffe002b5557bd6fcfbf7cfdf673f5406f7fe3ff383bff8ffbcf8555555bfffffefd555554037ffff187cf3f3ff81c00fe550a6ffffbffffbf5555600208fe00010ab0671b2af00004102000000bffe003ffef80000aa9ffff00ff63f9fff7faa8fe0004027fffff3ffe002baab79eafef3f3dfdfef7ea802f7ff3ffbc7bff1ff3df8aaaaaa9fffffcfeaaaaa8027fffc03fd8fe7ffdfc00feaa0aafff800fffbeaaaaa00208fe00011570671b55f00003e020000008000ff8000f8000055bfc3e7fff0ffbfff03d54fe0004037fffff7ffe002b5557df6fef7fbdfdfcf7f5402f3ffbffbefbff7ff7df8555555dfffffdfd55555406ff0f9fffc3fefffc0e00fe550a60003fe0003f55556001f0fe00010ab065012af0fe00162000000bff7fff7fef80000ab3f9bcffff7ff7fffbfea8fe0004013ffffe7efe002baab7ceafe77fb9fdf9f7ea802fbff9ff9ff3ff7ff79f8aaaaaacfffff9faaaaaa804fe6f3fffdffdfffeff00feaa08affdfffdffbeaaaaa0fc00011570650155f0fe00162000000bff7fff7fef80000557f339fffe7fe7fff80d54fe000401bffffefefe002b5553e76ff77fbbfdfbf7f540279ffdffdff7fe7ff79f85555556fffffbfd55555405fcce7fff9ff9fffe0300fe55086ffdfffdffbf555560fc00010ab064012af0fe00162000000bff7fff7fef80000ab7e773fffeff9ffffdfea8fd00039ffffcfefe0016aabbf7aff77fbbfdf3f7ea8037dffcffdff7fefff7bf8afeaa117ffff3faaaaaa805f9dcffffbfe7ffff7f00feaa08affdfffdffbeaaaaa0fc00011570640155f0fe00162000000bff7fff7fef80000553cf67fffcfe3ffffc0f54fd0003dffffdfefe002b555bf3eff37fb3fdf7f7f54017dffeffdff7fcffe7bf055555577ffff7fd55555404f3d9ffff3f8fffff0380fe55086ffdfffdffbf555560fc00010ab064012af0fe00162000000bff7fff7fef80000abb9e4ffea9f9fffffdffa8fd00035ffffdfcfe002baaabf9effb7fb7fde7e7ea8013cffeffdff7fdffef3f0aaaaaab7ffff7faaaaaa806e793ff027e7fffff7fe0feaa08affdfffdffbeaaaaa0fc00011570640155f0fe00162000000bff7fff7fef800005583cdffd5bc3fffffc07d4fd00034ffff9fcfe0016555bfdeffb7fb7fdcfefd5400beffe7feeeffdffcf7f05fe550c3fffe7f5555554020f37fe06f0feff0101e0fe55086ffdfffdffbf555560fc00010ab064012af0fe00162000000bff7fff7fef80000aacf9dffab31ffffffeffa8fd0003600003f8fe0026aaabfceff87f87fddfefea8009e7ff7fec6ff9ffde7f0aaaaaab80000feaaaaaa8033e77fc04c7feff01bfe0feaa08affdfffdffbeaaaaa0fc00011570630155f0fe00102000000bff7fff7fef80000557fbdff567feff02fe07d4fd00032ffffbf8fe00035559fe6ffeff0ffd9fefd5400df7ff3feeeffbffbefe05fe550bbfffeff555555401fef7f809fdff0181e0fe55086ffdfffdffbf555560fc00010ab063012af0fe00102000000bff7fff7fef80000aabf93fea8ffeff02feffe8fd00032ffffbf0fe0003aaadff6ffeff0ffd3fefea8004f3ffbfefeff3ffbcfe0afeaa0bbfffefeaaaaaa8007e4ff003fdff01bff0feaa08affdfffdffbeaaaaa0fc00011570630155f0fe00102000000bff7fff7fef80000555fe7fd55ffeff02fe07d4fd0003200003f0fe00035555ff2ffeff0ffd7fefd54006fbffbfefeff7ff39fe05fe550b80000fd5555554003f9fe017fdff0181f0fe55086ffdfffdffbf555560fc00010ab061012af0fe00102000000bff7fff7fef80000aaafeffaa9ffdff017fe8fd000337f7f7f0fe0003aaadff8ffeff0ffc7fefaa80027dff9fefeff7fefbfc0afeaafedf08eaaaaaa8003fbfc027fdff01dff0feaa08affdfffdffbeaaaaa0fc000115705c0155f0fe000320000008fd00080f800005557dff553ffdff0107d4fd000313e3e7e0fe00015555faff0defd540017cffffefeffffcf3fc05fe550b4f8f9fd5555554001f3f804ffdff01c1f0fe550060fd00033f555560fc00010ab05e012af0fe00102000000bffff7fffef80000aaaaafeab7ffdff017fe8fd000311c9c7e0fe0001aaacfaff0dcfaa80013effffefeffffde7f80afeaa02c7271ffeaa05a800003f00dffdff01dff0feaa08affffdffffbeaaaaa0fc000115705e0155f0fe00102000000bffff7fffef8000055555fd567ffdff0103d4fd000311c9c7e0fe00015556faff0ddfd540009effffefeffff9eff005fe550b47271fd555555400003e009ffdff01c0f0fe55086ffffdffffbf555560fc00010ab05d012af0fe000b2000000bffff7fffef80000afeaa00aefcff01bfe8fd000313e3e7e0fe0001aaaefaff0ddfaa80004f7e000fe001f3cff00afeaa02cf8f9ffeaa00a8fe000103bffdff01eff0feaa08affffdffffbeaaaaa0fc000115705d0155f0fe000b2000000bffff7fffef800005fe55005cfcff0181d4fd000337f7f3c0fe00015556faff05dfd540006700feff04fc079fe005fe5502dfdfcffe550054fe0001033ffdff01e070fe55086ffffdffffbf555560fc00010ab05d012af0fe000b2000000bffff7fffef80000afeaa00b9fcff01bfe8fd0003200003c0fe0001aaaafaff0ddfaa800037fffbdef7bfff3fc00afeaa0280000ffeaa00a8fe0001067ffdff01eff0feaa08affffdffffbeaaaaa0fc00011570600155f0fe000b2000000bffff7fffef800005fe550073fcff0181d4fd00032ffffbc0fe001655567ffffc000fffff9f55400019ff718c631dfe7fc005fe5502bfffeffe550054fe00000cfcff01e070fe55086ffffdffffbf555560fc00010ab060012af0fe000b2000000bffff7fffef80000afeaa00e7fcff01bff8fd00036ffffbe0fe001caaab3ffe01ffe01fffbfaa80000cee3bdef7b8eeff800aaaaaabbfffeffeaa00a8fe000019fcff01effcfeaa08affffdffffbeaaaaa0fc00011570600155f0fe000b2000000bffff7fffef800005fe55006ffcff0181f4fd00034ffff9e0fe00165555bc00fff3ffc00f3f55400006477ffffffdc5ff0005fe55063fffe7d5555554fe00001bfcff01e07cfe55086ffffdffffbf555560fc00010ab060012af0fe000b2000000bffff7fffef80000afeaa00cffcff01bff8fd0003dffffde0fe001caaaa99ffffc0ffffe67faa8000036ffe00007fedfe000aaaaaab7ffff7feaa00a8fe000033fcff01effcfeaa08affffdffffbeaaaaa0fc00011570600155f0fe000b2000000bffff7fffef800005fe55009ffcff0181f4fd0003800000e0fe00205555cf3fff003fff3cff554000017f80ffff01f9fc0005555556000003d5555554fe000027fcff01e07cfe55086ffffdffffbf555560fc00010ab060012af0fe000f2000000bffff7fffef80000aaaaaabbffcff01bff8fd0003ffddfff0fe0020aaaaec0fffc0fffc0dffaa800001403ffc7ffc0bf8000aaaaaabff77ffeaaaaaa8fe00006ffcff01effcfeaa08affffdffffbeaaaaa0fc00011570600155f0fe000b2000000bffff7fffef800005fe5500bffcff0181f4fd000307ddfff0fe001655556803fff3fff005ff554000017ffff01ffffbf00005fe55065f77ffd5555554fe00006ffcff01e07cfe55086ffffdffffbf555560fc00010ab05e012af0fe000320000078fd00070f80000aaaaaab3ffcff01bff8fd00030f9cfff8fe0003aaaaac0ffeff0ffc0dfeaa80000147ffc007ff8bf0000afeaa06be73ffeaaaaaa8fe00004ffcff05effcaaaaabe0fd00033eaaaaa0fc000115705e0155f0fe0003200000c3fdff07e18000055555577ffcff0181f4fd00030f3e7ff8fe00165555473ffc000fff39fd5540000141fff01ffe0be00005fe55067cf9fff5555554fe0000dffcff05e07c5555570ffdff0387555560fc00010ab05e012af0fe00032000019ffdff07fcc0000aaaaaae7ffcff01bff8fd00030e7f3ff8fe0016aaaab7fe01ffe01ffbfaaa800001407ffc7ff80be0000afeaa0ab9fcffeaaaaaa80000019ffcff05effcaaaaae7ffdff03f3aaaaa0fc000115705d0155f0fe00032000013ffdff06fe400005555554fbff1081f4000007ff84e398fff8000055555400feff07c00bf55540000141feff12fe0be00005555fff538e77fff555540000013ffcff04e07c555554fcff03f9555560fc00010ab05a012af0fe00032000017ffcff0570000aaaaaadfbff0fbff800001c00f9ebcf800e0000aaaab7fcff1cfbfaaa80000147fe00007f8be0000aaaf003e7af3e003aaaa80000037ffcff04effcaaaaadfcff03fdeaaaa0fc000115705a0155f0fe00032000037ffcff05780005555559fbff0f81f40000f1fe03c9e03fe3c000555577fcff1cfbf5554000017f80ffff01fbe0000557c7f80f2780ff8f55540000027ffcff04e07c55555dfcff03fdf55560fc00010ab057012af0fe0002200006fb00053c000aaaaabbfbff0fbff8000187ffff9dfffff87000aaaaa7fcff1bf9eaaa800001403ffffffc0be0000aae1ffffe77ffffe1eaa8000006fbff04effcaaaab8fb0002faaaa0fc00011570570155f0fe000220000cfbff059c0005555573fbff0781f400023fffff1cfeff04100055556ffcff06fdf5554000017ffdff10fbe0000558fffffc73fffffc555400000cfbff04e07c555573fcff03fe755560fc00010ab055012af0fe0002200019fbff05cc000aaaaab7fbff0fbff800039c00fc7e3f800e7000aaaaeffcff05fdeaaa800001fc001003e0000aae7003f1f8fe0039eaa800000dfbff04effcaaaae7fbff023aaaa0fc00011570540155f0fe0002200013fbff05e60005555567fbff0f81f40000c1fe01ff803fe0fc0055554ffcff05fcf555400001fbff0fe000055707f807fe00ff83f554000019fbff04e07c55554ffbff029d5560fc00010ab050012af0fe0002200017fbff05f7000aaaaaeffbff04bff800019ffcff05fe7f00aaaac0fb0005faaa8000001ffcff04e0000aae7ffcff05f9fea800001bfbff04effcaaaadffbff02deaaa0fc00011570540155f0fe0002200017fbff05f7800555554ffbff0481f400013ffeff077fffff3f0055557ffbff05f5554000001ffcff03e0000554feff08fdfffffcfd54000013fbff04e07c55555ffbff02df5560fc00010ab04f012af0fe0002200010fb000507c00aaaaadffbff03bff80001fdff007ffeff0300aaaaaffbff05faaa8000001ffcff03e0000aaffaff04fea8000017fbff04effcaaaac0fb00021faaa0fc00011570530155f0fe0002200010fb000507c005555540fb000f01f400000ffffffc3ffffffc00555557fbff05fd554000001ffcff07e00005557ffffff5feff04f554000010fa00037c555540fb00021f5560fc00010ab049012af0fe000220001ffaff03c00aaaaaf9ff0ef800001ff03ff00ffe03fe00aaaaaffbff02feaa80f7000d0aaaffeaffeabffaaffaa800001ffaff02fcaaaaf9ff01aaa0fc0001157098006600c80000012c033000c80000012c032c00c80000012c032c0001450155f0fe0002200001faff04c005555557faff03f400001ffb00043e00555557fbff02fd5540f7000205557dfb5504fd54000001faff03fc555557faff015560fc00010ab040012af0fe0002200001faff04c00aaaaaaffaff03f800001efb00011e00f6aa0080f700020aaafafbaa04faa8000001faff03fcaaaaaffaff01aaa0fc00011570370155f0fe0002200001faff04c005555557faff00f4f600f6550040f7000005f8550354000001faff03fc555557faff015560fc00010ab037012af0fe0002200001faff04c00aaaaaaffaff00f8f600f6aa0080f700000af8aa03a8000001faff03fcaaaaaffaff01aaa0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc000115704b0155f0fe000035fd550157fdfd550050fd000101fefd000001f655fc00011fe0fd000015fd550157fdfd550050fe000101fefd000001fc55017fd5fd55fc00011fe0fd000020fc00010ab04e012af0fe00002afdaa01bc0efdaa00a0fd0002070380fe000002f6aafc00017038fd00002afdaa01bc0efdaa00a0fe0002070380fe000002fdaa02abc0eafdaafc00017038fd000020fc000115704e0155f0fe000035fd550171e3fd550050fd00020c78c0fe000001f655fc0001c78cfd000015fd550171e3fd550050fe00020c78c0fe000001fd5502571e35fd55fc0001c78cfd000020fc00010ab04d012af0fe00002afdaa01a7f9fdaa00a0fd000209fe40fe000002f6aafc00019fe4fd00002afdaa01a7f9fdaa00a0fe000209fe40fe000002fcaa017f9afdaafc00019fe4fd000020fc00011570520155f0fe000035fd55026ffdd5fe550050fd00021bff60fe000001f655fd000201bff6fd000015fd55026ffdd5fe550050fe00021bff60fe000001fd550256ffddfd55fd000201bff6fd000020fc00010ab054012af0fe00002afdaa02cffceafeaa00a0fd000213ff38fe000002f6aafd0003013ff380fe00002afdaa02cffceafeaa00a0fe000213ff38fe000002fdaa02acffcefdaafd0003013ff380fe000020fc00011570530155f0fe000035fd55025ffef5fe550050fd000217ffbcfe000001f655fd0003017ffbc0fe000015fd55025ffef5fe550050fe000217ffbcfe000001fc5501ffeffd55fd0003017ffbc0fe000020fc00010ab054012af0fe00002afdaa02dffefafeaa00a0fd000217ffbcfe000002f6aafd0003017ffbc0fe00002afdaa02dffefafeaa00a0fe000217ffbcfe000002fdaa02adffeffdaafd0003017ffbc0fe000020fc00011570540155f0fe000035fd55025ffefdfe550050fd000217ffbefe000001f655fd0003017ffbe0fe000015fd55025ffefdfe550050fe000217ffbefe000001fc5502ffefd5fe55fd0003017ffbe0fe000020fc00010ab054012af0fe00002afdaa02cffcfafeaa00a0fd000213ff3efe000002f6aafd0003013ff3e0fe00002afdaa02cffcfafeaa00a0fe000213ff3efe000002fdaa02acffcffdaafd0003013ff3e0fe000020fc00011570550155f0fe000035fd55026ffdfdfe550050fd00021bff7efe000001f655fd000301bff7e0fe000015fd55026ffdfdfe550050fe00021bff7efe000001fd550356ffdfd5fe55fd000301bff7e0fe000020fc00010ab054012af0fe00002afdaa02e7f9fafeaa00a0fd000219fe7efe000002f6aafd0003019fe7e0fe00002afdaa02e7f9fafeaa00a0fe000219fe7efe000002fdaa02ae7f9ffdaafd0003019fe7e0fe000020fc00011570550155f0fe000035fd550271e3fdfe550050fd00021c78fefe000001f655fd000301c78fe0fe000015fd550271e3fdfe550050fe00021c78fefe000001fd5503571e3fd5fe55fd000301c78fe0fe000020fc00010ab054012af0fe00002afdaa02f807fafeaa00a0fd00021e01fefe000002f6aafd000301e01fe0fe00002afdaa02f807fafeaa00a0fe00021e01fefe000002fdaa02af807ffdaafd000301e01fe0fe000020fc00011570550155f0fe000035fd5502c000fdfe550050fd000230003efe000001f655fd0003030003e0fe000015fd5502c000fdfe550050fe000230003efe000001fd55035c000fd5fe55fd0003030003e0fe000020fc00010ab054012af0fe00002afdaa029ffe7afeaa00a0fd000227ff9efe000002f6aafd0003027ff9e0fe00002afdaa029ffe7afeaa00a0fe000227ff9efe000002fdaa02a9ffe7fdaafd0003027ff9e0fe000020fc00011570580155f0fe000035fe5503573fff1dfe550050fe000301cfffc7fe000001f655fd00031cfffc70fe000015fe5503573fff1dfe550650000001cfffc7fe000001fd550373fff1d5fe55fd00031cfffc70fe000020fc00010ab059012af0fe00002afeaa03bc7fffc7feaa00a0fe0007071ffff1c0000002f6aafd000371ffff1cfe00002afeaa03bc7fffc7feaa0aa00000071ffff1c0000002feaa04abc7fffc7afeaafd000371ffff1cfe000020fc000115705b0155f0fe000035fe550771fffff1d5555550fe00071c7ffffc70000001f655fe000401c7ffffc7fe000015fe551171fffff1d555555000001c7ffffc70000001fe5504571fffff1dfe55fe000401c7ffffc7fe000020fc00010ab05b012af0fe00002afeaa00c0fe00036aaaaaa0fe000010fe000310000002f6aafe000001fe000001fe00002afeaa00c0fe00066aaaaaa0000010fe000310000002feaa00acfe000006feaafe000001fe000001fe000020fc000115705b0155f0fe000035fe55077feffeffd5555550fe00071ffbffbff0000001f655fe000401ffbffbfffe000015fe55117feffeffd555555000001ffbffbff0000001fe550457feffeffdfe55fe000401ffbffbfffe000020fc00010ab057012af0fe00002afeaa07abeffefffaaaaaa0fd00067bffbffc000002f6aafd000707bffbffc000002afeaa07abeffefffaaaaaa0fe00067bffbffc000002fdaa03beffeffffeaafd000707bffbffc0000020fc00011570590155f0fe000035fe550757effefffd555550fe000701fbffbfff000001f655fd00071fbffbfff0000015fe551157effefffd555550000001fbffbfff000001fd55067effefffd55555fd00071fbffbfff0000020fc00010ab059012af0fe00002afeaa07afcffe7ffeaaaaa0fe000701f3ff9fff000002f6aafd00071f3ff9fff000002afeaa11afcffe7ffeaaaaa0000001f3ff9fff000002fdaa06fcffe7ffeaaaaafd00071f3ff9fff0000020fc00011570590155f0fe000035fe550757dfff7ffd555550fe000701f7ffdfff000001f655fd00071f7ffdfff0000015fe551157dfff7ffd555550000001f7ffdfff000001fd55067dfff7ffd55555fd00071f7ffdfff0000020fc00010ab054012af0fe00002afdaa02dfff7afeaa00a0fd000237ffdefe000002f6aafd0003037ffde0fe00002afdaa02dfff7afeaa00a0fe000237ffdefe000002fdaa02adfff7fdaafd0003037ffde0fe000020fc00011570550155f0fe000035fd55029fff3dfe550050fd000227ffcffe000001f655fd0003027ffcf0fe000015fd55029fff3dfe550050fe000227ffcffe000001fd550359fff3d5fe55fd0003027ffcf0fe000020fc00010ab055012af0fe00002afdaa02bfffbefeaa00a0fd00022fffeffe000002f6aafd000302fffef0fe00002afdaa02bfffbefeaa00a0fe00022fffeffe000002fdaa03abfffbeafeaafd000302fffef0fe000020fc00011570550155f0fe000035fd5502bfffbdfe550050fd00026fffeffe000001f655fd000306fffef0fe000015fd5502bfffbdfe550050fe00026fffeffe000001fd55035bfffbd5fe55fd000306fffef0fe000020fc00010ab059052af00007f02afeaa03ab3fff9efeaa00a0fd00064fffe780000002f6aafd000304fffe78fe00002afeaa03ab3fff9efeaa00a0fe00064fffe780000002fdaa03b3fff9eafeaafd000304fffe78fe00022003f0fe00011570590555f000001035fe5503577fffdffe550050fd0006dffff780000001f655fd00030dffff78fe000015fe5503577fffdffe550050fe0006dffff780000001fd550377fffdf5fe55fd00030dffff78fe0002200008fe00010ab05a052af00000102afeaa03ae7fffcefeaa00a0fe0007019ffff380000002f6aafd000319ffff38fe00002afeaa03ae7fffcefeaa0aa00000019ffff380000002fdaa03e7fffceafeaafd000319ffff38fe0002200008fe000115705a0555f000002035fe550354ffffe7fe550050fe0007013ffff9c0000001f655fd000313ffff9cfe000015fe550354ffffe7fe550a500000013ffff9c0000001fd55034ffffe75fe55fd000313ffff9cfe0002200010fe00010ab05a052af00000402afeaa03adfffff7feaa00a0fe0007037ffffdc0000002f6aafd000337ffffdcfe00002afeaa03adfffff7feaa0aa00000037ffffdc0000002fdaa03dfffff7afeaafd000337ffffdcfe0002200020fe000115705a0555f000008035fe550759fffff3d5555550fe0007067ffffce0000001f655fd000367ffffcefe000015fe551159fffff3d55555500000067ffffce0000001fd55039fffff3dfe55fd000367ffffcefe0002200040fe00010ab05b052af00001002afeaa07b3fffff9eaaaaaa0fe000704fffffe70000002f6aafd00034fffffe7fe00002afeaa11b3fffff9eaaaaaa0000004fffffe70000002feaa04ab3fffff9efeaafd00034fffffe7fe0002200080fe000115705a0555f000010035fe550757fffffdd5555550fe000005feff0370000001f655fd00035ffffff7fe000015fe550a57fffffdd5555550000005feff0370000001fd55037fffffddfe55fd00035ffffff7fe0002200080fe00010ab05a052af00002002afeaa07b7fffffdeaaaaaa0fe00000dfeff0378000002f6aafd0007dffffff78000002afeaa0ab7fffffdeaaaaaa000000dfeff0378000002feaa04ab7fffffdefeaafd0008dffffff78000002001fd000115705a0555f000020035fe550767fffffcf5555550fe000009feff033c000001f655fd00079ffffff3c0000015fe550a67fffffcf5555550000009feff033c000001fe5504567fffffcffe55fd00089ffffff3c000002001fd00010ab05b012af0fe00002afeaa07effffffefaaaaaa0fe00001bfeff03bc000002f6aafe000801bffffffbc000002afeaa0aeffffffefaaaaaa000001bfeff03bc000002feaa00aefeff00effeaafe000801bffffffbc0000020fc000115705c0155f0fe000035fe55074ffffffe7d555550fe000013feff039e000001f655fe0008013ffffff9e0000015fe550a4ffffffe7d555550000013feff039e000001fe550054feff03e7d55555fe0008013ffffff9e0000020fc00010ab05b012af0fe00002afeaa00dffeff037aaaaaa0fe000017feff03de000002f6aafe0008017ffffffde000002afeaa00dffeff067aaaaaa0000017feff03de000002feaa00adfeff00f7feaafe0008017ffffffde0000020fc000115705a0155f0fe000035fe55005ffeff037d555550fe000017feff03df000001f655fe0008017ffffffdf0000015fe55005ffeff067d555550000017feff03df000001fd55feff03f7d55555fe0008017ffffffdf0000020fc00010ab05c012af0fe00002afeaa00dffeff037eaaaaa0fe000017feff03df000002f6aafe0008017ffffffdf000002afeaa00dffeff067eaaaaa0000017feff03df000002feaa00adfeff03f7eaaaaafe0008017ffffffdf0000020fc000115705a0155f0fe000035fe55005ffeff037d555550fe000017feff03df000001f655fe0008017ffffffdf0000015fe55005ffeff067d555550000017feff03df000001fd55feff03f7d55555fe0008017ffffffdf0000020fc00010ab05c012af0fe00002afeaa00dffeff037eaaaaa0fe000017feff03df000002f6aafe0008017ffffffdf000002afeaa00dffeff067eaaaaa0000017feff03df000002feaa00adfeff03f7eaaaaafe0008017ffffffdf0000020fc000115705a0155f0fe000035fe55005ffeff037d555550fe000017feff03df000001f655fe0008017ffffffdf0000015fe55005ffeff067d555550000017feff03df000001fd55feff03f7d55555fe0008017ffffffdf0000020fc00010ab05c012af0fe00002afeaa07cffffffe7eaaaaa0fe000013feff039f000002f6aafe0008013ffffff9f000002afeaa0acffffffe7eaaaaa0000013feff039f000002feaa00acfeff03e7eaaaaafe0008013ffffff9f0000020fc000115705c0155f0fe000035fe55076ffffffefd555550fe00001bfeff03bf000001f655fe000801bffffffbf0000015fe550a6ffffffefd55555000001bfeff03bf000001fe550056feff03efd55555fe000801bffffffbf0000020fc00010ab058012af0fe00002afeaa07affffffefeaaaaa0fe00000bfeff03bf000002f6aafd0007bffffffbf000002afeaa0aaffffffefeaaaaa000000bfeff03bf000002fdaafeff03efeaaaaafd0007bffffffbf0000020fc000115705a0155f0fe000035fe550767fffffcfd555550fe000009feff033f000001f655fd00079ffffff3f0000015fe550a67fffffcfd555550000009feff033f000001fe5507567fffffcfd55555fd00079ffffff3f0000020fc00010ab05a012af0fe00002afeaa07b7fffffdfeaaaaa0fe00000dfeff037f000002f6aafd0007dffffff7f000002afeaa0ab7fffffdfeaaaaa000000dfeff037f000002feaa07ab7fffffdfeaaaaafd0007dffffff7f0000020fc00011570590155f0fe000035fe550757fffffdfd555550fe000005feff037f000001f655fd00075ffffff7f0000015fe550a57fffffdfd555550000005feff037f000001fd55067fffffdfd55555fd00075ffffff7f0000020fc00010ab059012af0fe00002afeaa07b3fffff9faaaaaa0fe000704fffffe7e000002f6aafd00074fffffe7e000002afeaa11b3fffff9faaaaaa0000004fffffe7e000002feaa04ab3fffff9ffeaafd00074fffffe7e0000020fc00011570590155f0fe000035fe55075bfffffbfd555550fe000706fffffefe000001f655fd00076fffffefe0000015fe55115bfffffbfd555550000006fffffefe000001fd5506bfffffbfd55555fd00076fffffefe0000020fc00010ab058012af0fe00002afeaa07a9fffff3faaaaaa0fe0007027ffffcfe000002f6aafd000727ffffcfe000002afeaa11a9fffff3faaaaaa00000027ffffcfe000002fdaa039fffff3ffeaafd000727ffffcfe0000020fc00011570580155f0fe000035fe55075dfffff7f5555550fe0007037ffffdfc000001f655fd000737ffffdfc0000015fe55115dfffff7f55555500000037ffffdfc000001fd5503dfffff7ffe55fd000737ffffdfc0000020fc00010ab058012af0fe00002afeaa07acffffe7faaaaaa0fe0007013ffff9fc000002f6aafd000713ffff9fc000002afeaa11acffffe7faaaaaa00000013ffff9fc000002fdaa03cffffe7ffeaafd000713ffff9fc0000020fc00011570580155f0fe000035fe5507567fffcff5555550fe0007019ffff3f8000001f655fd000719ffff3f80000015fe5511567fffcff55555500000019ffff3f8000001fd550367fffcfffe55fd000719ffff3f80000020fc00010ab057012af0fe00002afeaa07ab7fffdfeaaaaaa0fd0006dffff7f8000002f6aafd00070dffff7f8000002afeaa07ab7fffdfeaaaaaa0fe0006dffff7f8000002fdaa03b7fffdfefeaafd00070dffff7f80000020fc00011570550155f0fe000035fd55063fff9ff5555550fd00064fffe7f8000001f655fd000704fffe7f80000015fd55063fff9ff5555550fe00064fffe7f8000001fd550353fff9fffe55fd000704fffe7f80000020fc00010ab057012af0fe00002afeaa07abbfffbfeaaaaaa0fd00066fffeff0000002f6aafd000306fffefffe00002afeaa07abbfffbfeaaaaaa0fe00066fffeff0000002fdaa03bbfffbfefeaafd000306fffefffe000020fc00011570580155f0fe000035fe55075f9fff3fd5555550fe000707e7ffcfe0000001f655fd00037e7ffcfefe000015fe55115f9fff3fd5555550000007e7ffcfe0000001fd5503f9fff3fdfe55fd00037e7ffcfefe000020fc00010ab05b012af0fe00002afeaa07f00ffe01eaaaaaa0fe00073c03ff8078000002f6aafe000803c03ff8078000002afeaa11f00ffe01eaaaaaa000003c03ff8078000002feaa04af00ffe01efeaafe000803c03ff80780000020fc000115705c0155f0fe000b3555555783c3f8fc3d555550fe0007e0f0fe3f0e000001f655fe001d0e0f0fe3f0e000001555555783c3f8fc3d5555500000e0f0fe3f0e000001fe5507783c3f8fc3d55555fe00080e0f0fe3f0e0000020fc00010ab05c012af0fe00162aaaaaae3ff803ff8eaaaaa00000018ffe00ffe3000002f6aafe001d18ffe00ffe3000002aaaaaae3ff803ff8eaaaaa000018ffe00ffe3000002feaa07e3ff803ff8eaaaaafe000818ffe00ffe30000020fc00011570580155f0fe00033555555cfdff07e75555500000033ffeff03f9c00001f655fe000033fdff069c00001555555cfdff06e755555000033ffeff03f9c00001fe5500cffeff03fe755555fe000033fdff039c000020fc00010ab057012af0fe00032aaaaab1fdff07f1aaaaa00000047ffeff03fc600002f6aafe000047fdff06c600002aaaaab1fdff06f1aaaaa000047ffeff07fc600002aaaaab1ffdff021aaaaafe000047fdff03c6000020fc00011570540155f0fe000335555567fdff06fcd55550000019fcff02300001f655030000019ffdff06f3000015555567fdff05fcd555500019fcff063000015555567ffdff06cd55550000019ffdff03f3000020fc00010ab053012af0fe00032aaaaacffdff06fe6aaaa0000033fcff02980002f6aa030000033ffdff06f980002aaaaacffdff05fe6aaaa00033fcff05980002aaaaacfcff06e6aaaa0000033ffdff03f9800020fc00011570510155f0fe00033555559ffcff05355550000027fcff02cc0001f655030000027ffdff06fcc0001555559ffcff043555500027fcff05cc0001555559fcff06f355550000027ffdff03fcc00020fc00010ab04f012af0fe00032aaaabbffcff05baaaa000006ffcff02ee0002f6aa02000006fcff06fee0002aaaabbffcff04baaaa0006ffcff05ee0002aaaabbfcff05fbaaaa000006fcff03fee00020fc000115704f0155f0fe00033555553ffcff059d555000004ffcff02e70001f65502000004fcff06fe70001555553ffcff049d5550004ffcff05e70001555553fcff05f9d555000004fcff03fe700020fc00010ab04d012af0fe00032aaaab7ffcff05deaaa00000dffcff02f78002f6aa0200000dfbff0578002aaaab7ffcff04deaaa000dffcff05f78002aaaab7fcff05fdeaaa00000dfbff02780020fc000115704d0155f0fe00033555577ffcff05df55500000dffcff02f78001f6550200000dfbff0578001555577ffcff04df555000dffcff05f78001555577fcff05fdf55500000dfbff02780020fc00010ab04d012af0fe00032aaaaa7ffcff05cfaaa000009ffcff02f3c002f6aa02000009fbff053c002aaaaa7ffcff04cfaaa0009ffcff05f3c002aaaaa7fcff05fcfaaa000009fbff023c0020fc000115704a0155f0fe0002355556fb00050f5550000080fc000203c001f65502000008fb00043c00155556fb00040f55500080fc000503c001555560fb0004f555000008fb00023c0020fc00010ab044012af0fe00022aaaabfaff03aaa00000faff01c002f6aa0200000ffbff04fc002aaaabfaff02aaa000faff04c002aaaabffbff04faaa00000ffbff02fc0020fc00011570450155f0fe00033555557ffbff04d55000000ffbff01e001f655fe00fbff05fe001555557ffbff03d550000ffbff04e001555557fbff01fd55fe00fbff02fe0020fc00010ab045012af0fe00032aaaaabffbff04aaa000000ffbff01e002f6aafe00fbff05fe002aaaaabffbff03aaa0000ffbff04e002aaaaabfbff01faaafe00fbff02fe0020fc00011570450155f0fe00033555557ffbff04d55000000ffbff01e001f655fe00fbff05fe001555557ffbff03d550000ffbff04e001555557fbff01fd55fe00fbff02fe0020fc00010ab045012af0fe00032aaaaabffbff04aaa000000ffbff01e002f6aafe00fbff05fe002aaaaabffbff03aaa0000ffbff04e002aaaaabfbff01faaafe00fbff02fe0020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570980066012c000001900330012c00000190032c012c00000190032c0001280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab02a052af00001e020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa02a000f0fe00011570290555f000020020f7000005f7550054f600f6550040f7000005f8550054f600f655016001fd00010ab029052af000040020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa01a002fd00011570290555f000040020f7000005f7550054f600f6550040f7000005f8550054f600f655016002fd00010ab02a052af00005e020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa02a002f0fe000115702a0555f000061020f7000005f7550054f600f6550040f7000005f8550054f600f65502600308fe00010ab02a052af000041020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa02a00208fe000115702a0555f000041020f7000005f7550054f600f6550040f7000005f8550054f600f65502600208fe00010ab02a052af000041020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa02a00208fe000115702a0555f00003e020f7000005f7550054f600f6550040f7000005f8550054f600f655026001f0fe00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc000115702d0155f0fe000035f7550050f7000001fc55017fd5fd55f6000015f7550050f8000001f655f6000020fc00010ab02e012af0fe00002af7aa00a0f7000002fdaa02abc0eafdaaf600002af7aa00a0f8000002f6aaf6000020fc000115702e0155f0fe000035f7550050f7000001fd5502571e35fd55f6000015f7550050f8000001f655f6000020fc00010ab02d012af0fe00002af7aa00a0f7000002fcaa017f9afdaaf600002af7aa00a0f8000002f6aaf6000020fc000115702e0155f0fe000035f7550050f7000001fd550256ffddfd55f6000015f7550050f8000001f655f6000020fc00010ab02e012af0fe00002af7aa00a0f7000002fdaa02acffcefdaaf600002af7aa00a0f8000002f6aaf6000020fc000115702d0155f0fe000035f7550050f7000001fc5501ffeffd55f6000015f7550050f8000001f655f6000020fc00010ab02e012af0fe00002af7aa00a0f7000002fdaa02adffeffdaaf600002af7aa00a0f8000002f6aaf6000020fc000115709800660190000001f403300190000001f4032c0190000001f4032c00012e0155f0fe000035f7550050f7000001fc5502ffefd5fe55f6000015f7550050f8000001f655f6000020fc00010ab02e012af0fe00002af7aa00a0f7000002fdaa02acffcffdaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000001fd550356ffdfd5fe55f6000015f7550050f8000001f655f6000020fc00010ab02e012af0fe00002af7aa00a0f7000002fdaa02ae7f9ffdaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000001fd5503571e3fd5fe55f6000015f7550050f8000001f655f6000020fc00010ab02e012af0fe00002af7aa00a0f7000002fdaa02af807ffdaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000001fd55035c000fd5fe55f6000015f7550050f8000001f655f6000020fc00010ab02e012af0fe00002af7aa00a0f7000002fdaa02a9ffe7fdaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000001fd550373fff1d5fe55f6000015f7550050f8000001f655f6000020fc00010ab030012af0fe00002af7aa00a0f7000002feaa04abc7fffc7afeaaf600002af7aa00a0f8000002f6aaf6000020fc00011570300155f0fe000035f7550050f7000001fe5504571fffff1dfe55f6000015f7550050f8000001f655f6000020fc00010ab030012af0fe00002af7aa00a0f7000002feaa00acfe000006feaaf600002af7aa00a0f8000002f6aaf6000020fc00011570300155f0fe000035f7550050f7000001fe550457feffeffdfe55f6000015f7550050f8000001f655f6000020fc00010ab02f012af0fe00002af7aa00a0f7000002fdaa03beffeffffeaaf600002af7aa00a0f8000002f6aaf6000020fc00011570300155f0fe000035f7550050f7000001fd55067effefffd55555f6000015f7550050f8000001f655f6000020fc00010ab030012af0fe00002af7aa00a0f7000002fdaa06fcffe7ffeaaaaaf600002af7aa00a0f8000002f6aaf6000020fc00011570300155f0fe000035f7550050f7000001fd55067dfff7ffd55555f6000015f7550050f8000001f655f6000020fc00010ab02e012af0fe00002af7aa00a0f7000002fdaa02adfff7fdaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000001fd550359fff3d5fe55f6000015f7550050f8000001f655f6000020fc00010ab02f012af0fe00002af7aa00a0f7000002fdaa03abfffbeafeaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000001fd55035bfffbd5fe55f6000015f7550050f8000001f655f6000020fc00010ab031052af00007f02af7aa00a0f7000002fdaa03b3fff9eafeaaf600002af7aa00a0f8000002f6aaf600022003f8fe00011570300555f000040035f7550050f7000001fd550377fffdf5fe55f6000015f7550050f8000001f655f600012002fd00010ab030052af00004002af7aa00a0f7000002fdaa03e7fffceafeaaf600002af7aa00a0f8000002f6aaf600012002fd00011570310555f00005e035f7550050f7000001fd55034ffffe75fe55f6000015f7550050f8000001f655f600022002f0fe00010ab031052af00006102af7aa00a0f7000002fdaa03dfffff7afeaaf600002af7aa00a0f8000002f6aaf60002200308fe00011570310555f000001035f7550050f7000001fd55039fffff3dfe55f6000015f7550050f8000001f655f60002200008fe00010ab032052af00000102af7aa00a0f7000002feaa04ab3fffff9efeaaf600002af7aa00a0f8000002f6aaf60002200008fe00011570310555f000001035f7550050f7000001fd55037fffffddfe55f6000015f7550050f8000001f655f60002200008fe00010ab032052af00004102af7aa00a0f7000002feaa04ab7fffffdefeaaf600002af7aa00a0f8000002f6aaf60002200208fe00011570320555f00003e035f7550050f7000001fe5504567fffffcffe55f6000015f7550050f8000001f655f600022001f0fe00010ab030012af0fe00002af7aa00a0f7000002feaa00aefeff00effeaaf600002af7aa00a0f8000002f6aaf6000020fc00011570310155f0fe000035f7550050f7000001fe550054feff03e7d55555f6000015f7550050f8000001f655f6000020fc00010ab030012af0fe00002af7aa00a0f7000002feaa00adfeff00f7feaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000001fd55feff03f7d55555f6000015f7550050f8000001f655f6000020fc00010ab031012af0fe00002af7aa00a0f7000002feaa00adfeff03f7eaaaaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000001fd55feff03f7d55555f6000015f7550050f8000001f655f6000020fc00010ab031012af0fe00002af7aa00a0f7000002feaa00adfeff03f7eaaaaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000001fd55feff03f7d55555f6000015f7550050f8000001f655f6000020fc00010ab031012af0fe00002af7aa00a0f7000002feaa00acfeff03e7eaaaaaf600002af7aa00a0f8000002f6aaf6000020fc00011570310155f0fe000035f7550050f7000001fe550056feff03efd55555f6000015f7550050f8000001f655f6000020fc00010ab02f012af0fe00002af7aa00a0f7000002fdaafeff03efeaaaaaf600002af7aa00a0f8000002f6aaf6000020fc00011570310155f0fe000035f7550050f7000001fe5507567fffffcfd55555f6000015f7550050f8000001f655f6000020fc00010ab031012af0fe00002af7aa00a0f7000002feaa07ab7fffffdfeaaaaaf600002af7aa00a0f8000002f6aaf6000020fc00011570300155f0fe000035f7550050f7000001fd55067fffffdfd55555f6000015f7550050f8000001f655f6000020fc00010ab030012af0fe00002af7aa00a0f7000002feaa04ab3fffff9ffeaaf600002af7aa00a0f8000002f6aaf6000020fc00011570300155f0fe000035f7550050f7000001fd5506bfffffbfd55555f6000015f7550050f8000001f655f6000020fc00010ab02f012af0fe00002af7aa00a0f7000002fdaa039fffff3ffeaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000001fd5503dfffff7ffe55f6000015f7550050f8000001f655f6000020fc00010ab02f012af0fe00002af7aa00a0f7000002fdaa03cffffe7ffeaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000001fd550367fffcfffe55f6000015f7550050f8000001f655f6000020fc00010ab02f012af0fe00002af7aa00a0f7000002fdaa03b7fffdfefeaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000001fd550353fff9fffe55f6000015f7550050f8000001f655f6000020fc00010ab02f012af0fe00002af7aa00a0f7000002fdaa03bbfffbfefeaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000001fd5503f9fff3fdfe55f6000015f7550050f8000001f655f6000020fc00010ab030012af0fe00002af7aa00a0f7000002feaa04af00ffe01efeaaf600002af7aa00a0f8000002f6aaf6000020fc00011570310155f0fe000035f7550050f7000001fe5507783c3f8fc3d55555f6000015f7550050f8000001f655f6000020fc00010ab031012af0fe00002af7aa00a0f7000002feaa07e3ff803ff8eaaaaaf600002af7aa00a0f8000002f6aaf6000020fc00011570310155f0fe000035f7550050f7000001fe5500cffeff03fe755555f6000015f7550050f8000001f655f6000020fc00010ab030012af0fe00002af7aa00a0f7000402aaaaab1ffdff021aaaaaf600002af7aa00a0f8000002f6aaf6000020fc00011570300155f0fe000035f7550050f70004015555567ffdff02cd5555f6000015f7550050f8000001f655f6000020fc00010ab02f012af0fe00002af7aa00a0f7000302aaaaacfcff02e6aaaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000301555559fcff02f35555f6000015f7550050f8000001f655f6000020fc00010ab02f012af0fe00002af7aa00a0f7000302aaaabbfcff02fbaaaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000301555553fcff02f9d555f6000015f7550050f8000001f655f6000020fc00010ab02f012af0fe00002af7aa00a0f7000302aaaab7fcff02fdeaaaf600002af7aa00a0f8000002f6aaf6000020fc000115702f0155f0fe000035f7550050f7000301555577fcff02fdf555f6000015f7550050f8000001f655f6000020fc00010ab02f012af0fe00002af7aa00a0f7000302aaaaa7fcff02fcfaaaf600002af7aa00a0f8000002f6aaf6000020fc000115702e0155f0fe000035f7550050f7000301555560fb0001f555f6000015f7550050f8000001f655f6000020fc00010ab02e012af0fe00002af7aa00a0f7000302aaaabffbff01faaaf600002af7aa00a0f8000002f6aaf6000020fc000115702e0155f0fe000035f7550050f7000301555557fbff01fd55f6000015f7550050f8000001f655f6000020fc00010ab02e012af0fe00002af7aa00a0f7000302aaaaabfbff01faaaf600002af7aa00a0f8000002f6aaf6000020fc000115702e0155f0fe000035f7550050f7000301555557fbff01fd55f6000015f7550050f8000001f655f6000020fc00010ab02e012af0fe00002af7aa00a0f7000302aaaaabfbff01faaaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab02d012af0fe000020f700000af7aa00a8f600f6aa0080fd000103f0fd00000af8aa00a8f600f6aa00a0fc000115702d0155f0fe000020f7000005f7550054f600f6550040fd00010e1cfd000005f8550054f600f6550060fc00010ab02d012af0fe000020f700000af7aa00a8f600f6aa0080fd00011806fd00000af8aa00a8f600f6aa00a0fc000115702d0155f0fe000020f7000005f7550054f600f6550040fd00011002fd000005f8550054f600f6550060fc00010ab02e012af0fe000020f700000af7aa00a8f600f6aa0080fd0002300360fe00000af8aa00a8f600f6aa00a0fc000115702e0155f0fe000020f7000005f7550054f600f6550040fd0002200170fe000005f8550054f600f6550060fc00010ab02e012af0fe000020f700000af7aa00a8f600f6aa0080fd0002200170fe00000af8aa00a8f600f6aa00a0fc000115702e0155f0fe000020f7000005f7550054f600f6550040fd0002200178fe000005f8550054f600f6550060fc00010ab02e012af0fe000020f700000af7aa00a8f600f6aa0080fd0002300378fe00000af8aa00a8f600f6aa00a0fc000115702e0155f0fe000020f7000005f7550054f600f6550040fd0002100278fe000005f8550054f600f6550060fc00010ab02e012af0fe000020f700000af7aa00a8f600f6aa0080fd0002180678fe00000af8aa00a8f600f6aa00a0fc000115702e0155f0fe000020f7000005f7550054f600f6550040fd00020e1c78fe000005f8550054f600f6550060fc00010ab02e012af0fe000020f700000af7aa00a8f600f6aa0080fd000207f878fe00000af8aa00a8f600f6aa00a0fc000115702e0155f0fe000020f7000005f7550054f600f6550040fd00023fff38fe000005f8550054f600f6550060fc00010ab02e012af0fe000020f700000af7aa00a8f600f6aa0080fd00026001b8fe00000af8aa00a8f600f6aa00a0fc000115702e0155f0fe000020f7000005f7550054f600f6550040fd0002c000e0fe000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe000303800038fe00000af8aa00a8f600f6aa00a0fc0001157098006601f400000258033001f400000258032c01f400000258032c00012f0155f0fe000020f7000005f7550054f600f6550040fe00030e00000efe000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe00003ffeff038000000af8aa00a8f600f6aa00a0fc000115702d0155f0fe000020f7000005f7550054f600f6550040fd00011001fd000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe000701d0017ff000000af8aa00a8f600f6aa00a0fc000115702f0155f0fe000020f7000005f7550054f600f6550040fe00070790013ffc000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe000707b001bffc00000af8aa00a8f600f6aa00a0fc000115702f0155f0fe000020f7000005f7550054f600f6550040fe000707a000bffc000005f8550054f600f6550060fc00010ab02e012af0fe000020f700000af7aa00a8f600f6aa0080fd0002200098fe00000af8aa00a8f600f6aa00a0fc000115702e0155f0fe000020f7000005f7550054f600f6550040fd00026000dcfe000005f8550054f600f6550060fc00010ab02e012af0fe000020f700000af7aa00a8f600f6aa0080fd000240005cfe00000af8aa00a8f600f6aa00a0fc000115702e0155f0fe000020f7000005f7550054f600f6550040fd000240004cfe000005f8550054f600f6550060fc00010ab030052af000002020f700000af7aa00a8f600f6aa0080fd0002c0006efe00000af8aa00a8f600f6aa02a00010fe00011570300555f000006020f7000005f7550054f600f6550040fd0002800026fe000005f8550054f600f65502600030fe00010ab031052af00000a020f700000af7aa00a8f600f6aa0080fe000301800032fe00000af8aa00a8f600f6aa02a00050fe00011570310555f000012020f7000005f7550054f600f6550040fe00030300001bfe000005f8550054f600f65502600090fe00010ab031052af000022020f700000af7aa00a8f600f6aa0080fe000302000009fe00000af8aa00a8f600f6aa02a00110fe00011570310555f000042020f7000005f7550054f600f6550040fe00070600000c80000005f8550054f600f65502600210fe00010ab031052af00007f020f700000af7aa00a8f600f6aa0080fe00070c000006c000000af8aa00a8f600f6aa02a003f8fe00011570310555f000002020f7000005f7550054f600f6550040fe00070800000240000005f8550054f600f65502600010fe00010ab031052af000002020f700000af7aa00a8f600f6aa0080fe0007080000026000000af8aa00a8f600f6aa02a00010fe00011570310555f000002020f7000005f7550054f600f6550040fe00071800000330000005f8550054f600f65502600010fe00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe0007100000013000000af8aa00a8f600f6aa00a0fc000115702f0155f0fe000020f7000005f7550054f600f6550040fe000730000001b8000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe000020fe0003b800000af8aa00a8f600f6aa00a0fc000115702f0155f0fe000020f7000005f7550054f600f6550040fe000020fe0003bc000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe000020fe0003bc00000af8aa00a8f600f6aa00a0fc000115702f0155f0fe000020f7000005f7550054f600f6550040fe000020fe0003bc000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe000020fe0003bc00000af8aa00a8f600f6aa00a0fc000115702f0155f0fe000020f7000005f7550054f600f6550040fe000020fe0003bc000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe000730000001bc00000af8aa00a8f600f6aa00a0fc000115702f0155f0fe000020f7000005f7550054f600f6550040fe0007100000013c000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe0007100000017c00000af8aa00a8f600f6aa00a0fc000115702f0155f0fe000020f7000005f7550054f600f6550040fe0007180000037c000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe0007080000027c00000af8aa00a8f600f6aa00a0fc000115702f0155f0fe000020f7000005f7550054f600f6550040fe000708000002fc000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe00070c000006f800000af8aa00a8f600f6aa00a0fc000115702f0155f0fe000020f7000005f7550054f600f6550040fe000704000005f8000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe00070600000df800000af8aa00a8f600f6aa00a0fc000115702f0155f0fe000020f7000005f7550054f600f6550040fe000702000009f0000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe00070300001bf000000af8aa00a8f600f6aa00a0fc000115702f0155f0fe000020f7000005f7550054f600f6550040fe000701800037e0000005f8550054f600f6550060fc00010ab02e012af0fe000020f700000af7aa00a8f600f6aa0080fd0006800027e000000af8aa00a8f600f6aa00a0fc000115702e0155f0fe000020f7000005f7550054f600f6550040fd0006c0006fe0000005f8550054f600f6550060fc00010ab02e012af0fe000020f700000af7aa00a8f600f6aa0080fd000640004fc000000af8aa00a8f600f6aa00a0fc000115702e0155f0fe000020f7000005f7550054f600f6550040fd00066000c080000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0080fe00030ff001fefe00000af8aa00a8f600f6aa00a0fc000115702f0155f0fe000020f7000005f7550054f600f6550040fe00077c3c0703c0000005f8550054f600f6550060fc00010ab02f012af0fe000020f700000af7aa00a8f600f6aa0b80000001c007fc007000000af8aa00a8f600f6aa00a0fc000115702e0155f0fe000020f7000005f7550054f600f6550340000003fd000318000005f8550054f600f6550060fc00010ab02e012af0fe000020f700000af7aa00a8f600f6aa038000000efd00030e00000af8aa00a8f600f6aa00a0fc000115702e0155f0fe000020f7000005f7550054f600f6550340000018fd000303000005f8550054f600f6550060fc00010ab02e012af0fe000020f700000af7aa00a8f600f6aa0380000030fd00030180000af8aa00a8f600f6aa00a0fc000115702d0155f0fe000020f7000005f7550054f600f6550340000060fc0002d00005f8550054f600f6550060fc00010ab02d012af0fe000020f700000af7aa00a8f600f6aa0380000040fc000248000af8aa00a8f600f6aa00a0fc000115702d0155f0fe000020f7000005f7550054f600f65503400000c0fc00026c0005f8550054f600f6550060fc00010ab02d012af0fe000020f700000af7aa00a8f600f6aa0380000080fc00022e000af8aa00a8f600f6aa00a0fc000115702d0155f0fe000020f7000005f7550054f600f6550340000080fc0002260005f8550054f600f6550060fc00010ab02d012af0fe000020f700000af7aa00a8f600f6aa0380000180fc000237000af8aa00a8f600f6aa00a0fc000115702c0155f0fe000020f7000005f7550054f600f65502400001fbff02f70005f8550054f600f6550060fc00010ab02a012af0fe000020f700000af7aa00a8f600f6aa0080f9000207000af8aa00a8f600f6aa00a0fc000115702c0155f0fe000020f7000005f7550054f600f655034000003ffbff018005f8550054f600f6550060fc00010ab02c012af0fe000020f700000af7aa00a8f600f6aa038000003ffbff01800af8aa00a8f600f6aa00a0fc000115702c0155f0fe000020f7000005f7550054f600f655034000003ffbff018005f8550054f600f6550060fc00010ab02c012af0fe000020f700000af7aa00a8f600f6aa038000003ffbff01800af8aa00a8f600f6aa00a0fc00011570280155f0fe000020f7000005f7550054f600f6550040f7000005f8550054f600f6550060fc00010ab028012af0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6aa00a0fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc000115709800660258000002bc03300258000002bc032c0258000002bc032c0001280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab02a052af00007f02af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf600022003f8fe000115702a0555f000001035f7550050f7000001f655f6000015f7550050f8000001f655f60002200008fe00010ab02a052af00000202af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf60002200010fe000115702a0555f000004035f7550050f7000001f655f6000015f7550050f8000001f655f60002200020fe00010ab02a052af00000e02af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf60002200070fe000115702a0555f000001035f7550050f7000001f655f6000015f7550050f8000001f655f60002200008fe00010ab02a052af00000102af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf60002200008fe000115702a0555f000001035f7550050f7000001f655f6000015f7550050f8000001f655f60002200008fe00010ab02a052af00004102af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf60002200208fe000115702a0555f00003e035f7550050f7000001f655f6000015f7550050f8000001f655f600022001f0fe00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab028012af0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc00011570280155f0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6550060fc0001157028012af0fe000020f7000005f7550054f600f6550040f7000005f8550050f600f6aa00a0fc00010ab0280155f0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa00a8f600f6550060fc0001157037012af0fe000020f7000005fd55015401fd550054f600fc55014015fd550040f7000005fd55015401fe550050f600f6aa00a0fc00010ab0410155f0fe000020fd000103f0fd00000afdaa02a8fc2afeaa00a8fc00003ffc00fcaa018fc2fdaa0080f700000afdaa05a8fc2aaaaaa8f600f6550060fc0001157042012af0fe000020fd00010e1cfd000005fd5502538715fe550054fc0001e1c0fd00fc55013871fd550040f7000005fd5505538715555550f600f6aa00a0fc00010ab0470155f0fe000020fd00011806fd00000afdaa01a601fdaa00a8fd0002018060fd00fcaa01601afdaa0080f700000afdaa01a601feaa00a8f600fc55014015fd550060fc000115704d012af0fe000020fd00011002fd000005fd5502440095fe550054fd0002010020fd00fd5502544009fd550040f7000005fd5505440095555550fc00003ffc00fcaa018fc2fdaa00a0fc00010ab04e0155f0fe000020fd0002300360fe00000afdaa02ac00dafeaa00a8fd0002030036fd00fcaa01c00dfdaa0080f700000afdaa05ac00daaaaaa8fc0001e1c0fd00fc55013871fd550060fc0001157051012af0fe000020fd0002200170fe000005fd550248005dfe550054fd0002020017fd00fd5503548005d5fe550040f7000005fd550548005d555550fd0002018060fd00fcaa01601afdaa00a0fc00010ab0510155f0fe000020fd0002200170fe00000afdaa02a8005efeaa00a8fd0002020017fd00fcaa028005eafeaa0080f700000afdaa05a8005eaaaaa8fd0002010020fd00fd5502544009fd550060fc0001157052012af0fe000020fd0002200178fe000005fd550248005ffe550054fd000302001780fe00fd5503548005f5fe550040f7000005fd550548005f555550fd0002030036fd00fcaa01c00dfdaa00a0fc00010ab0530155f0fe000020fd0002300378fe00000afdaa02ac00defeaa00a8fd000303003780fe00fcaa02c00deafeaa0080f700000afdaa05ac00deaaaaa8fd0002020017fd00fd5503548005d5fe550060fc0001157053012af0fe000020fd0002100278fe000005fd550244009ffe550054fd000301002780fe00fd5503544009f5fe550040f7000005fd550544009f555550fd0002020017fd00fcaa028005eafeaa00a0fc00010ab0540155f0fe000020fd0002180678fe00000afdaa02a6019efeaa00a8fd000301806780fe00fcaa026019eafeaa0080f700000afdaa05a6019eaaaaa8fd000302001780fe00fd5503548005f5fe550060fc0001157053012af0fe000020fd00020e1c78fe000005fd550243871ffe550054fc0002e1c780fe00fd5503543871f5fe550040f7000005fd550543871f555550fd000303003780fe00fcaa02c00deafeaa00a0fc00010ab0530155f0fe000020fd000207f878fe00000afdaa02a1fe1efeaa00a8fc00027f8780fe00fcaa021fe1eafeaa0080f700000afdaa05a1fe1eaaaaa8fd000301002780fe00fd5503544009f5fe550060fc0001157054012af0fe000020fd00023fff38fe000005fd55024fffcffe550054fd000303fff380fe00fd550354fffcf5fe550040f7000005fd55054fffcf555550fd000301806780fe00fcaa026019eafeaa00a0fc00010ab0540155f0fe000020fd00026001b8fe00000afdaa0298006efeaa00a8fd000306001b80fe00fdaa03a98006eafeaa0080f700000afdaa0598006eaaaaa8fc0002e1c780fe00fd5503543871f5fe550060fc0001157054012af0fe000020fd0002c000e0fe000005fe550354300038fe550054fd00020c000efd00fd550343000385fe550040f7000005fe550654300038555550fc00027f8780fe00fcaa021fe1eafeaa00a0fc00010ab0580155f0fe000020fe000303800038fe00000afeaa07a8e0000e2aaaaaa8fd000338000380fe00fdaa038e0000e2feaa0080f700000afeaa06a8e0000e2aaaa8fd000303fff380fe00fd550354fffcf5fe550060fc0001157059012af0fe000020fe00030e00000efe000005fe55074380000385555554fd0003e00000e0fe00fe55045438000038fe550040f7000005fe550643800003855550fd000306001b80fe00fdaa03a98006eafeaa00a0fc00010ab0570155f0fe000020fe00003ffeff038000000afeaa00affeff03eaaaaaa8fe000003feff00f8fe00fdaafeff00fefeaa0080f700000afeaa00affeff02eaaaa8fd00020c000efd00fd550343000385fe550060fc0001157056012af0fe000020fd00011001fd000005fe55074004004005555554fd0002010010fd00fe55045400400400fe550040f7000005fe550640040040055550fd000338000380fe00fdaa038e0000e2feaa00a0fc00010ab0570155f0fe000020fe000701d0017ff000000afdaa06f4005ffeaaaaa8fd00031d0017fffe00fdaa07af4005ffeaaaaa80f700000afdaa05f4005ffeaaa8fd0003e00000e0fe00fe55045438000038fe550060fc0001157057012af0fe000020fe00070790013ffc000005fd5506e4004fff555554fd0006790013ffc00000fd55075e4004fff5555540f7000005fd5505e4004fff5550fe000003feff00f8fe00fdaafeff00fefeaa00a0fc00010ab0590155f0fe000020fe000707b001bffc00000afeaa07abec006fffaaaaa8fd00067b001bffc00000fdaa07bec006fffaaaaa80f700000afeaa06abec006fffaaa8fd0002010010fd00fe55045400400400fe550060fc0001157057012af0fe000020fe000707a000bffc000005fd5506e8002fff555554fd00067a000bffc00000fd55075e8002fff5555540f7000005fd5505e8002fff5550fd00031d0017fffe00fdaa07af4005ffeaaaaaa0fc00010ab0560155f0fe000020fd0002200098fe00000afdaa02880026feaa00a8fd000302000980fe00fdaa03a880026afeaa0080f700000afdaa05880026aaaaa8fd0006790013ffc00000fd55075e4004fff5555560fc0001157055012af0fe000020fd00026000dcfe000005fd5502580037fe550054fd000306000dc0fe00fc5502800375fe550040f7000005fd5505580037555550fd00067b001bffc00000fdaa07bec006fffaaaaaa0fc00010ab0560155f0fe000020fd000240005cfe00000afdaa02900017feaa00a8fd0003040005c0fe00fdaa03a900017afeaa0080f700000afdaa05900017aaaaa8fd00067a000bffc00000fd55075e8002fff5555560fc0001157055012af0fe000020fd000240004cfe000005fd5502100013fe550054fd0003040004c0fe00fd550351000135fe550040f7000005fd5505100013555550fd000302000980fe00fdaa03a880026afeaa00a0fc00010ab0540555f00003e020fd0002c0006efe00000afdaa02b0001bfeaa00a8fd00030c0006e0fe00fdaa03ab0001bafeaa0080f700000afdaa05b0001baaaaa8fd000306000dc0fe00fc5502800375fe550060fc0001157055052af000041020fd0002800026fe000005fd5506200009d5555554fd000308000260fe00fd55035200009dfe550040f7000005fd5505200009d55550fd0003040005c0fe00fdaa03a900017afeaa00a0fc00010ab0560555f000041020fe000301800032fe00000afdaa0260000cfeaa00a8fd000318000320fe00fdaa03a60000cafeaa0080f700000afdaa0560000caaaaa8fd0003040004c0fe00fd550351000135fe550060fc000115705a052af000001020fe00030300001bfe000005fe550754c00006d5555554fd0003300001b0fe00fd55034c00006dfe550040f7000005fe550654c00006d55550fd00030c0006e0fe00fdaa03ab0001bafeaa02a001f0fe00010ab05a0555f000002020fe000302000009fe00000afeaa07a88000026aaaaaa8fd000320000090fe00fdaa0388000026feaa0080f700000afeaa06a88000026aaaa8fd000308000260fe00fd55035200009dfe5502600208fe000115705a052af000004020fe00070600000c80000005fe55075180000335555554fd0003600000c8fe00fd550318000033fe550040f7000005fe550651800003355550fd000318000320fe00fdaa03a60000cafeaa02a00208fe00010ab05a0555f000018020fe00070c000006c000000afeaa07ab000001baaaaaa8fd0003c000006cfe00fdaa03b000001bfeaa0080f700000afeaa06ab000001baaaa8fd0003300001b0fe00fd55034c00006dfe5502600008fe000115705a052af000020020fe00070800000240000005fe550052fe000395555554fd000380000024fe00fd550320000009fe550040f7000005fe550052fe0002955550fd000320000090fe00fdaa0388000026feaa02a00010fe00010ab05a0555f000040020fe0007080000026000000afeaa00a2fe00039aaaaaa8fd000380000026fe00fdaa0320000009feaa0080f700000afeaa00a2fe00029aaaa8fd0003600000c8fe00fd550318000033fe5502600020fe000115705b052af00007f020fe00071800000330000005fe550056fe0003cd555554fe00040180000033fe00fd55076000000cd5555540f7000005fe550056fe0002cd5550fd0003c000006cfe00fdaa03b000001bfeaa02a000c0fe00010ab05a0155f0fe000020fe0007100000013000000afeaa00a4fe00034eaaaaa8fe000001fe000013fe00fdaa0740000004eaaaaa80f700000afeaa00a4fe00024eaaa8fd000380000024fe00fd550320000009fe55016001fd000115705c012af0fe000020fe000730000001b8000005fe55004cfe00036f555554fe000003fe00031b800000fe550854c0000006f5555540f7000005fe55004cfe00026f5550fd000380000026fe00fdaa0320000009feaa01a002fd00010ab098006602bc00000320033002bc00000320032c02bc00000320032c00015d0155f0fe000020fe000020fe0003b800000afeaa00a8fe00032eaaaaa8fe000002fe00030b800000fdaa0780000002eaaaaa80f700000afeaa00a8fe00022eaaa8fe00040180000033fe00fd55096000000cd555556003f8fe000115705c012af0fe000020fe000020fe0003bc000005fe550048fe00032f555554fe000002fe00030bc00000fe55085480000002f5555540f7000005fe550048fe00022f5550fe000001fe000013fe00fdaa0740000004eaaaaaa0fc00010ab05d0155f0fe000020fe000020fe0003bc00000afeaa00a8fe00032faaaaa8fe000002fe00030bc00000fdaa0780000002faaaaa80f700000afeaa00a8fe00022faaa8fe000003fe00031b800000fe550854c0000006f5555560fc000115705d012af0fe000020fe000020fe0003bc000005fe550048fe00032f555554fe000002fe00030bc00000fe55085480000002f5555540f7000005fe550048fe00022f5550fe000002fe00030b800000fdaa0780000002eaaaaaa0fc00010ab05d0155f0fe000020fe000020fe0003bc00000afeaa00a8fe00032faaaaa8fe000002fe00030bc00000fdaa0780000002faaaaa80f700000afeaa00a8fe00022faaa8fe000002fe00030bc00000fe55085480000002f5555560fc000115705d012af0fe000020fe000020fe0003bc000005fe550048fe00032f555554fe000002fe00030bc00000fe55085480000002f5555540f7000005fe550048fe00022f5550fe000002fe00030bc00000fdaa0780000002faaaaaa0fc00010ab05d0155f0fe000020fe000730000001bc00000afeaa00acfe00036faaaaa8fe000003fe00031bc00000fdaa07c0000006faaaaa80f700000afeaa00acfe00026faaa8fe000002fe00030bc00000fe55085480000002f5555560fc000115705d012af0fe000020fe0007100000013c000005fe550044fe00034f555554fe000001fe000313c00000fe55085440000004f5555540f7000005fe550044fe00024f5550fe000002fe00030bc00000fdaa0780000002faaaaaa0fc00010ab05d0155f0fe000020fe0007100000017c00000afeaa00a4fe00035faaaaa8fe000001fe000317c00000fdaa0740000005faaaaa80f700000afeaa00a4fe00025faaa8fe000002fe00030bc00000fe55085480000002f5555560fc000115705c012af0fe000020fe0007180000037c000005fe550056fe0003df555554fe00070180000037c00000fd55076000000df5555540f7000005fe550056fe0002df5550fe000003fe00031bc00000fdaa07c0000006faaaaaa0fc00010ab05c0155f0fe000020fe0007080000027c00000afeaa00a2fe00039faaaaa8fd000680000027c00000fdaa0720000009faaaaa80f700000afeaa00a2fe00029faaa8fe000001fe000313c00000fe55085440000004f5555560fc000115705b012af0fe000020fe000708000002fc000005fe550052fe0003bf555554fd00068000002fc00000fd55072000000bf5555540f7000005fe550052fe0002bf5550fe000001fe000317c00000fdaa0740000005faaaaaa0fc00010ab05b0155f0fe000020fe00070c000006f800000afeaa07ab000001beaaaaa8fd0006c000006f800000fdaa07b000001beaaaaa80f700000afeaa06ab000001beaaa8fe00070180000037c00000fd55076000000df5555560fc000115705a012af0fe000020fe000704000005f8000005fe5507510000017f555554fd00064000005f800000fd550710000017f5555540f7000005fe5506510000017f5550fd000680000027c00000fdaa0720000009faaaaaa0fc00010ab05a0155f0fe000020fe00070600000df800000afeaa07a98000037eaaaaa8fd0006600000df800000fdaa0798000037eaaaaa80f700000afeaa06a98000037eaaa8fd00068000002fc00000fd55072000000bf5555560fc0001157059012af0fe000020fe000702000009f0000005fe5507548000027d555554fd00032000009ffe00fd550748000027d5555540f7000005fe5506548000027d5550fd0006c000006f800000fdaa07b000001beaaaaaa0fc00010ab0570155f0fe000020fe00070300001bf000000afdaa06c00006feaaaaa8fd0003300001bffe00fdaa07ac00006feaaaaa80f700000afdaa05c00006feaaa8fd00064000005f800000fd550710000017f5555560fc0001157059012af0fe000020fe000701800037e0000005fe55075460000dfd555554fd00031800037efe00fd5507460000dfd5555540f7000005fe55065460000dfd5550fd0006600000df800000fdaa0798000037eaaaaaa0fc00010ab0550155f0fe000020fd0006800027e000000afdaa06200009faaaaaa8fd00030800027efe00fdaa03a200009ffeaa0080f700000afdaa05200009faaaa8fd00032000009ffe00fd550748000027d5555560fc0001157055012af0fe000020fd0006c0006fe0000005fd550630001bfd555554fd00030c0006fefe00fd5507530001bfd5555540f7000005fd550530001bfd5550fd0003300001bffe00fdaa07ac00006feaaaaaa0fc00010ab0550155f0fe000020fd000640004fc000000afdaa06900013faaaaaa8fd0003040004fcfe00fdaa03a900013ffeaa0080f700000afdaa05900013faaaa8fd00031800037efe00fd5507460000dfd5555560fc0001157057012af0fe000020fd00066000c080000005fe55075018003035555554fd000306000c08fe00fd550301800303fe550040f7000005fe550650180030355550fd00030800027efe00fdaa03a200009ffeaa00a0fc00010ab0590155f0fe000020fe00030ff001fefe00000afeaa0783fc007f82aaaaa8fd0003ff001fe0fe00feaa08a83fc007f82aaaaa80f700000afeaa0683fc007f82aaa8fd00030c0006fefe00fd5507530001bfd5555560fc000115705a012af0fe000020fe00077c3c0703c0000005fe55071f0f01c0f1555554fe000407c3c0703cfe00fe550851f0f01c0f15555540f7000005fe55061f0f01c0f15550fd0003040004fcfe00fdaa03a900013ffeaa00a0fc00010ab05a0155f0fe000b20000001c007fc007000000afeaa077001ff001caaaaa8fe00041c007fc007fe00feaa08a7001ff001caaaaa80f700000afeaa067001ff001caaa8fd000306000c08fe00fd550301800303fe550060fc000115705a012af0fe000320000003fd000718000005555554c0fe000306155554fe000030fe000301800000fe55004cfd000361555540f7000405555554c0fe0002061550fd0003ff001fe0fe00feaa08a83fc007f82aaaaaa0fc00010ab05a0155f0fe00032000000efd00070e00000aaaaaab80fe0003038aaaa8fe0000e0fd0002e00000feaa00b8fd000338aaaa80f700040aaaaaab80fe0002038aa8fe000407c3c0703cfe00fe550851f0f01c0f15555560fc0001157056012af0fe000320000018fd000603000005555546fc0006c5555400000180fd000630000055555460fd00030c555540f7000305555546fc0001c550fe00041c007fc007fe00feaa08a7001ff001caaaaaa0fc00010ab0550155f0fe000320000030fd00060180000aaaaa8cfc000562aaa8000003fc0006180000aaaaa8c0fd0003062aaa80f700030aaaaa8cfc000162a8fe000030fe000301800000fe55004cfd000361555560fc0001157053012af0fe000320000060fc0005d00005555558fc0005355554000006fc00020d0000fe550080fd000303555540f7000305555558fc00013550fe0000e0fd0002e00000feaa00b8fd000338aaaaa0fc00010ab0520155f0fe000320000040fc000548000aaaaa90fc000512aaa8000004fc0005048000aaaaa9fc0003012aaa80f700030aaaaa90fc000512a800000180fd000630000055555460fd00030c555560fc0001157051012af0fe0003200000c0fc00056c0005555530fc00051b555400000cfc000506c000555553fc000301b55540f7000305555530fc00041b50000003fc0006180000aaaaa8c0fd0003062aaaa0fc00010ab0500155f0fe000320000080fc00052e000aaaaa20fc00050baaa8000008fc000502e000aaaaa2fb0002baaa80f700030aaaaa20fc00040ba8000006fc00020d0000fe550080fd000303555560fc000115704f012af0fe000320000080fc0005260005555520fc000509d554000008fc0005026000555552fb00029d5540f7000305555520fc000409d0000004fc0005048000aaaaa9fc0003012aaaa0fc00010ab04f0155f0fe000320000180fc000537000aaaaa60fc00050deaa8000018fc0005037000aaaaa6fb0002deaa80f700030aaaaa60fc00040de800000cfc000506c000555553fc000301b55560fc000115704c012af0fe0002200001fbff05f7000555557ffcff05fdd55400001ffbff047000555557fbff02dd5540f700030555557ffcff04fdd0000008fc000502e000aaaaa2fb0002baaaa0fc00010ab0450155f0fe000020f9000407000aaaaafb000201eaa8f800047000aaaaa0fb00021eaa80f700020aaaaafb000401e8000008fc0005026000555552fb00029d5560fc0001157048012af0fe00032000003ffbff04800555555ffbff04f554000003fbff01f800fe55faff015540f700030555555ffbff03f0000018fc0005037000aaaaa6fb0002deaaa0fc00010ab0480155f0fe00032000003ffbff04800aaaaaaffbff04eaa8000003fbff01f800feaafbff02feaa80f700030aaaaaaffbff03e800001ffbff047000555557fbff02dd5560fc0001157044012af0fe00032000003ffbff04800555555ffbff04f554000003fbff01f800fe55faff015540f700030555555ffbff00f0f800047000aaaaa0fb00021eaaa0fc00010ab0460155f0fe00032000003ffbff04800aaaaaaffbff04eaa8000003fbff01f800feaafbff02feaa80f700030aaaaaaffbff03e8000003fbff01f800fe55faff015560fc0001157032012af0fe000020f7000005f7550054f600f6550040f7000005f8550350000003fbff01f800feaafbff02feaaa0fc00010ab0310155f0fe000020f700000af7aa00a8f600f6aa0080f700000af8aa03a8000003fbff01f800fe55faff015560fc0001157028012af0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab0280155f0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc0001157028012af0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab0280155f0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc0001157028012af0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab0280155f0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc000115703b012af0fe000035fd55010000fd550050f7000001fc55014141fd55f6000015fd550157d5fd550050f8000001fd550041fb55f6000020fc00010ab0440155f0fe00002afdaa01bffefdaa00a0fd000020fc000002fcaa019c9cfdaaf600002afdaa01ac6afdaa00a0fc00047070000002f6aafc0001fff8fd000020fc000115704e012af0fe000b355555405520025501555550fd000020fc000001fc55013636fd55fc00001cfc000015fd55015c75fd550050fc0004d8d8000001fd550049fb55fc00018008fd000020fc00010ab0520155f0fe000b2aaaa80f2aa002aa780aaaa0fd000070fc000002fcaa01a2a2fdaafc000036fc00002afdaa01b01afdaa00a0fc00048888000002feaa01a89cfbaafe00083c00800801e0000020fc0001157056012af0fe000b355553f9552002f54fe55550fe00011857fc000001fc550236b6f5fe55fc000022fc000015fd5501501dfd550050fc0004dadb800001fe55025655d5fc550b00000fe400800bc13f800020fc00010ab0570155f0fe000b2aaaa6012aa002fa4032aaa0fe00010c5bfc000002fcaa029c9cfafeaafc000136e0fd00002afdaa01bc7efdaa00a0fc00047273c00002feaa02a316eafcaa0b0000180400800bc100c00020fc0001157058012af0fe000b355554017d20020540155550fe00020e4b80fd000001fc550249c9f5fe55fc00011cf0fd000015fd5501444ffd550050fc00042727c00001fe55025392f5fc550b00001005e080080100400020fc00010ab0580155f0fe000b2aaaa401782002004017aaa0fe0002064880fd000002fcaa02be14fafeaafc00010df0fd00002afdaa018447fdaa00a0fc0004f853c00002feaa02a9922afcaa0b00001005e0800801005c0020fc000115705b012af0fe000b3555540101e003c04017d550fe000207cfc0fd000001fd550354632275fe55fe000338000df0fd000015fd55017c7ffd550050fd0005018c89c00001fd5501f3f5fc550b0000100407800f01005e0020fc00010ab0600155f0fe000b2aaaa4017f00007f4017aaa0fe0002060078fd000002fdaa03a8c1c17afeaafe00046c000df007fe000b2aaa0002aaa00faa0002aaa0fd0005030705c00002feaa03a9801e2afdaa0b00001005fc0001fd005e0020fc0001157061012af0fe000b35555401c0000001c017d550fe000302000fc0fe000001fd550351804175fe55fe001345000cf00d80000015543ff155600f547ff15550fd0005060105800001fe5503548003f5fd550300001007fe000407005e0020fc00010ab05f0155f0fe000b2aaaa400007fff000017aaa0fe0002020006fd000002fdaa03ab00613afeaafe00136dc01ee0088000002aa8e01caac387a9c01caaa0fd00050c0184c00002fdaa02800182fdaa0b0000100001fffc00005e0020fc0001157061012af0fe000b355554001fc001fc0017d550fe0003020003e0fe000001fd5503520021bdfe55fe00133be012e00dbc0000155180061546c7d300065550fd0005080086e00001fe5503548000f8fd550b000010007f0007f0005e0020fc00010ab0620155f0fe000b2aaaa407f0000007f017aaa0fe000302000180fe000002fdaa03a60030bafeaafe001313e012e0073c00002aa300038ac4478e00032aa0fd00051800c2e00002feaa04a88000602afeaa0b0000101fc000001fc05e0020fc0001157062012af0fe000b355557fc008000801ff7d550fe00030e0000fefe000001fd55034c0038bdfe55fe00131be012f006fc000015560000e544479800019550fd00053000e2e00001fe55044380003f95fe550b00001ff0020002007fde0020fc00010ab0610155f0fe000b2aaaa004008000801007aaa0fe000378000008fe000002fdaa038800089efeaafe00131be012f006fc00002aac000032c4473001c0caa0fd0005200022700002feaa049e00000202feaafe00081002000200401e0020fc0001157062012af0fe000b355555f40080008017ffd550fe0007c000000fc0000001fd5503581c0cddfe55fe001319c012f006fc000015480ff81946c6603f704550fd000d60703370000155555430000003f5fe550b000003d0020002005ffe0020fc00010ab0620155f0fe00122aaaaaf40080008017ffaaa000000387c00001fe000002fdaa039014045efeaafe00131dc012700efc00002a98180c0ce38cc060186ea0fd000d405011700002aaaaa8e1f0000040feaa0b000003d0020002005ffe0020fc0001157062012af0fe0016355555f40080008017ffd5500000060d700001f8000001fd55033014065dfe55fe001314c012700af00000155030070620088380086750fd000dc05019700001555551835c00007efe550b000003d0020002005ffe0020fc00010ab0620155f0fe00162aaaaaf40080008017ffaaa000000c1910000040000002fdaa0320f7825efeaafe001314c033700af000002a90600183200986000c26a0fd001c83de09780002aaaaa306440000102aaaaa000003d0020002005ffe0020fc0001157063012af0fe0016355555540080008017d555500000380f7000007c000001fd55036080835ffe55fe001316e021701af000001530400081a38b0400043350fe00110182020d78000155554e03dc00001f155555fe000810020002005e000020fc00010ab0640155f0fe00162aaaaaa40080008017aaaaa000006203c0000010000002fdaa0340f7815efeaa1601c0001260217812f000002aa0c000c0bcda08000613a0fe00110103de05780002aaaa9880f00000040aaaaafe000810020002005e000020fc0001157063012af0fe000e355555540080008017d555500000c4fd00031f000001fe550454c01401dffe55160360001270217812f003801520800060f87c18000213d0fe000903005007780001555531fd000307c55555fe000810020002005e000020fc00010ab0640155f0fe00162aaaaaa40080008017aaaaa00001880000010004000002fdaa038014005efeaa0e0220001370217832f006c02a208000fe300410000213a0fe000902005001780002aaaa62fe0004400102aaaafe000810020002005e000020fc0001157065012af0fe00163555555403ffffe017d555500003100000010007e80001fe5504548014005ffe5516036f001170217822f00440156080001800003007821bd0fe0009020050017800015554c4fe00044001fb5555fe0008100fffff805e000020fc00010ab0650155f0fe00162aaaaaa7fe01003ff7aaaaa00006200000030002080002feaa04a88014005efeaa1601e7001138217822f006dc2a4187800801006087820be0fe000902005001780002aaa988fe0004c00082aaaafe00081ff80400ffde000020fc0001157064012af0fe0016355555540001000017d55550000c400000020003f40001fd55038014005ffe551600770011b8217862f003be154107810c0380c0c7820bd0fe000906005001780001555310fe00048000fd5555fe000810000400005e000020fc00010ab0650155f0fe00162aaaaaa40001000017aaaaa00018800000020000860002feaa04a90014004efeaa1600330010b8213842f0063e2a4107830407c0c047820be0fe000904005001380002aaa620fe0004800021aaaafe000810000400005e000020fc0001157065012af0fe000d355555540001000017d555500011fe0005020000f30001fe550451001c006ffe5516003900109861b842f00e7e154107c20603818046020bd0fe000904007001b80001554440fe000480003cd555fe000810000400005e000020fc00010ab0651255f00000802aaaaaa40001000017aaaaa00032fe0005040000430002feaa00abfe00002efeaa16001c8010dc40b8c2f00cfe2a610042020101004c021be0fe00000cfe000db80002aa8c80000001000010eaaafe000810000400005e000020fc0001157065122af0000180355555540001000017d555500064fe00050404007d8001fe550052fe00002ffe5516001480105c40b882f01cfc152100440300030048c213d0fe000008fe0004b800015559fe00050101001f7555fe000810000400005e000020fc00010ab0631b55f00002802aaaaaa40001000017aaaaa000480100000c0800218002fdaafe00002ffeaa16001640104c40bc82f034fc2a21006401000200598213e0fe000008fe000dbc0002aa92004000030200086aaafe000810000400005e000020fc00011570671b2af0000080355555540001000017d5555000d00180001818003ec001fe550052fe00002ffe5516001320104e40bc82f025f815210c2401000200570617d0fe000008fe000dbc000155340060000606000fb555fe000a10000400005e0000200040fe00010ab0671b55f00000802aaaaaa40001000017aaaaa00080008001e0300010c002feaa00abfe00006ffeaa16001130106e40bd82f065e02aa1073401800200740417e0fe00110c000001bc0002aa20002000780c00043aaafe000a10000400005e00002000c0fe00011570671b2af0000080355555540001000017d55550018000c0074061801f6001fe550051fe00004ffe5516001990102e40bd02f0c5e0152101d400810600680417d0fe0011040000013c00015460003001d0186007dd55fe000a10000400005e0000200140fe00010ab0671b55f00000802aaaaaa40001000017aaaaa0030000603c40c100102002feaa00a9fe00005ffeaa160008d8102740bd02f085e02ab0807c00838400780437e0fe0011040000017c0002aac000180f103040040aaafe000a10000400005e0000200040fe00011570651b2af0000080355555540001000017d5555002000039e0c303001fb001fd55fe00005ffe551600084c1036409b02f18de01510801c00c7c400700437d0fe0011040000017c00015480000e7830c0c007ed55fe000a10000400005e0000200040fe00010ab0671b55f00000802aaaaaa4001ffc0017aaaaa0060000ff0e9c0600083002feaa04a9800000dffeaa160008641012c0da02f109e02a90800c00438400e00c27a0fe0011060000037c0002a980003fc3a70180020eaafe000a10007ff0005e0000200040fe00011570671b2af00003e035555557fff007fff7d555500403c1803ef004000fd801fe5504548000009ffe55160008221012804202f309e01550c0040041040080082fd0fe0011020000027c00015100f0600fbc010003f755fe000a1fffc01fffde0000200040fe00010ab0660155f0fe00162aaaaaa40080008017aaaaa00c06433ffe800800040402fdaa03c00001befeaa160008301018804602f60be02a90400600600c0080086fa0fe001103000006f80002ab0190cfffa002000101aafe000a10020002005e0000200040fe0001157067012af0fe0016355555540080008017d55550080cc67ffd80180007f401fe5504544000013ffe5516000c181008804402e40be0155860020020080180086fd0fe001101000004f800015203319fff60060001fd55fe000a10020002005e0000200040fe00010ab0660155f0fe00162aaaaaa40080008017aaaaa008188cfff9006000020402fdaa036000037efeaa160004089008804402ec0be02a8820030020080100084fa0fe00110180000df80002aa06233ffe4018000081aafe000a10020002005e00002001f0fe0001157063012af0fe0016355555540080008017d555500c3299fff301c00003f601fd55032000027ffe551600040c500c804c02c80be0154820010020080300185f50fd0010800009f80001530ca67ffcc0700000fdd5fe000810020002005e000020fc00010ab0630155f0fe00162aaaaaa40080008017aaaaa00465b3fc06060000020382fdaa03a00002fefeaa160004061004804802d81bc02aac3001002008020010dfa0fd001080000bf00002a9196cffa98180000080eafe000810020002005e000020fc0001157063012af0fe0016355555540080008017d5555007cb27f8043c000003fb81fd5503300006fdfe55160004021004804802b013c0155410018011100200309f50fd000bc0001bf0000155f2c9ff510ffe0001fef5fe000810020002005e000020fc00010ab0630155f0fe00162aaaaaa40080008017aaaaa003162ff00ce00000010382fdaa039ffffcfafeaa1600040310078078022017c02aa61800801390060021bfa0fd000b7ffff3e00002a8c58bfeab38fe000140eafe000810020002005e000020fc0001157062012af0fe0010355555540080008017d5555000343fe018fe000201fb81fd5503500005fdfe550300060190fe000f026017c015520800c011100400413f50fd000a400017e00001540d0ffd56fd00017ef5fe000810020002005e000020fc00010ab0620155f0fe00102aaaaaa40080008017aaaaa001f6ffc030fe00020103c2fdaa03900005fafeaa0300020090fe000f02c017c02aab0c004010100c00437ea0fd000a400017c00002aafdbffaacfd000140fafe000810020002005e000020fc0001157062012af0fe0010355555540080008017d5555000f1ff8020fe000201fbc1fd55035ffffdf5fe5503000200d0fe000f028017c0155104004010100800c6ff50fd000a7ffff7c00001557c7ff548fd00017ef5fe000810020002005e000020fc00010ab0610155f0fe00102aaaaaa40080008017aaaaa000feff0060fd000183c2fdaa03880809fafeaa0300020070fe000f038017802aa98200601010080104fea0fd000a202027c00002aabfbfea98fd000120fafe000810020002005e000020fc000115705b012af0fe000335555557fdff08f7d55550007cfe00c0fd0001fbc1fd55034c1c1bf5fe55010002fa000d17801554830000101000030dfd50fd000a30706f800001555f7fd530fd00013ef5fe00001ffdff03de000020fc00010ab09800660320000003620330032000000362032c032000000362032c00015d0155f0fe00102aaaaaa40000800017aaaaa00000fc0080fd000183c2fdaa03ae363beafeaa010003fa000d37802aaac10000101000021bfaa0fd000a38d8ef800002aaaabfaa20fd000120fafe000810000200005e000020fc000115705d012af0fe0010355555540000800017d555500000f80180fd0001ffc1fd55034e363bf5fe55010001fa000d2f8015556100001010000613f550fd000a38d8ef80000155557f5560fd00013ff5fe000810000200005e000020fc00010ab05c0155f0fe000b2aaaaaa40000800017aaaaa0fe000001fc000140c2fdaa03ac1c19eafeaa010001fa000d2f802aaab081fff01ffe0c37faa0fd0005307067800002feaa01a840fd0001103afe000810000200005e000020fc000115705c012af0fe000b355555540000800017d55550fe000003fc00017ec1fd550348080dd5fe55010001fa00052f80155518fffe000403f86ff550fd0005202037000001fe550154c0fd00011fb5fe000810000200005e000020fc00010ab05c0155f0fe000b2aaaaaa40000800017aaaaa0fe000006fc000140c2fdaa039ffffdeafeaa010001fa000d2f802aaa88000421084000dfeaa0fd00057ffff7000002feaa01a980fd0001103afe000810000200005e000020fc000115705f012af0fe000b355555540000800017d55550fe00000cfc00017ec1fd5503500005d5fe55160001800003fff000006f00155546008e739ce201bfd550fd0005400017000001fe550053fc00011fb5fe000810000200005e000020fc00010ab05f0155f0fe000b2aaaaaa40000800017aaaaa0fe000018fc000140f2fdaa03900004eafeaa160000c001fe001fe0004f002aaaa311c4210847117faaa0fd0005400013800002feaa00a6fc0001103efe000810000200005e000020fc000115705f012af0fe000b355555540000800017d55550fe000010fc00017ef1fd5503300006f5fe5516000043ff000c003ff0df00155551b8800000023aff5550fd0005c0001b800001fe550044fc00011fbdfe000810000200005e000020fc00010ab05f0155f0fe000b2aaaaaa40000800017aaaaa0fe000030fc000140f2fdaa032000026afeaa1600006600003f0000199f002aaaa89001ffff8012feaaa0fd0005800009800002feaa008cfc0001103efe000810000200005e000020fc0001157060012af0fe000b355555540000800017d55550fe000060fc00017ef1fd55037fffff75fe5516000030c000ffc000c33f00155554807f0000fe07fd5550fe000601fffffd800001fe550058fc00011fbdfe000810000200005e000020fc00010ab05e0155f0fe000b2aaaaaa40000800017aaaaa0fe000040fc000140f2fdaa030022007afeaa16000013f0003f0003f27f002aaaaabfc0038003f5faaaa0fc00048801c00002feaa0090fc0001103efe000810000200005e000020fc000115705f012af0fe000b355555540000800017d55550fe000040fc00017ef1fd550357227ff5fe5516000017fc000c000ffafe0015555480000fe00005f55550fd00051c89ffc00001fe550010fc00011fbdfe000810000200005e000020fc00010ab05d0155f0fe00032aaaaa87fdff03f0aaaaa0fe0000c0fc000140f2fdaa03ae633ffafeaa03000013f0fe000f03f2fe002aaaaab8003ff80075faaaa0fd0005398cffe00002feaa00b0fc0001103efe00001ffdff03c2000020fc000115705d012af0fe00033555553cfd00031e555550fe000080fc00017ef1fd55035cc19ffdfe5516000018c003fff000c7fc00155554be000fe001f5f55550fd000533067fe00001fe550020fc00011fbdfe0000f0fd000378000020fc00010ab05d0155f0fe00032aaaaa60fd0007032aaaa000000180fc000140f2fdaa03a980cffafeaa1600000801fe001fe005f8002aaaaabf80038007f5eaaaa0fd000526033fe00002feaa0060fc0005103e00000180fd00030c000020fc000115705c012af0fe0003355554c0fd000601955550000003fb00107ef155555000531c650005555500000bfffe00073ff5f000155554befe000401f5f55550fd00090c7180000001555554c0fc00041fbd000003fc000306000020fc00010ab05a0155f0fe00032aaaaa80fc0005baaaa0000002fb000f40f2aaaaa3ff0614307ff0aaaa000008fc001c05f0002aaaaab801ffff8075eaaaa000000ffc1850c1ffc002aaaaa880fc0004103e000002fc000302c00020fc000115705a012af0fe000335555480fc00059d5550000006fb000f7ef155550e01fc361fc01c1555000008fc001805e000155554807f0000fe05f5555000003807f0d87f007001fe550080fc00041fbd000002fc000302600020fc00010ab0570155f0fe00022aaaa9fbff05ceaaa0000004fb000f40f2aaaa780000620000078aaa000018fc001b06e0002aaaaabfc0000003f5eaaaa00001e000018800001e02aaaaa9fb0004103e000007fbff02300020fc0001157057012af0fe0002355553fb000565555000000cfb00077ef15555c00000ebfe0004e555000010fc000602e00015555480fd001005f555500007000003ac00000381555553fb00041fbd00000cfc000301900020fc00010ab0550155f0fe00022aaaa6fb000532aaa0000008fb000f40f2aaa863ff0389c07ff18aaa000010fc00050260002aaaaafcff10fdeaaaa000018ffc0e2701ffc602aaaaa2fb0004103e000018fb0002c00020fc0001157055012af0fe000235554cfb00051b5550000018fb000f7ef155553e01fe3c7fc01f3d55000030fc0005036000155554fc001001f555500000f807f8f1ff007cf1555546fb00041fbd000030fb0002680020fc00010ab0540155f0fe00022aaaa8fb00050baaa0000010fb000f40f2aaaa60fc00ff001fc19faa00003ffbff0530002aaaaabffcff0feaaaa0000183f003fc007f067aaaaaa4fb0004103e000020fb00022c0020fc0001157051012af0fe0002355548fb00050bd550000030fb00047ef15554cffeff047ffffcdf55f8000530001555555ffcff0ff5555000033ffffffdfffff37955554cfb00041fbd000020fb00022e0020fc00010ab0520155f0fe00022aaaaffbff05fbeaa0000020fb000440f2aaaa1ffcff05fe1faa000007fbff05f8002aaaaabffcff0feaaaa000007ffffffdfffff87aaaaaa8fb0004103e00003ffbff02ef0020fc0001157053012af0fe000235554ffbff05fbd55000003ffbff0ffef155555ffffffd7ffffffd55000007fbff05f8001555555ffcff08f5555000003ffffff0feff03f155554ffaff03bd00003ffbff02ef0020fc00010ab0470155f0fe00022aaaa0fb000203eaa0f7000ef2aaaabffabffaaffeabfeaa000007fbff02fc002af7aa0da000007fc0ffc03ff80ffaaaaaa0fa00003ef800020f0020fc0001157044012af0fe0002355555faff04d550000007faff03f155555ffb55047f55000007fbff02fc0015f755035000007cfb0000f9fe55faff03fd000007faff010020fc00010ab0400155f0fe00022aaaabfaff04eaa0000007faff03f2aaaabefbaa01beaaf600002af7aa03a0000078fb00037aaaaaabfaff03fe000007faff010020fc0001157036012af0fe0002355555faff04d550000007faff00f1f655f6000015f7550050f8000001fe55faff03fd000007faff010020fc00010ab0370155f0fe00022aaaabfaff04eaa0000007faff00f2f6aaf600002af7aa00a0f8000302aaaaabfaff03fe000007faff010020fc0001157028012af0fe000035f7550050f7000001f655f6000015f7550050f8000001f655f6000020fc00010ab0280155f0fe00002af7aa00a0f7000002f6aaf600002af7aa00a0f8000002f6aaf6000020fc0001157010012af0fe00003fa9ff00e0fc00010ab0080155f09f0001157008012af09f00010ab0080155f09f0001157008012af09f00011ff0230155f0f8000008f700011f80f8000103e0f8000101f8f700007ff700011fc0e100001022012af0f8000014f700010840f800010410f7000084f7000020f7000008e100010ab0210155f0f8000022f700010840f8000004f6000084f7000020f7000008e1000115702b012af0f8000041f700010840f8000004f6000084f7000020f7000008f8000103e0f800010104f700010ab02b0155f0f8000041f700010f80f8000004f6000084f700003cf700000ff800010410f800010104f7000115702a012af0f8000041f700010840f8000004f6000084f7000020f7000008f8000004f700010104f700010ab02a0155f0f800007ff700010840f8000004f6000084f7000020f7000008f8000004f700010104f7000115702a012af0f8000041f700010840f8000004f6000084f7000020f7000008f8000004f7000101fcf700010ab02c0155f0f8000041f700010840f800010410f7000084f7000020f7000008f800010470f800010104f7000115702d012af0f8000041f700011f80f8000103e0f8000101f8f700007ff7000008f800010410f800010104f700010ab0120155f0b600010410f800010104f70001157012012af0b600010410f800010104f700010ab0120155f0b6000103e0f800010104f70001157008012af09f00010ab0080155f09f0001157008012af09f00010ab0080155f09f0001157008012af09f00010ab0080155f09f0001157006002a9daa00b00cfe550065a4550056fe55007006002a9daa00b00cfe550065a4550056fe55007006002a9daa00b00cfe550065a4550056fe55007006002a9daa00b00d037fffffefa4ff00fefeff00f006007f9dff00f0a0008fa00083ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 15.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 An interface for the game of chess. You can play a game by dragging the white and black pieces. All special moves of chess like castling, capture en passant and promotion are implemented. For castling you only move the king and the rook follows automatically. At promotion a pop-up dialog asks for the new piece. Upon capture en passant the correct pawn is removed. All moves are undoable. A game can be saved into a file and is written in readable chess notation. If you open a saved document the full history will be restored as well. The full game can be replayed and the point within the history from where the game was saved is remembered as well. On any time you can change sides (playing white from top to down or reverse). There is no check for correct moves. It will only be registered who is on the turn and shown with a white or black circle on the upper left corner. \par If GNU chess is available on your site, this GINA interface can be used for playing against the computer. To activate gnuchess press the button "Play Against Computer". The computer always uses the color shown on the upper part of the screen (black if lines 8 and 7 are on top (the default as shown in the figure), white otherwise). It immediately makes a move if it is its turn. Otherwise it indicates "Your Move" within the State text field. At any time the level (thinking time given to GNU from 0.1 seconds up to 10 hours) can be set by the level entry of menu chess. If you undo (or redo) any moves the connection to gnuchess is cut off, but can be reactivated at any desired point by pressing the button "Play Against Computer" again. The current positions of all pieces are then transmitted to GNU. \par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 15.2 Implementation\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 A chess piece is an object of the GINA class {\f22 movable-icon}. When creating a movable icon a pathname or the image can be given. To minimize the startup time in this chess application the icon- and mask-images are read from file while loading the chess program into the lisp world and the images are given to {\f22 movable-icon}. For black pieces the fact is used, that selected pieces are shown in reverse. When the user drags a piece it rises and settles down upon releasing it. This is easily imple\-mented with the{\f22  shadow-offset} slot of {\f22 movable-icon}. The main view uses the double buffering feature of GINA for flicker free overlapping of chess pieces while they are dragged around. \par For playing against the computer you have to provide the chesstool (gnuchessr) of GNU, which has a general public license. It uses a line-by-line ascii-interface and is called from lisp. Set the the global variable{\f22  *gnuchess-pathname* }to the{\f22  }path\-name of the gnuchess program of your installation within the file {\f22 chess.lisp}.\par GINAs automatic hashing of bitmap pathnames to their images, images in any format to images in z-format and images to pixmaps is used in this program to optimize time for displaying bitmaps. Images are bitmap data on lisp side (an array of pixels). There are several formats and the z-format is necessary for accessing the array within {\f22 point-inside}. To display images they can be sent to the X-server and on this side they are called pixmaps. The Lisp program holds pointers to pixmaps. This topic is hidden from the application programmer and hashing is automatically done by GINA when using the class {\f22 movable-icon}.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 15.3 Limitations and Extensions\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 We are experimenting with a general framework for storing command histories. You can test the experimental feedback animation (Debug menu) of GINA, which shows the movement of pieces upon redo. Bitmaps are borrowed from GNU Chess. \par Remember there is no checking of correct moves while gnuchess is deactivated. If you fool gnu you are on your own with its responses. Gnuchess can play against itself by changing sides after every move.\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 16. Drag and Drop Demo\par \pard\plain \f20 {{\pict\macpict\picw362\pich244 0ec50000000000f4016a1101a00082a0008e01000a0000000002d0024098002e0000000000e201700000000000e2016a0000000000e2016a000102d30006002ad5aa00800cfe55005ddc55005dfe55008007002ad6aa01ab800cfe55005ddc55005dfe55008007002ad6aa01ab800cfe55005ddc55005dfe55008007002ad6aa01ab800cfe55005ddc55005dfe55008007002ad6aa01ab800801557fd7ff01558007002ad6aa01ab800f035575555dde550675555d555755800b002af2aaf6fff0aa01ab8015035575555df555f6ff00d5f6550675555d5557558015002af2aa0083feff06f9cff9999ffe73f0aa01ab801e035575555df5550099feff07f9cff9f99ffe43d5f6550675555d5577558015002af2aa0a9c921c99f9c93090987273f0aa01ab801e035575555df5550b9c80c919f9c89999932473d5f6550675555d5577558019002af2aa0a9c8fc99ff9c99999932673f4aa00aefeaa01ab801e03557555ddf5550b9c9e099ff9c99999902673d5f6550675555d557755801b022aaafff4aa0a9c9cc99ff9c9999993e673f4aa00befeaa01ab801e035575555df5550b999cc919fc999919132473d5f6550675555d5577558015002af2aa0a839e2499fc199c9c987273f0aa01ab8019035575555df555feff009ffaff00d5f6550675555d7ff7558010002af2aa03fffff99ffafff0aa01ab801a035575555df55503fffffc3ffaff00d5f6550675555d555755800f032aaffffbdeff06effffbfffeab8006007fd5ff008009012ab5d8550256aa800901557ad8aa02ad558009012ab4d800020eab8009015578d800020d558009012ab4d800020eab8009015578d800020d558009012ab4d800020eab8009015578d800020d558009012ab4d800020eab8009015578d800020d558018052ab4000030f0fe000201c183fe000101c0e700020eab801810557807f8303000007f80c1830007e000c0e700020d558018102ab40318003000003180c00300033000c0e700020eab801b1355780318f0303c00318ec787e00318f0dce71dc0ea00020d55801b132ab40340303066003419c18300031998e6633380ea00020eab801b13557803c03030c3003c18c18300031b0cc6633180ea00020d55801b132ab403403030ff003418c18300031bfcc6633180ea00020eab801b13557803003030c0003198c18300031b00c6633180ea00020d55801b132ab40300303067003199c1833003319ce6673380ea00020eab801b13557807c0fcfc3e007f8ee7e1e007e0f9dc3b9d80ea00020d55800e012ab4f100010180ea00020eab800e015578f100010180ea00020d55800d012ab4f100000fe900020eab8009015578d800020d558009012ab4d800020eab8009015578d800020d558009012ab4d800020eab8009015578d800020d558009012ab4d800020eab8009015578d800020d558009012ab4d800020eab800901557bd8ff02fd558009012ab7d8ff02feab8009015570d8000201558009012ab0d8000202ab8009015570d8000201558009012ab0d8000202ab8009015570d8000201558009012ab0d8000202ab8009015570d800020155800b012ab0da0004060002ab800b015570da00040f000155800b012ab0da00040b0002ab800d0355700f80dc000419800155800d032ab03060dc0004118002ab800d0355704010dc000430c00155800d032ab04710dc000420c002ab800d0355708888dc000460600155800d032ab09048dc0004406002ab800d0355709048dc0004c0300155800e032ab09048dd000501803002ab800e0355709048dd00050100180155800e032ab09048dd000503001802ab800e035570f078dd000502000c0155800e032ab0f078dd000506000c02ab800e035570f078dd00050400060155800e032ab0f078dd00050c000602ab800c015570db00050800030155800c012ab0db000518000302ab800c015570db00051fffff8155800c012ab0db00053fffff82ab8009015570d8000201558009012ab0d8000202ab8009015570d8000201558009012ab0d8000202ab8009015570d8000201558009012ab0d8000202ab8009015570d8000201558009012ab0d8000202ab800c015573dbff05f807fff155800c012ab3dbff05f807ffe2ab800c015573db00051007f7c155800c012ab3db00050807e7c2ab800c015573db00051007e7c155800c012ab3db00050807c7c2ab800c015573db00051007c7c155800c012ab3db0005080783c2ab800c015573db0005100783c155800c012ab3db0005080701c2ab800c015573db0005100701c155800c012ab3db000508067fc2ab800c015573db00051006ffc155800c012ab3db00050807ffc2ab800c015573db00051006000155800c012ab3db000508060042ab800c015573db0005100600c155800c012ab3db0005080600c2ab800c015573db0005100600c155800c012ab3db0005080600c2ab800c015573db0005100600c155800c012ab3db000508067fc2ab800c015573db00051006ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc1558011012ab3f500010180e900050807ffc2ab8011015573f5000103c0e900051007ffc1558011012ab3f5000102c0e900050807ffc2ab8011015573f500010660e900051007ffc1558011012ab3f500010460e900050807ffc2ab8011015573f500010c30e900051007ffc1558011012ab3f500010830e900050807ffc2ab8011015573f500011818e900051007ffc1558015012ab3f500011018f7000018f400050807ffc2ab8015015573f50001338cf700003cf400051007ffc1558015012ab3f50001644cf700002cf400050807ffc2ab8015015573f500014826f7000066f400051007ffc1558015012ab3f50001c826f7000046f400050807ffc2ab8015015573f500018823f70000c3f400051007ffc1558016012ab3f60002018823f7000083f400050807ffc2ab8019015573f6000301082180f90002018180f500051007ffc1558019012ab3f6000303082180f90002010180f500050807ffc2ab8019015573f60003020440c0f900020310c0f500051007ffc1558019012ab3f60003060380c0f900020630c0f500050807ffc2ab8019015573f6000307ffffe0f90002045060f500051007ffc155801d012ab3fd000018fb00030fffffe0f900020c1060f500050807ffc2ab8016015573fd00003cef0002081030f500051007ffc1558016012ab3fd00002cef0002181030f500050807ffc2ab8016015573fd000066ef0002101018f500051007ffc1558016012ab3fd000046ef0002301018f500050807ffc2ab8016015573fd0000c3ef000220100cf500051007ffc1558016012ab3fd000083ef0002607c0cf500050807ffc2ab8018015573fe0002018180f000027ffffef500051007ffc1558018012ab3fe0002010180f00002fffffef500050807ffc2ab8012015573fe0002037cc0e100051007ffc1558012012ab3fe00020682c0e100050807ffc2ab8012015573fe0002048260e100051007ffc1558012012ab3fe00020c0260e100050807ffc2ab8012015573fe0002080430e100051007ffc1558012012ab3fe0002180830e100050807ffc2ab8012015573fe0002103018e100051007ffc1558012012ab3fe0002304018e100050807ffc2ab8012015573fe000220800ce100051007ffc1558012012ab3fe000260fe0ce100050807ffc2ab8012015573fe00027ffffee100051007ffc1558012012ab3fe0002fffffee100050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051007ffc155800c012ab3db00050807ffc2ab800c015573db00051006000155800c012ab3db0005080600c2ab800c015573db0005100701c155800c012ab3db0005080701c2ab800c015573db0005100783c155800c012ab3db0005080783c2ab800c015573db00051007c7c155800c012ab3db00050807c7c2ab800c015573db00051007efc155800c012ab3db00050807efc2ab800c015573db00051007ffc155800c012ab3dbaa05a8060002ab800c015573db550550040001558009012ab0d8000202ab8009015570d8000201558009012ab0d8000202ab8009015570d8000201558009012ab0d8000202ab8009015570d8000201558009012ab0d8000202ab8009017ff0d8000201ff800c012ab3dbff05f8000002aa800c015573dbff05f0000001558013032ab3ff90f700001fe9ff063fe0000002ab8013035573fe30f700003fe9ff060fe0000001558013032ab3f870f700007fe9ff0603e0000002ab8013035573e070f700007fe9ff0600e0000001558013032ab38070f700007fe9ff060020000002ab80130355730070f700007fe9ff0600e0000001558013032ab3f870f700007fe9ff0603e0000002ab8013035573fe70f700007fe9ff060fe0000001558013032ab3fff0f700007fe9ff063fe0000002ab8098002e00e2000000f4017000e2000000f4016a00e2000000f4016a00010f035573fff3deff067fe000000155800f032ab3fff7deff067fe0000002ab8009015573d8000201558009012ab2d8000202ab8009015570d8000201558009012ab0d8000202ab8007015575d655008007002ad6aa01ab800cfe55005ddc55005dfe55008007002ad6aa01ab800cfe55005ddc55005dfe55008007002ad6aa01ab800cfe55005ddc55005dfe55008007002ad6aa01ab800cfe55005ddc55005dfe5500800d033ffffffbdcff00fbfeff008006007fd5ff008002d300a0008fa00083ff}}\par \par {{\pict\macpict\picw174\pich215 0ab90000000000d700ae1101a00082a0008e01000a0000000002d002409800160000000000d700b00000000000d700ae0000000000d700ae00010bfe000010f3000380000008090015f05503955555580c033ffffff7f3ff03bffffff809032aaaaab2f0aa00b80c033ffffff7f3ff03bffffff8090015f05503955555580c033ffffff7f3ff03bffffff809032aaaaab2f0aa00b80c033ffffff7f3ff03bffffff808011540ef000105580f033fdffff7f6ff06feffffbfffeff80e042acaaab280f700002afcaa00b810043fdffff780f700063effffbfffeff8170015fe55003efe000d031803333000c61655559001655817043fdffff7b3fe000d031803033000de3effffbbffeff8150f2acaaab2b1b6f363031b67b7b3c6c62afcaa00b817153fdc00f7b1bf9bb3031bb333366dc63efc3fbbffeff8170015fe551131b99b30031b3333366cc61655559157655817153fddfff7b1b19b30031b333337ecc63efdffbbffeff817112ac9ffb2b1b19b30031b3333360cc62aa9eafeaa00b817153fdffff7b3319bb301b33373766dc63effffbbffeff8170015fe55113e30f36301f331b1b3c6c61655559157655812063fdffff7800003f900063effffbbffeff810062acaaab2800003f900002afcaa00b812063fdffff7800003f900063effffbfffeff80f03155ffff7f6ff06feffffbfffe55807007feeff01eff80801002aefaa01800808013ff5ef55014ff808011568ef0001c55808013ff0ef0001cff808012ae8ef0001cab808013ff0ef0001cff808011568ef0001c55808013ff0ef0001cff808012ae8ef0001cab808013ff0ef0001cff817051568000061e0fe0002038306fe00010380fe0001c55817103ff00ff060600000ff018306000fc00180fe0001cff817102ae8063000600000630180060006600180fe0001cab817153ff00631e0607800631d8f0fc00631e1b9ce3b80cff81715156806806060cc006833830600063331ccc66700c55817153ff007806061860078318306000636198cc66300cff817152ae806806061fe0068318306000637f98cc66300cab817153ff006006061800063318306000636018cc66300cff81715156806006060ce006333830660066339ccce6700c55817153ff00f81f9f87c00ff1dcfc3c00fc1f3b8773b00cff80a012ae8f100030300cab80a013ff0f100030300cff80a011568f100031e00c55808013ff0ef0001cff808012ae8ef0001cab808013ff0ef0001cff808011568ef0001c55808013ff0ef0001cff808012ae8ef0001cab808013ff0ef0001cff808011568ef0001c55808013ff7efff01cff808012aefefff01cab808013fe0ef00010ff808011560ef0001055808013fe0ef00010ff808012ae0ef00010ab808013fe0ef00010ff80c011560f5000006fc0001055814013fe0fd00083f9ef3c73ffc00281efc00010ff814012ae0fd000818cc6663198c002806fc00010ab814013fe0fd000818cc6c33998c00fe06fc00010ff814011560fd000818cc6c3399a0002806fc0001055814013fe0fd0008198fec3359e0002806fc00010ff814012ae0fd00081f0c6c3359a000fe06fc00010ab814013fe0fd0008180c6c33398c002806fc00010ff814011560fd0008180c6663398c002806fc0001055815013fe0fd00093e1ef3c79bfc00281f80fd00010ff808012ae0ef00010ab808013fe0ef00010ff808011560ef0001055808013fe0ef00010ff808012ae0ef00010ab808013fe0ef00010ff808011560ef0001055808013fe2efaa010ff808012ae5ef55010ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055812013fe2fb0005fe7bcf1cfff0fc0002030ff812012ae4fb00056331998c6630fc0002030ab812013fe2fb00056331b0ce6630fc0002030ff812011564fb00056331b0ce6680fc000203055812013fe2fb0005663fb0cd6780fc0002030ff812012ae4fb00057c31b0cd6680fc0002030ab812013fe2fb00056031b0cce630fc0002030ff812011564fb00056031998ce630fc000203055812013fe2fb0005f87bcf1e6ff0fc0002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff808012ae5efff010ab808013fe3efff010ff808011560ef0001055808013fe2efaa010ff808012ae5ef55010ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055810013fe2fa00037f9f1ce0fb0002030ff810012ae4fa000331870cc0fb0002030ab810013fe2fa0003318d8cc0fb0002030ff810011564fa0003340d8780fb00020305580f013fe2fa00023c0d83fa0002030ff810012ae4fa00033418c780fb0002030ab810013fe2fa0003301fccc0fb0002030ff810011564fa00033018ccc0fb000203055810013fe2fa00037c3dfce0fb0002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809017fe4f00002030ff809010022f0000203000809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff809012ae4f00002030ab809013fe2f00002030ff809011564f0000203055809013fe2f00002030ff808012ae5efff010ab808013fe3efff010ff808011560ef0001055808013fe0ef00010ff808012ae0ef00010ab808013fc0ef00010ff8090015f05503955555580c033ffffff7f3ff03bffffff809032aaaaab2f0aa00b80c033ffffff7f3ff03bffffff8090015f05503955555580c033ffffff7f3ff03bffffff809032aaaaab2f0aa00b80c033ffffff7f3ff03bffffff806007fedff00f802eb00a0008fa00083ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 16.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 This demonstration program implements a number of different drag-commands. There are two different applications\: a drag application where triangles can be dragged into a view, and a drop application that can receive triangles for different purposes. However, the triangles in the drag application can also be copied between drag documents. The drag application consists of a main view where triangles can be installed, a drag-label looking like a magnet to delete triangles, a feedback label, and a triangle template that can be used to create new triangles. The triangle template uses a triangle bitmap that can be dragged into the view. It is an intra-document command, because it cannot create triangles in other documents. It demonstrates tracking, because the current position relative to the target view is displayed in the feedback label. The magnet demonstrates subtargets (highlighting the triangle it is over), but is also bound to the same document. The triangles in the view create a drag-command that may be received in other documents and applications. It uses a copy semantics and the transfer value is used to transfer the number of the triangle. Dragged triangle copies may be received by the drop application. The number of the triangle and the operation (depending on the target) are reported in a label. All the commands in the program are undoable. \par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 16.2 Implementation\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 Drag and Drop is a topic within the User Manual. See there for details.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 16.3 Source Code\par \pard\plain \s10 \f22\fs12 ;;; -*- Mode\: LISP; Syntax\: Common-Lisp; Package\: dd;Base\: 10 -*-\par (in-package \:GINA)\par (defginapackage \:dd)\par (in-package \:dd)\par (setq *sccs-id* "@(#)drag-and-drop.lisp\tab 1.3  1/16/92")\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class drag-application\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass drag-application (application)\par   (;; overrides\par    (name          \:initform "Drag"         \:allocation \:class)\par    (document-type \:initform 'drag-document \:allocation \:class)\par    (signature     \:initform "drag"               \:allocation \:class)\par    (file-type     \:initform "drag"               \:allocation \:class))\par   (\:documentation "a simple drag demo application"))\par \par (defun make-drag-application ()\par   "start the drag-application"\par   (make-application \:class 'drag-application))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class drag-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass drag-document (document)\par   (;; instance-variables\par    (track-label    \:accessor track-label\par          \:documentation "a label where tracking information is displayed")\par    (drag-template  \:accessor drag-template\par          \:documentation "a drag label as triangle template")\par    (drag-protocols \:initform '(\:copy_triangle) \:allocation \:class))\par   (\:documentation "application dependent document type"))\par \par (defmethod write-to-stream ((doc drag-document) stream)\par   "write the document to the specified stream"\par   (format stream "~d~%" (length (view-objects (main-view doc))))\par   (loop for obj in (view-objects (main-view doc))\par         do (format stream "~d ~d ~d~%" (x-pos obj) (y-pos obj) \par \tab \tab    (id-number obj))))\par \par (defmethod read-from-stream ((doc drag-document) stream &aux objects) \par   "read the document from the specified stream"\par   ;; delete all present objects in case of revert\par   (loop for obj in (view-objects (main-view doc))\par         do (deinstall obj))\par \par   (setq objects (read stream))\par   (loop repeat objects\par    do (let* ((x-pos (read stream))\par \tab      (y-pos (read stream))\par \tab      (view (main-view doc))\par \tab      (new-tri (make-triangle (obj-width view) (obj-height view) \par \tab \tab \tab \tab      (read stream))))\par \tab (install new-tri view x-pos y-pos))))\par \par (defmethod create-windows ((doc drag-document) \par \tab \tab \tab    &aux scroller form label)\par   "create the windows belonging to this document"\par   (with-slots (main-shell main-view) doc\par     (setq main-shell (make-document-shell doc))\par     (setq scroller   (make-scroller main-shell))\par     (setq main-view  (make-drag-view scroller doc))\par     (setq form (make-form main-shell))\par     (set-motif-resources (main-window main-shell) \par \tab \tab \tab  \:command-window (widget-id form))\par \par     (setq label (make-drag-label form doc "magnet"\par                                  \:cursor-mask "magnet-mask"))\par     (setf (activate-callback label)\par           (make-callback 'make-magnet-dragger doc label))\par     (define-form-constraint label \:left-attachment \:form \:top-attachment \:form\par                             \:bottom-attachment \:form)\par \par     (setf (drag-template doc) \par           (make-drag-label form doc "triangle"))\par     (setf (activate-callback (drag-template doc))\par           (make-callback 'make-triangle-dragger doc (drag-template doc)))\par     (define-form-constraint (drag-template doc) \:left-attachment \:none \par \tab \tab \tab     \:top-attachment \:form \:right-attachment \:form)\par \par     (setf (track-label doc)\par           (make-label form ""))\par     (define-form-constraint (track-label doc) \:left-attachment \:widget\par \tab \tab \tab     \:left-widget label \:top-attachment \:form\par \tab \tab \tab     \:bottom-attachment \:form\par \tab \tab \tab     \:right-attachment \:widget\par \tab \tab \tab     \:right-widget (drag-template doc))\par     ))\par \par (defmethod create-drop-command ((doc drag-document) shell x y protocol-id\par \tab \tab \tab \tab transfer-value received-from)\par   "create a duplicate command when dropping from another document"\par   (case protocol-id\par     ((\:copy_triangle)\par         (make-triangle-copier doc shell x y \par                               \:transfer-value transfer-value\par                               \:received-from received-from))))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class drag-view\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass drag-view (view)\par   ((bitmap-name   \:accessor bitmap-name  \:initform "triangle")\par    (image         \:accessor image)\par    (pixmap        \:accessor pixmap)\par    (obj-width     \:accessor obj-width)\par    (obj-height    \:accessor obj-height))\par   (\:documentation "a view with special draw method and reaction to clicks"))\par \par (defun make-drag-view (parent doc &aux new-view)\par   "create a new drag-view"\par   (setq new-view (make-view parent \:document doc \:class 'drag-view))\par   (setf (image new-view)\par         (xlib\:read-bitmap-file (find-bitmap (bitmap-name new-view))))\par   (setf (obj-width new-view) (xlib\:image-width (image new-view)))\par   (setf (obj-height new-view) (xlib\:image-height (image new-view)))\par   new-view)\par \par (defmethod determine-window-id \:after ((view drag-view) &aux gc)\par   "create a pixmap for triangle drawing"\par   (setf (pixmap view)\par         (xlib\:create-pixmap \:width (obj-width view) \:height (obj-height view) \par                             \:depth 1 \:drawable (x-window view)))\par   ;; must have a separate GC for the pixmap because of different depth\par   (setq gc (xlib\:create-gcontext \:drawable (pixmap view)))\par   (xlib\:put-image (pixmap view) gc (image view) \:x 0 \:y 0))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class triangle\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass triangle (view-object)\par   ((id-number \:accessor id-number \:initarg \:id-number))\par   (\:documentation "a triangle in a view"))\par \par (defun make-triangle (width height id-number)\par   (make-view-object width height \:class 'triangle \par \tab \tab     \:initargs (list \:id-number id-number)))\par \par (defmethod draw ((obj triangle) count x y width height)\par   (declare (ignore count x y width height))\par   (xlib\:copy-plane (pixmap (parent-view obj)) (gcontext (parent-view obj)) 1\par                    0 0 \par \tab \tab    (obj-width (parent-view obj)) (obj-height (parent-view obj))\par                    (x-window (parent-view obj)) (x-pos obj) (y-pos obj))\par   (draw-glyphs obj (- (round (/ (width obj) 2)) 5) (- (height obj) 6) \par \tab        (write-to-string (id-number obj))))\par \par (defmethod button-press ((obj triangle) code repetition x y)\par   "create a copy-drag command for this triangle"\par   (when (= repetition 1)\par     (case code\par       ((\:select)\par             (make-triangle-copier (document (parent-view obj))\par \tab \tab \tab \tab   (parent-view obj) x y\par \tab \tab \tab \tab   \:transfer-value (id-number obj)\par \tab \tab \tab \tab   \:x-off (x-pos obj) \:y-off (y-pos obj))))))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class magnet-dragger\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass magnet-dragger (drag-command)\par   ((name      \:initform "Delete Triangle"   \:allocation \:class)\par    (deleted-object \:accessor deleted-object)))\par \par (defun make-magnet-dragger (doc source x y)\par   (make-drag-command doc source x y (list (list (main-view doc) \:view))\par \tab \tab      \:cursor (cursor source)\par \tab \tab      \:class 'magnet-dragger))\par \par (defmethod draw-target-feedback ((cmd magnet-dragger) view x y value\par \tab \tab \tab \tab  &key (clear nil))\par   "find view object under cursor and highlight it"\par   (declare (ignore clear))\par   (when (eql value \:view)\par     (loop for obj in (view-objects view)\par         when (point-inside obj x y)\par         do (xlib\:with-gcontext ((gcontext view) \:function boole-xor\par \tab \tab \tab \tab \:foreground (xor-foreground view))\par              (draw-rectangle obj 0 0 (1- (width obj)) (1- (height obj))))\par            (return nil))))\par \par (defmethod executable ((cmd magnet-dragger))\par   "check whether successful in final position"\par   (setf (deleted-object cmd)\par         (loop for obj in (view-objects (current-target cmd))\par               when (point-inside obj (target-x cmd) (target-y cmd))\par               return obj))\par   (deleted-object cmd))\par \par (defmethod doit ((cmd magnet-dragger))\par   "delete the object"\par   (deinstall (deleted-object cmd)))\par \par (defmethod undoit ((cmd magnet-dragger))\par   "reinstall the deleted object"\par   (install (deleted-object cmd) (current-target cmd)\par            (x-pos (deleted-object cmd)) (y-pos (deleted-object cmd))))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class triangle-dragger\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass triangle-dragger (drag-command)\par   ((name         \:initform "Make Triangle"   \:allocation \:class)\par    (new-triangle \:accessor new-triangle   \:initform nil)))\par \par (defun make-triangle-dragger (doc source x y)\par   (make-drag-command doc source x y (list (list (main-view doc) nil))\par \tab \tab      \:cursor \:left-ptr\par \tab \tab      \:shell-to-move (drag-shell source)\par \tab \tab      \:class 'triangle-dragger))\par \par (defmethod track-target ((cmd triangle-dragger) widget x y value)\par   "display current position as feedback"\par   (declare (ignore value))\par   (setf (label-string (track-label (document cmd)))\par         (if widget\par             (format nil "(~d, ~d)" x y)\par \tab     "")))\par \par (defmethod doit ((cmd triangle-dragger))\par   "create a new triangle at target position"\par   (unless (new-triangle cmd)\par     (let ((view (main-view (document cmd))))\par       (setf (label-string (track-label (document cmd))) "")\par       (setf (new-triangle cmd) \par \tab     (make-triangle (obj-width view) (obj-height view) \par \tab \tab \tab    (length (view-objects view))))))\par   (install (new-triangle cmd) (main-view (document cmd))\par            (target-x cmd) (target-y cmd)))\par \par (defmethod undoit ((cmd triangle-dragger))\par   "remove the installed triangle"\par   (deinstall (new-triangle cmd)))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class triangle-copier\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass triangle-copier (drag-command)\par   ((name    \:initform "Copy Triangle"    \:allocation \:class)\par    ;; triangle must be dragged away\par    (hysteresis    \:initform 5            \:allocation \:class)\par    ;; protocol-id needed to identify for foreign apps\par    (protocol-id   \:initform \:copy_triangle  \:allocation \:class)\par    ;; new slot\par    (new-triangle  \:accessor new-triangle \:initform nil)))\par \par (defun make-triangle-copier (doc source x y\par \tab \tab \tab      &key (x-off 0) (y-off 0)\par \tab \tab \tab           (transfer-value nil)\par \tab \tab \tab           (received-from nil))\par   (make-drag-command doc source \par \tab \tab      (+ x x-off) (+ y y-off)\par \tab \tab      (list (list (main-view doc) nil))\par \tab \tab      \:shell-to-move (drag-shell (drag-template doc))  ;; abused\par \tab \tab      \:cursor \:left-ptr\par \tab \tab      \:x-off x-off\par \tab \tab      \:y-off y-off\par \tab \tab      \:transfer-value transfer-value  ;; triangle number will\par \tab \tab                                      ;; be transferred\par \tab \tab      \:received-from received-from\par \tab \tab      \:class 'triangle-copier))\par \par (defmethod track-target ((cmd triangle-copier) widget x y value)\par   "display current position as feedback, only in own document"\par   (declare (ignore value))\par   (setf (label-string (track-label (document cmd)))\par         (if widget\par             (format nil "(~d, ~d)" x y)\par \tab     "")))\par \par (defmethod doit ((cmd triangle-copier))\par   "install a new triangle copy"\par   (unless (new-triangle cmd)\par     (setf (label-string (track-label (document cmd))) "")\par     (setf (new-triangle cmd)\par           (make-triangle (obj-width (main-view (document cmd)))\par                          (obj-height (main-view (document cmd)))\par                          (transfer-value cmd))))\par   (install (new-triangle cmd) (main-view (document cmd))\par            (target-x cmd) (target-y cmd)))\par \par (defmethod undoit ((cmd triangle-copier))\par   "remove the triangle"\par   (deinstall (new-triangle cmd)))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; main program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par ;;; start drag application\par \par (register-application "drag" 'drag-application "drag")\par '(make-drag-application)\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class drop-application\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass drop-application (application)\par   (;; overrides\par    (name          \:initform "Drop"         \:allocation \:class)\par    (document-type \:initform 'drop-document \:allocation \:class)\par    (signature     \:initform "drop"               \:allocation \:class)\par    (file-type     \:initform "drop"               \:allocation \:class))\par   (\:documentation "a simple drop demo application"))\par \par (defun make-drop-application ()\par   "start the drop-application"\par   (make-application \:class 'drop-application))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class drop-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass drop-document (document)\par   (;; instance-variables\par    (fax            \:accessor fax)\par    (phone          \:accessor phone)\par    (panel          \:accessor panel)\par    ;; signal the acceptance of a triangle-copier\par    (drag-protocols \:initform '(\:copy_triangle) \:allocation \:class))\par   (\:documentation "application dependent document type"))\par \par (defmethod create-windows ((doc drop-document) \par \tab \tab \tab    &aux rc)\par   "create the windows belonging to this document"\par   (with-slots (main-shell) doc\par     (setq main-shell (make-document-shell doc))\par     (setq rc (make-row-column main-shell \:orientation \:vertical\par              \:entry-alignment \:center))\par     (setf (panel doc)\par           (make-label rc " "))\par     (setf (phone doc)\par           (make-push-button rc "PHONE" \par \tab \tab       \:motif-resources '(\:margin-height 20 \:margin-width 15)))\par     (setf (fax doc)\par           (make-push-button rc "FAX"\par                       \:motif-resources '(\:margin-height 20 \:margin-width 15)))\par     ))\par \par (defmethod create-drop-command ((doc drop-document) shell x y protocol-id\par \tab \tab \tab \tab transfer-value received-from)\par   "when accepting a triangle copier, a command of a different class is created"\par   (case protocol-id\par     ((\:copy_triangle)\par         (make-triangle-receiver doc shell x y \par                                 \:transfer-value transfer-value\par                                 \:received-from received-from))))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class triangle-receiver\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass triangle-receiver (drag-command)\par   ((causes-change \:initform nil             \:allocation \:class)\par    (protocol-id   \:initform \:copy_triangle  \:allocation \:class)\par    (do-tracking   \:initform nil             \:allocation \:class)\par    ;; new slot\par    (old-label     \:accessor old-label       \:initform nil)))\par \par (defun make-triangle-receiver (doc source x y\par \tab \tab \tab        &key (transfer-value nil)\par \tab \tab \tab             (received-from nil))\par   (make-drag-command doc source x y\par \tab \tab      (list (list (phone doc) \:phone)\par \tab \tab \tab    (list (fax doc)   \:fax))\par \tab \tab      \:transfer-value transfer-value\par \tab \tab      \:received-from received-from\par \tab \tab      \:class 'triangle-receiver))\par \par (defmethod doit ((cmd triangle-receiver))\par   "display action that would have been taken, name depends on target"\par   (unless (old-label cmd)\par     (setf (old-label cmd) (label-string (panel (document cmd))))\par     (setf (name cmd) \par           (format nil "~a #~d" (current-value cmd) (transfer-value cmd))))\par   (setf (label-string (panel (document cmd))) (name cmd)))\par \par (defmethod undoit ((cmd triangle-receiver))\par   "restore old panel contents"\par   (setf (label-string (panel (document cmd))) (old-label cmd)))\par \par ;;; start drop application\par (register-application "drop" 'drop-application "drop")\par '(make-drop-application)\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 17. Mandelbrot Demo\par \pard\plain \f20 {{\pict\macpict\picw503\pich458 26310000000001ca01f71101a00082a0008e01000a0000000002d002409800400000000000a201f80000000000a201f70000000000a201f7000102c10007002ac4aa01a8000cfe55005dca5504d55555580007002ac4aa01b8000cfe55005dca5504d55555580007002ac4aa01b8000cfe55005dca5504d55555580007002ac4aa01b8000cfe55005dca5504d55555580007002ac4aa01b8000901557fc6ff02f5580007002ac4aa01b80010035575555dcd5507575555d5557558000f002aecaa00bff2ff00eaeaaa01b80018035575555def55005ff2ff00d5f05507575555d5557558001b002aecaa10b3e7ffff3fc9ffff9ffce7fccccfff39eaeaaa01b80024035575555def551053e7ffff3fc9ffff9ffce7fcfccfff21d5f05507575555d5577558001b002aecaa10b1c6193930c932430cfce498484c3939eaeaaa01b80024035575555def551051c4c892264890199cfce44cccc99239d5f05507575555d5577558001f002aecaa10b087c993264991999ffce4ccccc99339eaeeaa00eafeaa01b8002403557555ddef551052a60993204993999ffce4ccccc81339d5f05507575555d55775580022022aaaffeeaa10b224c99327c993999ffce4ccccc9f339eaefaa01abeafeaa01b80024035575555def55105364c9922648939994fe4ccc8c899239d5f05507575555d5577558001b002aecaa10b366219930c933c3ccfe0cce4e4c3939eaeaaa01b80018035575555def55005ff2ff00d5f05507575555d7ff7558000f002aecaa00bff2ff00eaeaaa01b80018035575555def55005ff2ff00d5f05507575555d55575580010032aaffffbcdff07feffffbfffeab80007007fc4ff01f80009012ab5c655026aa8000901557ac6aa02d5580009012ab4c60002eab80009015578c60002d5580009012ab4c60002eab80009015578c60002d5580009012ab4c60002eab80009015578c60002d5580009012ab4c60002eab80009015578c60002d5580018052ab4000030f0fe000201c183fe000101c0d50002eab8001810557807f8303000007f80c1830007e000c0d50002d5580018102ab40318003000003180c00300033000c0d50002eab8001b1355780318f0303c00318ec787e00318f0dce71dc0d80002d558001b132ab40340303066003419c18300031998e6633380d80002eab8001b13557803c03030c3003c18c18300031b0cc6633180d80002d558001b132ab403403030ff003418c18300031bfcc6633180d80002eab8001b13557803003030c0003198c18300031b00c6633180d80002d558001b132ab40300303067003199c1833003319ce6673380d80002eab8001b13557807c0fcfc3e007f8ee7e1e007e0f9dc3b9d80d80002d558000e012ab4f100010180d80002eab8000e015578f100010180d80002d558000d012ab4f100000fd70002eab80009015578c60002d5580009012ab4c60002eab80009015578c60002d5580009012ab4c60002eab80009015578c60002d5580009012ab4c60002eab80009015578c60002d5580009012ab4c60002eab8000901557bc6ff02d5580009012ab7c6ff02eab80009015570c6000215580009012ab0c600022ab80009015570c6000215580023012ab0f60003078000e0f90002600038f9000218000ef9000306000380f700022ab8002d015570f600030cc001b0fe00077380000001e0006cf9000278001bfe00010f3cfe00031e0006c0f700021558002d012ab0f6000e0cc00318000e00330000e0006000c6f9000e1800318000e00618000e0006000c60f700022ab8002c015570f5000dc0031800380033000380006000c6f9000e180031800380033000380006000c60f700021558002c012ab0f5000dc0031800e0001e000e00006000c6f9000e180031800e00033000e00006000c60f700022ab80030015570f7000f1fc18003180180000c001800006000c6fb001001fc18003180180001e001800006000c60f700021558002d012ab0f6000e0300031800e0001e000e00006000c6f9000e180031800e0000c000e00006000c60f700022ab8002d015570f6000e0600031800380033000380006000c6f9000e18003180038000c000380006000c60f700021558002d012ab0f6000e0c0181b0000e00330000e00060606cf9000a18181b0000e000c0000e00fe0600c0f700022ab8002d015570f600030fc180e0fe00077380000001f86038f900027e180efe000103f0fe00031f860380f7000215580009012ab0c600022ab80009015570c6000215580009012ab0c600022ab80009015570c6000215580009012ab0c600022ab80009015570c6000215580009012ab0c600022ab80009015570c6000215580009012ab0c600022ab80009015570c6000215580009012ab0c600022ab8001f015570fc0002606030f50002f0783cf70001301ef7000002f5aa030015580020012ab0fc0002e1e0f0f600030198cc66f70001f030f7000005f55503002ab80022015570fd000301e06030f600030198cc66f700013060f7000002f60004030015580021012ab0fd000301606030f5000218cc66f700013060f7000004f6000403002ab80021015570fd000303606030f5000218cc66f70001306cf7000002f60004030015580021012ab0fd000302606030f50002307c3ef700013076f7000004f6000403002ab80021015570fd000306606030f50002600c06f700013066f7000002f60004030015580021012ab0fd000307f06030f50002c00c06f700013066f7000004f6000403002ab80021015570fc0002606030f600030180180cf700013066f7000002f60004030015580021012ab0fc0002f1f8fcf6000301f8f078f70001fc3cf7000004f6000403002ab8000f015570d4000002f6000403001558000f012ab0d4000004f6000403002ab8000f015570d4000002f6000403001558001b022ab003f4ff01f003f4ff01e007f4ff01e004f6000403002ab8001b02557003f4ff01e003f4ff01e007f4ff01c002f6000403001558002e022ab003feff00d5fe55fbff01d003feff00f5fe55007ffcff02c007fffe550057f9ff01a004f6000403002ab8003002557003feff03eaaaaaabfbff01e003feff00fafeaafbff02a007fffeaa00aff9ff01c002f90007018000030015580033022ab003feff03d000c003fbff01d003feff03f4003000fbff06c007ff4003000ff9ff03a00403f8fb000701800003002ab8003302557003feff03e0008003fbff01e003feff03f8002000fbff06a007ff8002000ff9ff03c002018cfb0007018000030015580036022ab003feff03d000c003fbff01d003feff03f4003000fbff06c007ff4003000ff9ff11a004018c783d1e6d9dce73f0f003002ab8003602557003feff03e0008003fbff01e003feff03f8002000fbff06a007ff8002000ff9ff11c002018ccc673336ce66318198030015580036022ab003feff03d000c003fbff01d003feff03f4003000fbff06c007ff4003000ff9ff11a004019986c361b6cc6631830c03002ab8003602557003feff03e0008003fbff01e003feff03f8002000fbff06a007ff8002000ff9ff11c00201f1fec061b6cc663183fc030015580036022ab003feff03d000c003fbff01d003feff03f4003000fbff06c007ff4003000ff9ff11a004019980c061b6cc6631830003002ab8003202557003feff02efffbffaff01e003feff02fbffeffaff04a007ffbffef7ff11c002018cce633336ce6671999c03001558002d022ab003feff00dff8ff01d003feff00f7f8ff03c007ff7ff6ff11a00403ce7c3e1e76edc3b8f0f803002ab8001f02557003f4aa01a003f4aa01a007f455014002fb00000cfd000403001558001f022ab003f455015003f455014006f4aa01a004fb00000cfd000403002ab80013015570d4000002fb00001efd000403001558000f012ab0d4000004f6000403002ab8000f015570d4000002f60004030015580024072ab000000601c60ef5000403000e0180f800030c000306f8000004f6000403002ab8002807557000f78600c606f70006f7800300060180fa000501f00c000306f8000002f60004030015580027072ab000630000c606f7000063fe0002060180f90000c0fe000006f8000004f6000403002ab80029085570006b1e0ecfc6e0f80006631e0f0776e3f0f90005c03cdb0f0fc0f9000002f60004030015580028082ab0006b0619c60730f800066333030ce73180f90004c00c6d8306f8000004f6000403002ab80028085570006b0618c60630f800067f61830c663180f90004c00c6d8306f8000002f60004030015580028082ab000770618c60630f80006637f830c663180f90004c60c6d8306f8000004f6000403002ab8002808557000770618c60630f800066360030c663180f90004c60c6d8306f8000002f60004030015580029082ab000630619c66630f800066333830ce63198f90005c60c6d830660f9000004f6000403002ab8002a08557000631f8ee3cf78f80006f79f0fc76f78f0fa000601fe3fedcfc3c0f9000002f60004030015580013012ab0ed000060e9000004f6000403002ab80013015570ed000060e9000002f60004030015580014012ab0ee000103c0e9000004f6000403002ab8000e015570d4000003f5ff03001558000e012ab0d4000007f5ff03002ab80009015570c6000215580009012ab0c600022ab80009015570c6000215580009012ab0c600022ab80009015570c6000215580009012abfc6ff02eab8000901557fc6ff029558000f012abce10002010480e900026ab8000f01557ce20002070028e800029558000f012abce200020380f0e800026ab8000f01557ce200020381a0e800029558000d012abce1000087e700026ab8000d01557ce10000cfe700029558000d012abce1000078e700026ab8000d01557ce1000020e700029558000d012abce1000030e700026ab8000d01557ce1000060e700029558000d012abce10000f0e700026ab8000e01557ce2000101f0e700029558000d012abce10000f8e700026ab8000e01557ce2000110f0e700029558000e012abce200011bf0e700026ab8001001557ce3000301fff980e800029558000e012abce200017fffe700026ab8001001557ce4000301003fffe700029558000f012abce200021fffc0e800026ab8001001557ce4000303001ffee7000295580010012abce4000301803ffee700026ab8001101557ce30004c0bffe0018e9000295580012012abce400054fc3fffe0090e900026ab80098004000a20000014401f800a20000014401f700a20000014401f700011201557ce400059f83ffffc060e9000295580012012abce4000073feff01e1c0e900026ab8001201557ce4000043feff01e180e9000295580012012abce4000001feff01f1f0e900026ab8001101557ce4000001fdff00f0e9000295580011012abce4000003fdff00d0e900026ab8001101557ce4000003fdff0088e900029558000f012abce300fdff0080e900026ab8000f01557ce300fdff00c0e900029558000d012abce300fdffe800026ab8000f01557ce400000ffdffe8000295580011012abce4000007feff00fee800026ab8001101557ce400000ffdff00c0e9000295580011012abce400001ffdff00e0e900026ab8001101557ce400003ffdff00c0e9000295580011012abce4000003fdff00c0e900026ab8001101557ce4000001fdff00c0e900029558000f012abce4000003fdffe800026ab8000f01557ce4000003fdffe800029558000f012abce4000003fdffe800026ab8000f01557ce4000003fdffe800029558000d012abce300fdffe800026ab8001701557ce8000080fd00feff00fcfb000080ef000295580017012abce8000080fd00feff00fcfb000040ef00026ab8001d01557cea00022400e0fd00067ffffff8000030fe000040ef00029558001e012abcea000d1800c0003100007ffffff8000030fe000020ef00026ab8001e01557cea000d0c11c0003f00007ffffff8010030fe000010ef00029558001e012abcea000616b780001f8380feff03fc43c1fafe000020ef00026ab8001d01557cea000603bf80001fc3dffdff02f3c0fcfe0000c0ef00029558001b012abcea000501ff00007fcffbff01e0fefe000040ef00026ab8001a01557ce90004ff0200ffeffbff05e1fc000001e0ef000295580019012abce90003ff8a007ffaff01e7fffe0000c0ef00026ab8001701557cea000401ffdf003ff8fffe000060ef000295580019012abcea00040bffff803ff9ff00fcfe000060ef00026ab8001a01557cea00040fffff803ff9ff05fc0012006040f0000295580018012abcea00031f3fff83f8ff04fc001f80e0ef00026ab8001801557ce900021fffc3f8ff05fc000f806780f0000295580017012abce900021fffc7f8ff04fd400f907cef00026ab8001401557ce900001ff5ff03e01ffff0ef000295580014012abce900001ff5ff03f0fffff8ef00026ab8001201557ce900f4ff03f0fffffcef000295580014012abce900007ff5ff03f0ffffccef00026ab8001401557ce900007ff5ff03f8ffff85ef00029558000f012abce900f1ff00c1ef00026ab8000f01557ce900f1ff0080ef00029558000f012abce900007ff2ffee00026ab8000f01557ce900001ff2ffee00029558000f012abce900000ff2ffee00026ab8001101557ce900000ff2ff00d0ef000295580011012abce9000007f2ff00e0ef00026ab8001101557ce9000007f2ff00c0ef000295580011012abce900002ff2ff00c0ef00026ab8001401557ceb000202007ff3ff01fe80ef000295580012012abceb000103c1f2ff00feee00026ab8001201557ceb00010381f2ff00fcee000295580012012abceb00014f81f2ff00e0ee00026ab8001301557cec000201dff1f2ff00e0ee000295580011012abcec000001f0ff00e0ee00026ab8001101557ceb00003ff1ff00f0ee000295580011012abceb00007ff1ff00f8ee00026ab8001101557ceb00007ff1ff00f8ee000295580012012abceb00003ff1ff01fbc0ef00026ab8001501557cf5000080f800001ff0ff0080ef000295580011012abceb00001ff0ff00c0ef00026ab8001101557ceb000007f0ff00c0ef000295580012012abceb000007f0ff01c004f000026ab8001601557cf5000004f8000007f0ff018002f0000295580016012abcf5000008f8000003f0ff010002f000026ab8001501557cf1000010fc000003f0ff0080ef000295580016012abcf5000018f8000023f0ff018407f000026ab8001801557cf500000cfe000018fc00efff01c70cf0000295580013012abcf100000cfc00eeff008cf000026ab8001901557cf5000008fe00001cfd000005eeff008cf0000295580019012abcf5000008fe0000f0fd00000feeff00d8f000026ab8001a01557cf5000040fe000060fd000007eeff01fe80f100029558001a012abcf500000cfe000060fd000007eeff01fe80f100026ab8001901557cf5000404003000e0fd000003eeff00fcf0000295580019012abcf50004040020007afd000001eeff00faf000026ab8001901557cf500060e2820003e4020fe00eeff00c8f0000295580019012abcf5000601fa30001f8020fe00eeff00c8f000026ab8001a01557cf50009021e70000fc0f0000003eeff00c0f0000295580019012abcf400080ff1000fe1c0000007eeff0080f000026ab8001901557cf400080ff3000fe1c0000007efff00f8ef000295580019012abcf400080fff003ff0e000001fefff00f8ef00026ab8001901557cf400080fff843ff1f800001fefff00f8ef000295580019012abcf4000803ff8e7ffff800000fefff00feef00026ab8001901557cf4000803ffdffffffce00007efff00feef000295580018012abcf4000003fdff03fce00007efff00feef00026ab8001701557cf4000007fcff02c0000fefff00fcef000295580018012abcf4000007fcff02e0000fefff01fc08f000026ab8001701557cf400006ffcff02f0003feeff0004f0000295580017012abcf400003ffcff02f2001feeff0080f000026ab8001701557cf400000ffcff02fe001feeff00bcf0000295580017012abcf4000007fcff02fe001feeff00f0f000026ab8001701557cf4000007fcff02fe001feeff00f0f0000295580016012abcf4000007fbff01003feeff00f8f000026ab8001601557cf400000ffbff01c03feeff00f0f0000295580016012abcf400001ffbff01c03feeff00c0f000026ab8001701557cf50001419ffbff01e03fefff00fcef000295580016012abcf5000061faff01f07fefff00fcef00026ab8001101557cf500003fe6ff00fcef000295580011012abcf500001fe6ff00fcef00026ab8001101557cf5000007e6ff00fcef000295580015012abcf8000304000007e6ff01fc40f000026ab8001101557cf5000007e5ff0080f0000295580012012abcf8000303000003e5ffef00026ab8001201557cf8000301000003e5ffef000295580012012abcf8000301000007e5ffef00026ab8001401557cf800030180003fe6ff00f0ef000295580013012abcf7000280001fe6ff00e0ef00026ab8001301557cf7000240301fe6ff00f0ef000295580013012abcf7000220301fe6ff00fcef00026ab8001301557cf7000218101fe6ff00f8ef000295580013012abcf700021c393fe6ff00f8ef00026ab8001101557cf700001fe4ff0080ef000295580011012abcf700003fe4ff00c0ef00026ab8001101557cf700001fe4ff00c0ef000295580011012abcf700000fe4ff00c0ef00026ab8000f01557cf700001fe4ffee00029558000f012abcf700003fe4ffee00026ab8001601557cfe000002fc0001023fe5ff00fcee000295580011012abcf8000001e4ff00fcee00026ab8001201557cf900010401e4ff00f0ee000295580014012abcfb000340000401e4ff00e0ee00026ab8001701557cfe000601000040000407e4ff00c0ee000295580015012abcfe000607c00040002f6fe4ffed00026ab800160a557c0000400fc00040903fe4ff00feed0002955800160a2abc0000400fc00040903fe4ff00feed00026ab8001501557cfe000607c00040002f6fe4ffed000295580017012abcfe000601000040000407e4ff00c0ee00026ab8001401557cfb000340000401e4ff00e0ee000295580012012abcf900010401e4ff00f0ee00026ab8001101557cf8000001e4ff00fcee000295580016012abcfe000002fc0001023fe5ff00fcee00026ab8000f01557cf700003fe4ffee00029558000f012abcf700001fe4ffee00026ab8001101557cf700000fe4ff00c0ef000295580011012abcf700001fe4ff00c0ef00026ab8001101557cf700003fe4ff00c0ef000295580011012abcf700001fe4ff0080ef00026ab8001301557cf700021c393fe6ff00f8ef000295580013012abcf7000218101fe6ff00f8ef00026ab8001301557cf7000220301fe6ff00fcef000295580013012abcf7000240301fe6ff00f0ef00026ab8001301557cf7000280001fe6ff00e0ef000295580014012abcf800030180003fe6ff00f0ef00026ab8001201557cf8000301000007e5ffef000295580012012abcf8000301000003e5ffef00026ab8001201557cf8000303000003e5ffef000295580011012abcf5000007e5ff0080f000026ab8001501557cf8000304000007e6ff01fc40f0000295580011012abcf5000007e6ff00fcef00026ab8001101557cf500001fe6ff00fcef000295580011012abcf500003fe6ff00fcef00026ab8001601557cf5000061faff01f07fefff00fcef000295580017012abcf50001419ffbff01e03fefff00fcef00026ab8001601557cf400001ffbff01c03feeff00c0f0000295580016012abcf400000ffbff01c03feeff00f0f000026ab8001601557cf4000007fbff01003feeff00f8f0000295580017012abcf4000007fcff02fe001feeff00f0f000026ab8001701557cf4000007fcff02fe001feeff00f0f0000295580017012abcf400000ffcff02fe001feeff00bcf000026ab8009800400144000001ca01f80144000001ca01f70144000001ca01f700011701557cf400003ffcff02f2001feeff0080f0000295580017012abcf400006ffcff02f0003feeff0004f000026ab8001801557cf4000007fcff02e0000fefff01fc08f0000295580017012abcf4000007fcff02c0000fefff00fcef00026ab8001801557cf4000003fdff03fce00007efff00feef000295580019012abcf4000803ffdffffffce00007efff00feef00026ab8001901557cf4000803ff8e7ffff800000fefff00feef000295580019012abcf400080fff843ff1f800001fefff00f8ef00026ab8001901557cf400080fff003ff0e000001fefff00f8ef000295580019012abcf400080ff3000fe1c0000007efff00f8ef00026ab8001901557cf400080ff1000fe1c0000007eeff0080f000029558001a012abcf50009021e70000fc0f0000003eeff00c0f000026ab8001901557cf5000601fa30001f8020fe00eeff00c8f0000295580019012abcf500060e2820003e4020fe00eeff00c8f000026ab8001901557cf50004040020007afd000001eeff00faf0000295580019012abcf5000404003000e0fd000003eeff00fcf000026ab8001a01557cf500000cfe000060fd000007eeff01fe80f100029558001a012abcf5000040fe000060fd000007eeff01fe80f100026ab8001901557cf5000008fe0000f0fd00000feeff00d8f0000295580019012abcf5000008fe00001cfd000005eeff008cf000026ab8001301557cf100000cfc00eeff008cf0000295580018012abcf500000cfe000018fc00efff01c70cf000026ab8001601557cf5000018f8000023f0ff018407f0000295580015012abcf1000010fc000003f0ff0080ef00026ab8001601557cf5000008f8000003f0ff010002f0000295580016012abcf5000004f8000007f0ff018002f000026ab8001201557ceb000007f0ff01c004f0000295580011012abceb000007f0ff00c0ef00026ab8001101557ceb00001ff0ff00c0ef000295580015012abcf5000080f800001ff0ff0080ef00026ab8001201557ceb00003ff1ff01fbc0ef000295580011012abceb00007ff1ff00f8ee00026ab8001101557ceb00007ff1ff00f8ee000295580011012abceb00003ff1ff00f0ee00026ab8001101557cec000001f0ff00e0ee000295580013012abcec000201dff1f2ff00e0ee00026ab8001201557ceb00014f81f2ff00e0ee000295580012012abceb00010381f2ff00fcee00026ab8001201557ceb000103c1f2ff00feee000295580014012abceb000202007ff3ff01fe80ef00026ab8001101557ce900002ff2ff00c0ef000295580011012abce9000007f2ff00c0ef00026ab8001101557ce9000007f2ff00e0ef000295580011012abce900000ff2ff00d0ef00026ab8000f01557ce900000ff2ffee00029558000f012abce900001ff2ffee00026ab8000f01557ce900007ff2ffee00029558000f012abce900f1ff0080ef00026ab8000f01557ce900f1ff00c1ef000295580014012abce900007ff5ff03f8ffff85ef00026ab8001401557ce900007ff5ff03f0ffffccef000295580012012abce900f4ff03f0fffffcef00026ab8001401557ce900001ff5ff03f0fffff8ef000295580014012abce900001ff5ff03e01ffff0ef00026ab8001701557ce900021fffc7f8ff04fd400f907cef000295580018012abce900021fffc3f8ff05fc000f806780f000026ab8001801557cea00031f3fff83f8ff04fc001f80e0ef00029558001a012abcea00040fffff803ff9ff05fc0012006040f000026ab8001901557cea00040bffff803ff9ff00fcfe000060ef000295580017012abcea000401ffdf003ff8fffe000060ef00026ab8001901557ce90003ff8a007ffaff01e7fffe0000c0ef00029558001a012abce90004ff0200ffeffbff05e1fc000001e0ef00026ab8001b01557cea000501ff00007fcffbff01e0fefe000040ef00029558001d012abcea000603bf80001fc3dffdff02f3c0fcfe0000c0ef00026ab8001e01557cea000616b780001f8380feff03fc43c1fafe000020ef00029558001e012abcea000d0c11c0003f00007ffffff8010030fe000010ef00026ab8001e01557cea000d1800c0003100007ffffff8000030fe000020ef00029558001d012abcea00022400e0fd00067ffffff8000030fe000040ef00026ab8001701557ce8000080fd00feff00fcfb000040ef000295580017012abce8000080fd00feff00fcfb000080ef00026ab8000d01557ce300fdffe800029558000f012abce4000003fdffe800026ab8000f01557ce4000003fdffe800029558000f012abce4000003fdffe800026ab8000f01557ce4000003fdffe8000295580011012abce4000001fdff00c0e900026ab8001101557ce4000003fdff00c0e9000295580011012abce400003ffdff00c0e900026ab8001101557ce400001ffdff00e0e9000295580011012abce400000ffdff00c0e900026ab8001101557ce4000007feff00fee800029558000f012abce400000ffdffe800026ab8000d01557ce300fdffe800029558000f012abce300fdff00c0e900026ab8000f01557ce300fdff0080e9000295580011012abce4000003fdff0088e900026ab8001101557ce4000003fdff00d0e9000295580011012abce4000001fdff00f0e900026ab8001201557ce4000001feff01f1f0e9000295580012012abce4000043feff01e180e900026ab8001201557ce4000073feff01e1c0e9000295580012012abce400059f83ffffc060e900026ab8001201557ce400054fc3fffe0090e9000295580011012abce30004c0bffe0018e900026ab8001001557ce4000301803ffee7000295580010012abce4000303001ffee700026ab8000f01557ce200021fffc0e8000295580010012abce4000301001fffe700026ab8000e01557ce200017fffe7000295580010012abce3000301fff980e800026ab8000e01557ce200011bf0e700029558000e012abce2000110f0e700026ab8000d01557ce10000f8e700029558000e012abce2000101f0e700026ab8000d01557ce10000f0e700029558000d013ffce1000060e700026ff8000d01555ce1000030e700029558000d012abce1000020e700026ab8000d01557ce1000078e700029558000d012abce10000cfe700026ab8000d01557ce1000087e700029558000f012abce200020381a0e800026ab8000f01557ce200020380f0e800029558000f012abce20002070028e800026ab8000901557cc6000295580009012abcc600026ab8000901557cc6000295580009012abcc600026ab8000901557cc6000295580009012abcc600026ab8000901557cc6000295580009012abdc655026ab8000901557ac6aa0295580008012abac5aa01b80008015575c55501580007002ac4aa01b8000cfe55005dca5504d55555580007002ac4aa01b8000cfe55005dca5504d55555580007002ac4aa01b8000cfe55005dca5504d55555580007002ac4aa01b80007005fc4ff01f80007003fc4ff01f800a0008fa00083ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 17.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 This demo displays the Mandelbrot set with user-specified parameters. The computation which may take quite a long time is performed in a background process, so that the interface remains fully operational. The progress of the computation is shown in a progress bar, which also allows to abort the computation. Scales can be use to try different parameter settings. When a document is stored, the parameter combination is saved in a file (not the bitmap itself). Selecting a rectangular area of a picture with the mouse means to zoom into that area. Zooming is undoable.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 17.2 Implementation\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab Double buffering is used to store computed Mandelbrot sets\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 17.3 Limitations and Extensions\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab Color would be nice.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 17.4 Source Code\par \pard\plain \s10 \f22\fs12 ;;; -*- Mode\:LISP;Syntax\:Common-Lisp;Package\:mandel;Base\: 10 -*-\par \par (in-package \:GINA)\par (defginapackage \:mandel)\par (in-package \:mandel)\par (setq *sccs-id* "@(#)mandelbrot.lisp\tab 1.2  1/15/92")\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class mandelbrot-application\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass mandelbrot-application (application)\par   (;; overrides\par    (name          \:initform "Mandelbrot"         \:allocation \:class)\par    (document-type \:initform 'mandelbrot-document \:allocation \:class)\par    (signature     \:initform "mandel"             \:allocation \:class)\par    (file-type     \:initform "mandel"             \:allocation \:class)))\par \par (defun make-mandelbrot-application ()\par   (make-application \:class 'mandelbrot-application))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class mandelbrot-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass mandelbrot-document (document)\par   ((shell-width \:initform 600)\par    (shell-height \:initform 400)\par    (label \:accessor label)\par    (scale1 \:accessor scale1)\par    (scale2 \:accessor scale2)\par    (scale3 \:accessor scale3)\par    (button \:accessor button)\par    (min-x  \:accessor min-x \:initform -2.0) \par    (max-x  \:accessor max-x \:initform  1.0)\par    (min-y  \:accessor min-y \:initform -1.0)\par    (max-y  \:accessor max-y \:initform  1.0)))\par \par (defmethod create-windows ((doc mandelbrot-document) &aux form scroller)\par   "create the windows belonging to this document"\par   (with-slots (main-shell main-view label scale1 scale2 scale3 button) doc\par     (setq main-shell (make-document-shell doc))\par     (setq form       (make-form main-shell))\par     (setq label      (make-label form "-2.0 < X < 1.0      -1.0 < Y < 1.0"))\par     (setq scale1     (make-scale form \:orientation \:horizontal\par \tab \tab \tab \tab  \:title-string "Width"\par \tab \tab \tab \tab  \:minimum 1 \:maximum 1200 \:value 60\par                                  \:value-changed-callback\par                                  `(lambda (&rest ignore) \par \tab \tab \tab \tab    (setf (modified ,doc) t))))\par     (setq scale2     (make-scale form \:orientation \:horizontal\par \tab \tab \tab \tab  \:title-string "Height"\par \tab \tab \tab \tab  \:minimum 1 \:maximum 800 \:value 40\par \tab \tab \tab \tab  \:value-changed-callback\par                                  `(lambda (&rest ignore) \par \tab \tab \tab \tab    (setf (modified ,doc) t))))\par     (setq scale3     (make-scale form \:orientation \:horizontal\par \tab \tab \tab \tab  \:title-string "Limit"\par \tab \tab \tab \tab  \:minimum 1 \:maximum 128 \:value 8\par \tab \tab \tab \tab  \:value-changed-callback\par                                  `(lambda (&rest ignore) \par \tab \tab \tab \tab    (setf (modified ,doc) t))))\par     (setq button     (make-push-button form "Recompute"\par                          \:activate-callback\par                          (make-callback 'draw-mandelbrot-set doc)))\par     (setq scroller   (make-scroller form))\par     (setq main-view  (make-mandelbrot-view scroller \:document doc)) \par     \par     (define-form-constraint label \par                             \:top-attachment \:form\par                             \:left-attachment \:form\par                             \:right-attachment \:form)\par     (define-form-constraint scale1 \par \tab \tab \tab     \:left-attachment \:form\par \tab \tab \tab     \:left-offset 10\par \tab \tab \tab     \:top-attachment \:widget \:top-widget label\par \tab \tab \tab     \:right-attachment \:position \:right-position 25)\par     (define-form-constraint scale2 \par                             \:top-attachment \:widget \:top-widget label\par                             \:left-attachment \:widget \:left-widget scale1\par \tab \tab \tab     \:left-offset 10\par                             \:right-attachment \:position \:right-position 50)\par     (define-form-constraint scale3\par                             \:top-attachment \:widget \:top-widget label\par                             \:left-attachment \:widget \:left-widget scale2\par \tab \tab \tab     \:left-offset 10\par                             \:right-attachment \:position \:right-position 75)\par     (define-form-constraint button \par                             \:top-attachment \:widget \:top-widget label\par \tab \tab \tab     \:top-offset 5\par                             \:left-attachment \:widget \:left-widget scale3\par \tab \tab \tab     \:left-offset 10\par                             \:right-attachment \:form \:right-offset 10\par                             \:bottom-attachment \:widget \:bottom-widget scroller\par                             \:bottom-offset 5)\par     (define-form-constraint scroller\par                             \:top-attachment \:widget \:top-widget scale1\par                             \:left-attachment \:form\par                             \:right-attachment \:form\par                             \:bottom-attachment \:form)\par     ))\par \par (defmethod write-to-stream ((doc mandelbrot-document) stream)\par   "write the current parameter setting to the specified stream"\par   (format stream "~d ~d ~d ~d ~d ~d ~d ~%"\par           (value (scale1 doc)) (value (scale2 doc)) (value (scale3 doc))\par           (min-x doc) (max-y doc) (min-y doc) (max-y doc)))\par \par (defmethod read-from-stream ((doc mandelbrot-document) stream) \par   "read the stored parameter settings from the specified stream"\par   (with-slots (scale1 scale2 scale3) doc\par     (setf (value scale1) (read stream))\par     (setf (value scale2) (read stream))\par     (setf (value scale3) (read stream))\par     (setf (min-x doc) (read stream))\par     (setf (max-y doc) (read stream))\par     (setf (min-y doc) (read stream))\par     (setf (max-y doc) (read stream))))\par \par (defun draw-mandelbrot-set (document \par \tab \tab \tab     &aux view width height limit \par \tab \tab \tab \tab  min-x max-x min-y max-y\par \tab \tab \tab \tab  step-x step-y)\par   "loop through user-specified range of points"\par \par   ;; kill all other computations in progress\par   (kill-all-background-processes document)\par   \par   (setq view   (main-view document))\par   (setq width  (value (scale1 document)))\par   (setq height (value (scale2 document)))\par   (setq limit  (value (scale3 document)))\par   (setq min-x (min-x document) \par \tab max-x (max-x document)\par \tab step-x (/ (- max-x min-x) width))\par   (setq min-y (min-y document) \par \tab max-y (max-y document)\par \tab step-y (/ (- max-y min-y) height))\par \par   ;; adapt view size to parameters\par   (resize view width height)\par \par   ;; clear both window and pixmap buffer\:\par   (clear-area view 0 0 width height)\par   (progn (setf (drawable view) (pixmap-buffer view))\par \tab  (clear-area view 0 0 width height)\par \tab  (setf (drawable view) (x-window view)))\par \par   (with-progress-bar (document \:modal nil \par \tab \tab \tab        \:centered nil\par \tab \tab \tab        \:message "Recomputing Mandelbrot Set ...")\par     (loop for x from min-x to max-x by step-x \par           for i from 0 \par           while (not (progress-bar-aborted)) do\par       ;; move slider of progress bar\par       (indicate-progress (round (* (/ i (float width)) 100)))\par       (loop for y from min-y to max-y by step-y\par             for j from 0 do\par \tab (when (in-mandelbrot-set x y limit)\par \tab   ;; draw into both window and pixmap buffer\:\par \tab   (draw-point view i j)\par \tab   (progn  (setf (drawable view) (pixmap-buffer view))\par \tab \tab   (draw-point view i j)\par \tab \tab   (setf (drawable view) (x-window view)))))\par       (xlib\:display-force-output *display*))))\par \par (defun in-mandelbrot-set (x y limit \par \tab \tab \tab   &aux (new-x x) (new-y y) z (k 0))\par   "test whether point (x,y) is member of Mandelbrot set"\par   (setq z (complex x y))\par   (loop \par     while (and (<= (+ (* new-x new-x) (* new-y new-y)) 4) (< k limit)) \par     do (setq z (+ (complex x y) (* z z)))\par        (setq new-x (realpart z))\par        (setq new-y (imagpart z))\par        (incf k))\par    ;; return whether number of iterations reached the limit\par    (= k limit))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class mandelbrot-view\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass mandelbrot-view (view)\par   ())\par \par (defun make-mandelbrot-view (parent &key document)\par   (make-view parent \:document document\par \tab             \:class 'mandelbrot-view\par \tab             \:double-buffering t))\par \par (defmethod determine-window-id \:after ((view mandelbrot-view))\par   "immediately start computation of mandelbrot-set when view is ready"\par   (draw-mandelbrot-set (document view)))\par \par \par (defmethod button-press ((view mandelbrot-view) code repetition x y)\par   (declare (ignore repetition code))\par   (make-zoom-command view x y))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class zoom-command\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass zoom-command (mouse-down-command)\par   ((name \:initform "Zoom" \:allocation \:class)\par    (new-min-x  \:accessor new-min-x) \par    (new-max-x  \:accessor new-max-x)\par    (new-min-y  \:accessor new-min-y)\par    (new-max-y  \:accessor new-max-y)\par    (old-min-x  \:accessor old-min-x \:initarg \:old-min-x) \par    (old-max-x  \:accessor old-max-x \:initarg \:old-max-x)\par    (old-min-y  \:accessor old-min-y \:initarg \:old-min-y)\par    (old-max-y  \:accessor old-max-y \:initarg \:old-max-y)))\par \par \par (defun make-zoom-command (view x y)\par   (make-mouse-down-command (document view) view x y\par \tab \tab \tab    \:cursor \:crosshair\par \tab \tab \tab    \:class 'zoom-command\par \tab \tab \tab    \:initargs\par \tab \tab \tab    (list \:old-min-x (min-x (document view))\par \tab \tab \tab \tab  \:old-max-x (max-x (document view)) \par \tab \tab \tab \tab  \:old-min-y (min-y (document view))\par \tab \tab \tab \tab  \:old-max-y (max-y (document view)))))\par \par (defmethod constrain-mouse ((cmd zoom-command) x y)\par   "make sure width and height of area is > 0"\par   (with-slots (start-x start-y) cmd\par     (setq x (max x (1+ start-x)))\par     (setq y (max y (1+ start-y))))\par   (values x y))\par \par (defmethod draw-feedback ((cmd zoom-command) x y &key clear)\par   "draw rectangular feedback"\par   (declare (ignore clear))\par   (with-slots (start-x start-y view) cmd\par     (xlib\:with-gcontext ((gcontext view) \:line-style \:dash)\par       (draw-rectangle view start-x start-y (- x start-x)  (- y start-y)))))\par \par (defmethod track-mouse ((cmd zoom-command) x y &key &allow-other-keys)\par   (with-slots (start-x start-y new-min-x new-max-x new-min-y new-max-y \par \tab \tab        view document) cmd\par      (setq new-min-x (+ (min-x document) \par \tab \tab \tab (* (- (max-x document) (min-x document)) ;; range\par \tab \tab \tab    (/ start-x (float (width view))))))\par      (setq new-min-y (+ (min-y document) \par \tab \tab \tab (* (- (max-y document) (min-y document)) ;; range\par \tab \tab \tab    (/ start-y (float (height view))))))\par      (setq new-max-x (+ (min-x document) \par \tab \tab \tab (* (- (max-x document) (min-x document)) ;; range\par \tab \tab \tab    (/ x (float (width view))))))\par      (setq new-max-y (+ (min-y document) \par \tab \tab         (* (- (max-y document) (min-y document)) ;; range\par \tab \tab \tab    (/ y (float (height view))))))\par      (setf (label-string (label document))\par        (format nil "~8d < X < ~8d    ~8d < Y < ~8d" \par \tab \tab new-min-x new-max-x new-min-y new-max-y))\par      ))\par \par (defmethod doit ((cmd zoom-command))\par   "change range parameters in document"\par   (setf (min-x (document cmd)) (new-min-x cmd))\par   (setf (max-x (document cmd)) (new-max-x cmd))\par   (setf (min-y (document cmd)) (new-min-y cmd))\par   (setf (max-y (document cmd)) (new-max-y cmd))\par   (setf (label-string (label (document cmd)))\par        (format nil "~8d < X < ~8d    ~8d < Y < ~8d" \par \tab        (new-min-x cmd) (new-max-x cmd) \par \tab        (new-min-y cmd) (new-max-y cmd)))\par   (draw-mandelbrot-set (document cmd)))\par \par (defmethod undoit ((cmd zoom-command))\par   "restore range parameters in document"\par   (setf (min-x (document cmd)) (old-min-x cmd))\par   (setf (max-x (document cmd)) (old-max-x cmd))\par   (setf (min-y (document cmd)) (old-min-y cmd))\par   (setf (max-y (document cmd)) (old-max-y cmd))\par   (setf (label-string (label (document cmd)))\par        (format nil "~8d < X < ~8d    ~8d < Y < ~8d" \par \tab        (old-min-x cmd) (old-max-x cmd) \par \tab        (old-min-y cmd) (old-max-y cmd)))\par   (draw-mandelbrot-set (document cmd)))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; main program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par (register-application "mandel" 'mandelbrot-application "mandel")\par '(make-mandelbrot-application)\par \pard\plain \s255\sa100\keepn\pagebb \b\f34\fs28 18. Desk Calculator \par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 18.1 Functionality\par \pard\plain \s2\qj\ri1\sb40\sa100 \f34 Just like a typical desk calculator. {\f22 Rubout} removes the last typed digit or the decimal point. {\f22 Clear} clears all internal registers and the display. This calculator demonstrates the use of the GINA interface-builder. \par \pard\plain \s4\qc\fi-283\li283\ri1\sb40\sa40 \f34 {{\pict\macpict\picw218\pich216 108e0000000000d800da1101a00082a0008e01000a0000000002d0024098001c0000000000d800e00000000000d800da0000000000d800da00010cfe000010ee000008fe0000800a032aaaaab2ebaa01ab800a0015eb550059fe5500800a032aaaaab2ebaa01ab800a0015eb550059fe5500800a032aaaaab2ebaa01ab800a0015eb550059fe5500800a032aaaaab2ebaa01ab800d03157ffff7eeff04fbffff558008012ac0e90001ab800c0015ed5506655559555655800e032acaaab2faaafe00f5aa01ab80120015f8550054fe00fa55066555595556558012032acaaab2faaa023c0300f7aa03800aab80130015f8550354660300fa55066555591576558010032acaaab2faaa02c0f33cf5aa01ab801502155400fa550354c19b66fa55066541591576558014032ac8abb2faaa02c01b60f9aa008efeaa01ab80130015f8550354c0fb60fa55066555591576558014032ac9ffb2faaa02c19b60f9aa009efeaa01ab80130015f8550354679b66fa55066555591576558010032acaaab2faaa023cef3cf5aa01ab80120015f8550054fe00fa55066555593ff655800e032acaaab2faaafe00f5aa01ab80120015f8550054fe00fa5506655559555655800f032adffff7f0ff06effffbfffeab8008007fe9ff02feff800901003feaff02fc00800901157feaff02fc558009012af8ea000208ab8009011578ea000204558009012af8ea000208ab8009011578eaff0284558009012af8eaff0288ab800b021578c0ec0003010455800a022af8c0eb000288ab800b021578c0ec0003010455800f022af8c0f00007060f0001c088ab800f021578c0f000071e198003610455800f022af8c0f00007061980063088ab800f021578c0f0000706018006310455800f022af8c0f00007060180063088ab800f021578c0f0000706030006310455800f022af8c0f00007060600063088ab800f021578c0f00007060c0006310455800f022af8c0f00007061803036088ab800f021578c0f000071f9f8301c10455800a022af8c0eb000288ab800b021578c0ec0003010455800a022af8c0eb000288ab800b021578c0ec0003010455800a022af8c0eb000288ab800b021578c0ec0003010455800a022af8eaebaa0288ab800a021578d5eb550204558009012af8ea000208ab8009011578ea000204558009012af8ea000208ab8009011578ea000204558009012af8ea000208ab8009011578ea000204558009012af8ea000208ab8009011578ea000204558015012af8fcaa00a1fc550042fcaa0085fc550208ab8016011579fc550062fcaa00c5fc55008afdaa03ab04558018022af880fd000061fc0000c2fd00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab801b0315790fc0fe0001620ffd0001c41efe00010188fd0003030455801c032af888c0fe0002611980fe0001c233fe00010184fd00030308ab801d03157900c0fe0002621980fe0001c433fe0002018808fe0003030455801d032af88180fe0002611980fe0001c233fe0002018408fe00030308ab801c0315790180fe0001620ffd0001c433fe0002018808fe0003030455801d032af88180fe0002611980fe0001c21ffe000201847ffe00030308ab801d0315790180fe0002621980fe0001c403fe0002018808fe0003030455801c022af883fd0002611980fe0001c203fe0002018408fe00030308ab801c02157903fd0002621980fe0001c406fe0002018808fe0003030455801a022af883fd0001610ffd0001c23cfe00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab80160215797ffdff00e2fcff00c5fcff008bfcff0204558015012af8fcff00e1fcff00c3fcff0087fcff0208ab8009011578ea000204558009012af8ea000208ab8009011578ea000204558015012af8fcaa00a1fc550042fcaa0085fc550208ab8016011579fc550062fcaa00c5fc55008afdaa03ab04558018022af880fd000061fc0000c2fd00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab801c03157900c0fe0002620fc0fe0006c4078000000188fd0003030455801b032af881c0fe0001610cfd0001c20cfe00010184fd00030308ab801b03157903c0fe0001620cfd0001c418fe00010188fd0003030455801b032af882c0fe0001610cfd0001c218fe00010184fd00030308ab801c03157906c0fe0002620f80fe0001c41bfe00010188fd0003030455801d032af884c0fe00026108c0fe0007c21d80000001847ffe00030308ab801c0315790cc0fe00026200c0fe0006c4198000000188fd0003030455801c032af88fe0fe00026100c0fe0006c2198000000184fd00030308ab801c03157900c0fe0002620cc0fe0006c4198000000188fd0003030455801c032af881e0fe0002610780fe0001c20ffe00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab80160215797ffdff00e2fcff00c5fcff008bfcff0204558015012af8fcff00e1fcff00c3fcff0087fcff0208ab8009011578ea000204558009012af8ea000208ab8009011578ea000204558015012af8fcaa00a1fc550042fcaa0085fc550208ab8016011579fc550062fcaa00c5fc55008afdaa03ab04558018022af880fd000061fc0000c2fd00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab801b0315790180fe0001620ffd0001c41efe00010188fd0003030455801d032af88780fe0002611980fe0001c233fe0002018408fe00030308ab801d0315790180fe0002621980fe0001c403fe000201882afe0003030455801d032af88180fe0002610180fe0001c203fe000201841cfe00030308ab801d0315790180fe0002620180fe0001c40efe000201881cfe0003030455801c032af88180fe00016103fd0001c202fe0002018422fe00030308ab801b0315790180fe00016206fd0001c403fe00010188fd0003030455801b032af88180fe0001610cfd0001c203fe00010184fd00030308ab801b0315790180fe00016218fd0001c433fe00010188fd0003030455801c032af887e0fe0002611f80fe0001c21efe00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab80160215797ffdff00e2fcff00c5fcff008bfcff0204558015012af8fcff00e1fcff00c3fcff0087fcff0208ab8009011578ea000204558009012af8ea000208ab8009011578ea000204558015012af8fcaa00a1fc550042fcaa0085fc550208ab8016011579fc550062fcaa00c5fc55008afdaa03ab04558018022af880fd000061fc0000c2fd00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab80190315790380fe000062fc0000c4fd00010188fd00030304558019032af886c0fe000061fc0000c2fd00010184fd00030308ab80190315790c60fe000062fc0000c4fd00010188fd0003030455801a032af88c60fe000061fc0000c2fd0002018418fe00030308ab801a0315790c60fe000062fc0000c4fd0002018818fe00030304558019032af88c60fe000061fc0000c2fd00010184fd00030308ab80190315790c60fe000062fc0000c4fd00010188fd00030304558019032af88c60fe000061fc0000c2fd00010184fd00030308ab801b03157906c0fe00016206fd0000c4fd0002018818fe0003030455801b032af88380fe00016106fd0000c2fd0002018418fe00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab8017011579fc000062fc0000c4fd00010188fd00030304558018022af880fd000061fc0000c2fd00010184fd00030308ab80160215797ffdff00e2fcff00c5fcff008bfcff0204558015012af8fcff00e1fcff00c3fcff0087fcff0208ab8009011578ea000204558009012af8ea000208ab8009011578ea000204558009012af8ea000208ab8009011578ea000204558013012af8fb550050f955015415fc55035408ab8011011578fbaa00a8f8aa002afbaa0204558015022af840fc00011840fa00010610fc00030608ab801502157880fc00011880fa00010620fc00030604558015022af840fc00011840fa00010610fc00030608ab801b0415788003c0fe000a1880000038000001800620fc0003060455801b042af841d0c0fe000a1840fe0018000001800610fc00030608ab801b0415788370c0fe000a1880630018000001800620fc0003060455801b122af84630c0f0f877184063739b878e73f00610fc00030608ab801d1b15788600c1980c38188063319cccc63180062000007f0000060455801b122af84600c30c0c301840663198d86631800610fc00030608ab801b1215788600c3fcfc3018807c3198d86631800620fc0003060455801d1b2af84600c3018c301840663198d8663180061000007f00000608ab801b1215788330c19d9c30188063339cccc671980620fc0003060455801b122af841e3f0f8ee7e1840f39dfb8783b8f00610fc00030608ab801502157880fc00011880fa00010620fc00030604558015022af840fc00011840fa00010610fc00030608ab8015027ff880fc00011880fa00010620fc00030604ff801502003840fc00011840fa00010610fc0003060800801502157880fc00011880fa00010620fc00030604558015022af840fc00011840fa00010610fc00030608ab8015021578bffcff01f8bffaff01fe2ffcff03fe04558015022af87ffcff01f87ffaff01fe1ffcff03fe08ab8009011578ea000204558009012af8ea000208ab8009011578ea000204558009012af8ea000208ab8009011578ea000204558009012af8ea000208ab8009011578ea000204558009012af8ea000208ab8009011578ea000204558009012af8ea000208ab800901157dea550254558009012afaeaaa02a8ab8008011560e90001558008012ac0e90001ab800a0015eb550059fe5500800a032aaaaab2ebaa01ab800a0015eb550059fe5500800a032aaaaab2ebaa01ab800a0015eb550059fe5500800a032aaaaab2ebaa01ab800a0015eb550059fe5500800d033ffffff7eeff00fbfeff008006007fe7ff008002e500a0008fa00083ff}}\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 18.2 Implementation\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab All visible items are drawn with the interface builder.\par \'a5\tab All callbacks of buttons are also set within the interface builder.\par \'a5\tab The code for this demo application is very small and is mostly restricted to the functions of the calculator.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 18.3 Limitations and Extensions\par \pard\plain \s4\qj\fi-283\li283\ri1\sb40\sa40 \f34 \'a5\tab Pressing any key from the keyboard is not recognized.\par \pard\plain \s3\qj\ri1\sb200\sa100\keepn \b\f34 18.4 Source Code\par \pard\plain \s10 \f22\fs12 ;;; -*- Mode\: LISP; Syntax\: Common-Lisp; Package\: calc; Base\: 10-*-\par \par (in-package \:GINA)\par (defginapackage \:calc)\par (in-package \:calc)\par (setq *sccs-id* "@(#)calculator.lisp\tab 1.2  1/21/92")\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class calculator\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass calculator (application)\par   (;; overrides\par    (name          \:initform "Calculator"   \:allocation \:class)\par    (document-type \:initform 'calc-document \:allocation \:class)\par    (signature     \:initform "calc"         \:allocation \:class)\par    (file-type     \:initform "calc"         \:allocation \:class)))\par \par (defun make-calculator ()\par   "start the desk-calculator"\par   (make-application \:class 'calculator))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; class calc-document\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (defclass calc-document (document)\par   (;; instance-variables\par    (input-value   \:accessor input-value   \:initform 0)\par    (input-string  \:accessor input-string  \:initform "")\par    (decimal-point \:accessor decimal-point \:initform nil)\par    (memory        \:accessor memory        \:initform 0)\par    (operator      \:accessor operator      \:initform nil)))\par \par (defmethod clear ((doc calc-document))\par   "reset everything"\par   (setf (input-string doc) "")\par   (setf (input-value doc) 0)\par   (setf (decimal-point doc) nil)\par   (setf (label-string (display (main-shell doc))) "0")\par   (setf (memory doc) 0)\par   (setf (operator doc) nil))\par \par (defmethod create-windows ((doc calc-document))\par   "create the windows belonging to this document"\par   (with-slots (main-shell main-view) doc\par     ;; create instance of class generated by Interface Builder\par     (setq main-shell (make-calculator-shell doc))\par \par     ;; bypass GINAs automatic naming conventions\par     (setf (title main-shell) "Calc")\par     (set-motif-resources main-shell \:icon-name "Calc")))\par \par (defmethod type-digit ((doc calc-document) digit\par \tab \tab        &aux (display (display (main-shell doc))))\par   "a digit has been typed"\par   (setf (input-string doc)\par \tab (concatenate 'string (input-string doc) (format nil "~d" digit)))\par   (when (not (operator doc)) (setf (memory doc) 0))\par   (setf (label-string display) (input-string doc)))\par \par (defmethod type-point ((doc calc-document)\par \tab \tab        &aux (display (display (main-shell doc))))\par   "a point has been typed"\par   (when (not (decimal-point doc))\par     (setf (decimal-point doc) t)\par     (setf (input-string doc)\par \tab (concatenate 'string (input-string doc) "."))\par     (setf (label-string display) (input-string doc))))\par \par (defmethod type-rubout ((doc calc-document)\par \tab \tab \tab   &aux string-length\par \tab \tab \tab        (display (display (main-shell doc))))\par   "backspace for input"\par   (setq string-length (length (input-string doc)))\par   (when (> string-length 0)\par     (when (equal (position #\\. (input-string doc)) (1- string-length))\par       (setf (decimal-point doc) nil))\par     (setf (input-string doc) (subseq (input-string doc) 0 (1- string-length)))\par     (setf (label-string display) (input-string doc))))\par \par (defmethod type-operator ((doc calc-document) operator\par \tab \tab \tab   &aux (display (display (main-shell doc))))\par   "an operator has been typed"\par   (setf (input-value doc)\par \tab (if (equal (input-string doc) "")\par \tab     (memory doc)\par \tab     (read-from-string (input-string doc))))\par   (setf (input-string doc) "")\par   (setf (decimal-point doc) nil)\par   (if (operator doc)\par     (setf (memory doc)\par \tab   (ignore-errors\par \tab     (funcall (operator doc) (memory doc) (input-value doc))))\par     (setf (memory doc) (input-value doc)))\par   (when (not (memory doc)) (setf (memory doc) "Error"))\par   (setf (operator doc) operator)\par   (setf (label-string display) (format nil "~f" (memory doc))))\par \par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par ;;;;;; main program\par ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\par \par (register-application "calc" 'calculator "calc")\par '(make-calculator)\par }